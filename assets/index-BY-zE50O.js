const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-BEtukJrY.js","assets/phaser-0RJB29YE.js","assets/web-CabQi2pA.js","assets/web-yrZVTxYl.js"])))=>i.map(i=>d[i]);
var it=Object.defineProperty;var ot=(h,e,s)=>e in h?it(h,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[e]=s;var W=(h,e,s)=>ot(h,typeof e!="symbol"?e+"":e,s);import{P as w}from"./phaser-0RJB29YE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();function Be(h){let e=h;return function(){e|=0,e=e+1831565813|0;let s=Math.imul(e^e>>>15,1|e);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}class we{constructor(e=6,s=null){this.gridSize=e,this.totalCells=e*e,this.random=s!==null?Be(s):Math.random}setSeed(e){this.random=Be(e)}generate(e={}){const{difficulty:s=2,maxAttempts:t=100}=e;for(let i=0;i<t;i++){const o=this.generateOnce();if(o&&this.strictValidate(o))return this.formatLevelData(o,s)}return console.error("ãƒ¬ãƒ™ãƒ«ç”Ÿæˆã«å¤±æ•—"),null}generateOnce(){const e=this.generateSnakePath(),s=this.random()<.5?3:4,t=this.splitPathSafely(e,s);if(!t||this.hasAdjacentEndpoints(t))return null;const i=this.createEmptyGrid(),o=t.map((n,r)=>{const a=r+1;return n.forEach(l=>{i[l.row][l.col]=a}),{id:a,cells:[...n],start:{...n[0]},end:{...n[n.length-1]},length:n.length}});return{grid:i,paths:o}}generateSnakePath(){const e=[];switch(Math.floor(this.random()*4)){case 0:this.snakeHorizontal(e,0,1);break;case 1:this.snakeHorizontal(e,this.gridSize-1,-1);break;case 2:this.snakeVertical(e,0,1);break;case 3:this.snakeVertical(e,this.gridSize-1,-1);break}return e}snakeHorizontal(e,s,t){for(let i=0;i<this.gridSize;i++)if(i%2===0==(t===1))for(let n=0;n<this.gridSize;n++)e.push({row:i,col:n});else for(let n=this.gridSize-1;n>=0;n--)e.push({row:i,col:n})}snakeVertical(e,s,t){for(let i=0;i<this.gridSize;i++)if(i%2===0==(t===1))for(let n=0;n<this.gridSize;n++)e.push({row:n,col:i});else for(let n=this.gridSize-1;n>=0;n--)e.push({row:n,col:i})}splitPathSafely(e,s){const i=e.length;if(i<s*5)return null;const o=[0],n=Math.floor(i/s);for(let a=1;a<s;a++){const l=a*n,c=Math.floor(this.random()*(n/2))-Math.floor(n/4);let d=l+c;const u=o[o.length-1]+5,f=i-(s-a)*5;d=Math.max(u,Math.min(f,d)),o.push(d)}o.push(i);const r=[];for(let a=0;a<o.length-1;a++){const l=o[a],c=o[a+1],d=e.slice(l,c);if(d.length<5)return null;r.push(d)}return r}hasAdjacentEndpoints(e){for(const s of e){const t=s[0],i=s[s.length-1];if(Math.abs(t.row-i.row)+Math.abs(t.col-i.col)<=1)return!0}return!1}strictValidate(e){const{grid:s,paths:t}=e;for(let o=0;o<this.gridSize;o++)for(let n=0;n<this.gridSize;n++)if(s[o][n]===0)return console.log(`âŒ æ¤œè¨¼å¤±æ•—: (${o},${n})ãŒç©º`),!1;for(const o of t)for(let n=1;n<o.cells.length;n++){const r=o.cells[n-1],a=o.cells[n];if(Math.abs(r.row-a.row)+Math.abs(r.col-a.col)!==1)return console.log(`âŒ æ¤œè¨¼å¤±æ•—: ãƒ‘ã‚¹${o.id}ãŒä¸é€£ç¶š (${r.row},${r.col})â†’(${a.row},${a.col})`),!1}if(t.length<3||t.length>4)return console.log(`âŒ æ¤œè¨¼å¤±æ•—: ãƒ‘ã‚¹æ•°ãŒ${t.length}`),!1;for(const o of t)if(Math.abs(o.start.row-o.end.row)+Math.abs(o.start.col-o.end.col)<=1)return console.log(`âŒ æ¤œè¨¼å¤±æ•—: ãƒ‘ã‚¹${o.id}ã®ç«¯ç‚¹ãŒéš£æ¥`),!1;const i=this.createEmptyGrid();for(const o of t)for(const n of o.cells){if(i[n.row][n.col]!==0)return console.log(`âŒ æ¤œè¨¼å¤±æ•—: ã‚»ãƒ«é‡è¤‡ (${n.row},${n.col})`),!1;i[n.row][n.col]=o.id}return!0}formatLevelData(e,s){const t=[];return e.paths.forEach((i,o)=>{const n=o+1;t.push({row:i.start.row,col:i.start.col,type:n}),t.push({row:i.end.row,col:i.end.col,type:n})}),{gridSize:this.gridSize,snacks:t,pathCount:e.paths.length,solution:e.paths,difficulty:s}}createEmptyGrid(){return Array.from({length:this.gridSize},()=>Array(this.gridSize).fill(0))}visualize(e){const s=this.createEmptyGrid(),t=["Â·","â‘ ","â‘¡","â‘¢","â‘£"];e.snacks.forEach(o=>{s[o.row][o.col]=o.type});let i=`ã€å•é¡Œã€‘
`;for(let o=0;o<this.gridSize;o++)i+=s[o].map(n=>t[n]||"Â·").join(" ")+`
`;return i}visualizeSolution(e){if(!e.solution)return"è§£ç­”ãƒ‡ãƒ¼ã‚¿ãªã—";const s=this.createEmptyGrid(),t=["Â·","â‘ ","â‘¡","â‘¢","â‘£"];e.solution.forEach((o,n)=>{o.cells.forEach(r=>{s[r.row][r.col]=n+1})});let i=`ã€è§£ç­”ã€‘
`;for(let o=0;o<this.gridSize;o++)i+=s[o].map(n=>t[n]||"Â·").join(" ")+`
`;return i}}const nt="modulepreload",at=function(h){return"/inusanpo/"+h},Me={},Re=function(e,s,t){let i=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));i=Promise.allSettled(s.map(a=>{if(a=at(a),a in Me)return;Me[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":nt,l||(d.as="script"),d.crossOrigin="",d.href=a,r&&d.setAttribute("nonce",r),document.head.appendChild(d),l)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}function o(n){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n}return i.then(n=>{for(const r of n||[])r.status==="rejected"&&o(r.reason);return e().catch(o)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */const rt=h=>{const e=new Map;e.set("web",{name:"web"});const s=h.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},t=(o,n)=>{s.platforms.set(o,n)},i=o=>{s.platforms.has(o)&&(s.currentPlatform=s.platforms.get(o))};return s.addPlatform=t,s.setPlatform=i,s},lt=h=>h.CapacitorPlatforms=rt(h),Je=lt(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Je.addPlatform;Je.setPlatform;var pe;(function(h){h.Unimplemented="UNIMPLEMENTED",h.Unavailable="UNAVAILABLE"})(pe||(pe={}));let _e=class extends Error{constructor(e,s,t){super(e),this.message=e,this.code=s,this.data=t}};const ct=h=>{var e,s;return h!=null&&h.androidBridge?"android":!((s=(e=h==null?void 0:h.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},dt=h=>{var e,s,t,i,o;const n=h.CapacitorCustomPlatform||null,r=h.Capacitor||{},a=r.Plugins=r.Plugins||{},l=h.CapacitorPlatforms,c=()=>n!==null?n.name:ct(h),d=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||c,u=()=>d()!=="web",f=((s=l==null?void 0:l.currentPlatform)===null||s===void 0?void 0:s.isNativePlatform)||u,g=k=>{const b=C.get(k);return!!(b!=null&&b.platforms.has(d())||S(k))},m=((t=l==null?void 0:l.currentPlatform)===null||t===void 0?void 0:t.isPluginAvailable)||g,y=k=>{var b;return(b=r.PluginHeaders)===null||b===void 0?void 0:b.find(B=>B.name===k)},S=((i=l==null?void 0:l.currentPlatform)===null||i===void 0?void 0:i.getPluginHeader)||y,F=k=>h.console.error(k),x=(k,b,B)=>Promise.reject(`${B} does not have an implementation of "${b}".`),C=new Map,T=(k,b={})=>{const B=C.get(k);if(B)return console.warn(`Capacitor plugin "${k}" already registered. Cannot register plugins twice.`),B.proxy;const A=d(),R=S(k);let P;const $=async()=>(!P&&A in b?P=typeof b[A]=="function"?P=await b[A]():P=b[A]:n!==null&&!P&&"web"in b&&(P=typeof b.web=="function"?P=await b.web():P=b.web),P),q=(N,V)=>{var J,te;if(R){const se=R==null?void 0:R.methods.find(U=>V===U.name);if(se)return se.rtype==="promise"?U=>r.nativePromise(k,V.toString(),U):(U,Q)=>r.nativeCallback(k,V.toString(),U,Q);if(N)return(J=N[V])===null||J===void 0?void 0:J.bind(N)}else{if(N)return(te=N[V])===null||te===void 0?void 0:te.bind(N);throw new _e(`"${k}" plugin is not implemented on ${A}`,pe.Unimplemented)}},j=N=>{let V;const J=(...te)=>{const se=$().then(U=>{const Q=q(U,N);if(Q){const ue=Q(...te);return V=ue==null?void 0:ue.remove,ue}else throw new _e(`"${k}.${N}()" is not implemented on ${A}`,pe.Unimplemented)});return N==="addListener"&&(se.remove=async()=>V()),se};return J.toString=()=>`${N.toString()}() { [capacitor code] }`,Object.defineProperty(J,"name",{value:N,writable:!1,configurable:!1}),J},ce=j("addListener"),ne=j("removeListener"),Y=(N,V)=>{const J=ce({eventName:N},V),te=async()=>{const U=await J;ne({eventName:N,callbackId:U},V)},se=new Promise(U=>J.then(()=>U({remove:te})));return se.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await te()},se},ae=new Proxy({},{get(N,V){switch(V){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return R?Y:ce;case"removeListener":return ne;default:return j(V)}}});return a[k]=ae,C.set(k,{name:k,proxy:ae,platforms:new Set([...Object.keys(b),...R?[A]:[]])}),ae},O=((o=l==null?void 0:l.currentPlatform)===null||o===void 0?void 0:o.registerPlugin)||T;return r.convertFileSrc||(r.convertFileSrc=k=>k),r.getPlatform=d,r.handleError=F,r.isNativePlatform=f,r.isPluginAvailable=m,r.pluginMethodNoop=x,r.registerPlugin=O,r.Exception=_e,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r.platform=r.getPlatform(),r.isNative=r.isNativePlatform(),r},ht=h=>h.Capacitor=dt(h),Z=ht(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),be=Z.registerPlugin;Z.Plugins;let Qe=class{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,s){let t=!1;this.listeners[e]||(this.listeners[e]=[],t=!0),this.listeners[e].push(s);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),t&&this.sendRetainedArgumentsForEvent(e);const n=async()=>this.removeListener(e,s);return Promise.resolve({remove:n})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,t){const i=this.listeners[e];if(!i){if(t){let o=this.retainedEventArguments[e];o||(o=[]),o.push(s),this.retainedEventArguments[e]=o}return}i.forEach(o=>o(s))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:t=>{this.notifyListeners(s,t)}}}unimplemented(e="not implemented"){return new Z.Exception(e,pe.Unimplemented)}unavailable(e="not available"){return new Z.Exception(e,pe.Unavailable)}async removeListener(e,s){const t=this.listeners[e];if(!t)return;const i=t.indexOf(s);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(t=>{this.notifyListeners(e,t)}))}};const Pe=h=>encodeURIComponent(h).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Ae=h=>h.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);let ut=class extends Qe{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(t=>{if(t.length<=0)return;let[i,o]=t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=Ae(i).trim(),o=Ae(o).trim(),s[i]=o}),s}async setCookie(e){try{const s=Pe(e.key),t=Pe(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),n=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${t||""}${i}; path=${o}; ${n};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}};be("CapacitorCookies",{web:()=>new ut});const ft=async h=>new Promise((e,s)=>{const t=new FileReader;t.onload=()=>{const i=t.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},t.onerror=i=>s(i),t.readAsDataURL(h)}),gt=(h={})=>{const e=Object.keys(h);return Object.keys(h).map(i=>i.toLocaleLowerCase()).reduce((i,o,n)=>(i[o]=h[e[n]],i),{})},pt=(h,e=!0)=>h?Object.entries(h).reduce((t,i)=>{const[o,n]=i;let r,a;return Array.isArray(n)?(a="",n.forEach(l=>{r=e?encodeURIComponent(l):l,a+=`${o}=${r}&`}),a.slice(0,-1)):(r=e?encodeURIComponent(n):n,a=`${o}=${r}`),`${t}&${a}`},"").substr(1):null,mt=(h,e={})=>{const s=Object.assign({method:h.method||"GET",headers:h.headers},e),i=gt(h.headers)["content-type"]||"";if(typeof h.data=="string")s.body=h.data;else if(i.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[n,r]of Object.entries(h.data||{}))o.set(n,r);s.body=o.toString()}else if(i.includes("multipart/form-data")||h.data instanceof FormData){const o=new FormData;if(h.data instanceof FormData)h.data.forEach((r,a)=>{o.append(a,r)});else for(const r of Object.keys(h.data))o.append(r,h.data[r]);s.body=o;const n=new Headers(s.headers);n.delete("content-type"),s.headers=n}else(i.includes("application/json")||typeof h.data=="object")&&(s.body=JSON.stringify(h.data));return s};let yt=class extends Qe{async request(e){const s=mt(e,e.webFetchExtra),t=pt(e.params,e.shouldEncodeUrlParams),i=t?`${e.url}?${t}`:e.url,o=await fetch(i,s),n=o.headers.get("content-type")||"";let{responseType:r="text"}=o.ok?e:{};n.includes("application/json")&&(r="json");let a,l;switch(r){case"arraybuffer":case"blob":l=await o.blob(),a=await ft(l);break;case"json":a=await o.json();break;case"document":case"text":default:a=await o.text()}const c={};return o.headers.forEach((d,u)=>{c[u]=d}),{data:a,headers:c,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}};be("CapacitorHttp",{web:()=>new yt});var fe;(function(h){h.Heavy="HEAVY",h.Medium="MEDIUM",h.Light="LIGHT"})(fe||(fe={}));var Ie;(function(h){h.Success="SUCCESS",h.Warning="WARNING",h.Error="ERROR"})(Ie||(Ie={}));const xe=be("Haptics",{web:()=>Re(()=>import("./web-BEtukJrY.js"),__vite__mapDeps([0,1])).then(h=>new h.HapticsWeb)});class E{static init(){this.ensureUserGestureListener(),console.log("ğŸ“³ HapticManager Initialized")}static async impact(e="Medium"){if(this.isEnabled&&this.isInteractionReady())try{let s;switch(e){case"Light":s=fe.Light;break;case"Medium":s=fe.Medium;break;case"Heavy":s=fe.Heavy;break;default:s=fe.Medium}await xe.impact({style:s})}catch(s){console.debug("Haptics not available:",s)}}static async notification(e="Success"){if(this.isEnabled&&this.isInteractionReady())try{await xe.notification({type:e})}catch(s){console.debug("Haptics notification not available:",s)}}static async selection(){if(this.isEnabled&&this.isInteractionReady())try{await xe.selectionChanged()}catch(e){console.debug("Haptics selection not available:",e)}}static async vibrate(e=200){if(this.isEnabled&&this.isInteractionReady())try{await xe.vibrate({duration:e})}catch(s){console.debug("Haptics vibrate not available:",s)}}static ensureUserGestureListener(){if(this.gestureListenersBound||typeof window>"u")return;this.gestureListenersBound=!0;const e=()=>{this.hasUserGesture=!0,this.gestureEvents.forEach(s=>{window.removeEventListener(s,e,!0)})};this.gestureEvents.forEach(s=>{window.addEventListener(s,e,{capture:!0,once:!0})})}static isInteractionReady(){return typeof window>"u"||this.hasUserGesture?!0:(this.ensureUserGestureListener(),!1)}}W(E,"isEnabled",!0),W(E,"hasUserGesture",!1),W(E,"gestureListenersBound",!1),W(E,"gestureEvents",["pointerdown","touchstart","mousedown","keydown"]);/*! Capacitor: https://capacitorjs.com/ - MIT License */var me;(function(h){h.Unimplemented="UNIMPLEMENTED",h.Unavailable="UNAVAILABLE"})(me||(me={}));class Te extends Error{constructor(e,s,t){super(e),this.message=e,this.code=s,this.data=t}}const Ft=h=>{var e,s;return h!=null&&h.androidBridge?"android":!((s=(e=h==null?void 0:h.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},St=h=>{const e=h.CapacitorCustomPlatform||null,s=h.Capacitor||{},t=s.Plugins=s.Plugins||{},i=()=>e!==null?e.name:Ft(h),o=()=>i()!=="web",n=d=>{const u=l.get(d);return!!(u!=null&&u.platforms.has(i())||r(d))},r=d=>{var u;return(u=s.PluginHeaders)===null||u===void 0?void 0:u.find(f=>f.name===d)},a=d=>h.console.error(d),l=new Map,c=(d,u={})=>{const f=l.get(d);if(f)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),f.proxy;const g=i(),m=r(d);let y;const S=async()=>(!y&&g in u?y=typeof u[g]=="function"?y=await u[g]():y=u[g]:e!==null&&!y&&"web"in u&&(y=typeof u.web=="function"?y=await u.web():y=u.web),y),F=(b,B)=>{var A,R;if(m){const P=m==null?void 0:m.methods.find($=>B===$.name);if(P)return P.rtype==="promise"?$=>s.nativePromise(d,B.toString(),$):($,q)=>s.nativeCallback(d,B.toString(),$,q);if(b)return(A=b[B])===null||A===void 0?void 0:A.bind(b)}else{if(b)return(R=b[B])===null||R===void 0?void 0:R.bind(b);throw new Te(`"${d}" plugin is not implemented on ${g}`,me.Unimplemented)}},x=b=>{let B;const A=(...R)=>{const P=S().then($=>{const q=F($,b);if(q){const j=q(...R);return B=j==null?void 0:j.remove,j}else throw new Te(`"${d}.${b}()" is not implemented on ${g}`,me.Unimplemented)});return b==="addListener"&&(P.remove=async()=>B()),P};return A.toString=()=>`${b.toString()}() { [capacitor code] }`,Object.defineProperty(A,"name",{value:b,writable:!1,configurable:!1}),A},C=x("addListener"),T=x("removeListener"),O=(b,B)=>{const A=C({eventName:b},B),R=async()=>{const $=await A;T({eventName:b,callbackId:$},B)},P=new Promise($=>A.then(()=>$({remove:R})));return P.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await R()},P},k=new Proxy({},{get(b,B){switch(B){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return m?O:C;case"removeListener":return T;default:return x(B)}}});return t[d]=k,l.set(d,{name:d,proxy:k,platforms:new Set([...Object.keys(u),...m?[g]:[]])}),k};return s.convertFileSrc||(s.convertFileSrc=d=>d),s.getPlatform=i,s.handleError=a,s.isNativePlatform=o,s.isPluginAvailable=n,s.registerPlugin=c,s.Exception=Te,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},xt=h=>h.Capacitor=St(h),De=xt(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Oe=De.registerPlugin;class et{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,s){let t=!1;this.listeners[e]||(this.listeners[e]=[],t=!0),this.listeners[e].push(s);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),t&&this.sendRetainedArgumentsForEvent(e);const n=async()=>this.removeListener(e,s);return Promise.resolve({remove:n})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,t){const i=this.listeners[e];if(!i){if(t){let o=this.retainedEventArguments[e];o||(o=[]),o.push(s),this.retainedEventArguments[e]=o}return}i.forEach(o=>o(s))}hasListeners(e){var s;return!!(!((s=this.listeners[e])===null||s===void 0)&&s.length)}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:t=>{this.notifyListeners(s,t)}}}unimplemented(e="not implemented"){return new De.Exception(e,me.Unimplemented)}unavailable(e="not available"){return new De.Exception(e,me.Unavailable)}async removeListener(e,s){const t=this.listeners[e];if(!t)return;const i=t.indexOf(s);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(t=>{this.notifyListeners(e,t)}))}}const ze=h=>encodeURIComponent(h).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Le=h=>h.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class wt extends et{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(t=>{if(t.length<=0)return;let[i,o]=t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=Le(i).trim(),o=Le(o).trim(),s[i]=o}),s}async setCookie(e){try{const s=ze(e.key),t=ze(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),n=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${t||""}${i}; path=${o}; ${n};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Oe("CapacitorCookies",{web:()=>new wt});const kt=async h=>new Promise((e,s)=>{const t=new FileReader;t.onload=()=>{const i=t.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},t.onerror=i=>s(i),t.readAsDataURL(h)}),Ct=(h={})=>{const e=Object.keys(h);return Object.keys(h).map(i=>i.toLocaleLowerCase()).reduce((i,o,n)=>(i[o]=h[e[n]],i),{})},bt=(h,e=!0)=>h?Object.entries(h).reduce((t,i)=>{const[o,n]=i;let r,a;return Array.isArray(n)?(a="",n.forEach(l=>{r=e?encodeURIComponent(l):l,a+=`${o}=${r}&`}),a.slice(0,-1)):(r=e?encodeURIComponent(n):n,a=`${o}=${r}`),`${t}&${a}`},"").substr(1):null,_t=(h,e={})=>{const s=Object.assign({method:h.method||"GET",headers:h.headers},e),i=Ct(h.headers)["content-type"]||"";if(typeof h.data=="string")s.body=h.data;else if(i.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[n,r]of Object.entries(h.data||{}))o.set(n,r);s.body=o.toString()}else if(i.includes("multipart/form-data")||h.data instanceof FormData){const o=new FormData;if(h.data instanceof FormData)h.data.forEach((r,a)=>{o.append(a,r)});else for(const r of Object.keys(h.data))o.append(r,h.data[r]);s.body=o;const n=new Headers(s.headers);n.delete("content-type"),s.headers=n}else(i.includes("application/json")||typeof h.data=="object")&&(s.body=JSON.stringify(h.data));return s};class Tt extends et{async request(e){const s=_t(e,e.webFetchExtra),t=bt(e.params,e.shouldEncodeUrlParams),i=t?`${e.url}?${t}`:e.url,o=await fetch(i,s),n=o.headers.get("content-type")||"";let{responseType:r="text"}=o.ok?e:{};n.includes("application/json")&&(r="json");let a,l;switch(r){case"arraybuffer":case"blob":l=await o.blob(),a=await kt(l);break;case"json":a=await o.json();break;case"document":case"text":default:a=await o.text()}const c={};return o.headers.forEach((d,u)=>{c[u]=d}),{data:a,headers:c,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Oe("CapacitorHttp",{web:()=>new Tt});var Ue;(function(h){h.General="General",h.ParentalGuidance="ParentalGuidance",h.Teen="Teen",h.MatureAudience="MatureAudience"})(Ue||(Ue={}));var He;(function(h){h.SizeChanged="bannerAdSizeChanged",h.Loaded="bannerAdLoaded",h.FailedToLoad="bannerAdFailedToLoad",h.Opened="bannerAdOpened",h.Closed="bannerAdClosed",h.AdImpression="bannerAdImpression"})(He||(He={}));var Ke;(function(h){h.TOP_CENTER="TOP_CENTER",h.CENTER="CENTER",h.BOTTOM_CENTER="BOTTOM_CENTER"})(Ke||(Ke={}));var $e;(function(h){h.BANNER="BANNER",h.FULL_BANNER="FULL_BANNER",h.LARGE_BANNER="LARGE_BANNER",h.MEDIUM_RECTANGLE="MEDIUM_RECTANGLE",h.LEADERBOARD="LEADERBOARD",h.ADAPTIVE_BANNER="ADAPTIVE_BANNER",h.SMART_BANNER="SMART_BANNER"})($e||($e={}));var ge;(function(h){h.Loaded="interstitialAdLoaded",h.FailedToLoad="interstitialAdFailedToLoad",h.Showed="interstitialAdShowed",h.FailedToShow="interstitialAdFailedToShow",h.Dismissed="interstitialAdDismissed"})(ge||(ge={}));var Ne;(function(h){h.Loaded="onRewardedInterstitialAdLoaded",h.FailedToLoad="onRewardedInterstitialAdFailedToLoad",h.Showed="onRewardedInterstitialAdShowed",h.FailedToShow="onRewardedInterstitialAdFailedToShow",h.Dismissed="onRewardedInterstitialAdDismissed",h.Rewarded="onRewardedInterstitialAdReward"})(Ne||(Ne={}));var We;(function(h){h.Loaded="onRewardedVideoAdLoaded",h.FailedToLoad="onRewardedVideoAdFailedToLoad",h.Showed="onRewardedVideoAdShowed",h.FailedToShow="onRewardedVideoAdFailedToShow",h.Dismissed="onRewardedVideoAdDismissed",h.Rewarded="onRewardedVideoAdReward"})(We||(We={}));var Ge;(function(h){h.NOT_REQUIRED="NOT_REQUIRED",h.OBTAINED="OBTAINED",h.REQUIRED="REQUIRED",h.UNKNOWN="UNKNOWN"})(Ge||(Ge={}));var Ye;(function(h){h[h.DISABLED=0]="DISABLED",h[h.EEA=1]="EEA",h[h.NOT_EEA=2]="NOT_EEA",h[h.US=3]="US",h[h.OTHER=4]="OTHER"})(Ye||(Ye={}));const re=Oe("AdMob",{web:()=>Re(()=>import("./web-CabQi2pA.js"),__vite__mapDeps([2,1])).then(h=>new h.AdMobWeb)}),ie={isAdRemoved:!1,interstitialLoaded:!1,initialized:!1,clearCount:0,AD_INTERVAL:3,TEST_AD_IDS:{android:{interstitial:"ca-app-pub-3940256099942544/1033173712"},ios:{interstitial:"ca-app-pub-3940256099942544/4411468910"}},PRODUCTION_AD_IDS:{android:{interstitial:"ca-app-pub-3040113142694955/8235479861"},ios:{interstitial:"ca-app-pub-3040113142694955/8701559311"}},async initialize(){if(Z.getPlatform()==="web"){console.log("[AdManager] Webç’°å¢ƒã®ãŸã‚åºƒå‘Šã¯ç„¡åŠ¹ã§ã™");return}if(this.initialized){console.log("[AdManager] æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿ã§ã™");return}try{if(this.loadAdRemovedState(),this.isAdRemoved){console.log("[AdManager] åºƒå‘Šã¯å‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™"),this.initialized=!0;return}await re.initialize({testingDevices:[],initializeForTesting:!1}),this.setupEventListeners(),Z.getPlatform()==="ios"&&(await re.trackingAuthorizationStatus()).status==="notDetermined"&&await re.requestTrackingAuthorization(),await this.prepareInterstitial(),this.initialized=!0,console.log("[AdManager] åˆæœŸåŒ–å®Œäº†")}catch(h){console.error("[AdManager] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",h)}},setupEventListeners(){re.addListener(ge.Loaded,()=>{console.log("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šèª­ã¿è¾¼ã¿å®Œäº†"),this.interstitialLoaded=!0}),re.addListener(ge.FailedToLoad,h=>{console.error("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šèª­ã¿è¾¼ã¿å¤±æ•—:",h),this.interstitialLoaded=!1,setTimeout(()=>this.prepareInterstitial(),5e3)}),re.addListener(ge.Dismissed,()=>{console.log("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘ŠãŒé–‰ã˜ã‚‰ã‚Œã¾ã—ãŸ"),this.interstitialLoaded=!1,this.prepareInterstitial()}),re.addListener(ge.FailedToShow,h=>{console.error("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šè¡¨ç¤ºå¤±æ•—:",h),this.interstitialLoaded=!1,this.prepareInterstitial()})},getInterstitialId(){var s;const h=Z.getPlatform();return((s=this.PRODUCTION_AD_IDS[h])==null?void 0:s.interstitial)||""},async prepareInterstitial(){if(!this.isAdRemoved&&Z.getPlatform()!=="web")try{const h=this.getInterstitialId();if(!h){console.error("[AdManager] åºƒå‘Šãƒ¦ãƒ‹ãƒƒãƒˆIDãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“");return}await re.prepareInterstitial({adId:h,isTesting:!1}),console.log("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã‚’æº–å‚™ä¸­...")}catch(h){console.error("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šæº–å‚™ã‚¨ãƒ©ãƒ¼:",h)}},async showInterstitial(){if(this.isAdRemoved)return console.log("[AdManager] åºƒå‘Šã¯å‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™"),!1;if(Z.getPlatform()==="web")return console.log("[AdManager] Webç’°å¢ƒã®ãŸã‚åºƒå‘Šã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“"),!1;if(!this.interstitialLoaded)return console.log("[AdManager] åºƒå‘ŠãŒã¾ã èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“"),await this.prepareInterstitial(),!1;try{return await re.showInterstitial(),console.log("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã‚’è¡¨ç¤ºã—ã¾ã—ãŸ"),!0}catch(h){return console.error("[AdManager] ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šè¡¨ç¤ºã‚¨ãƒ©ãƒ¼:",h),this.interstitialLoaded=!1,this.prepareInterstitial(),!1}},async onStageEnd(){return this.isAdRemoved?!1:(this.clearCount++,this.clearCount>=this.AD_INTERVAL?(this.clearCount=0,await this.showInterstitial()):!1)},removeAds(){this.isAdRemoved=!0,this.saveAdRemovedState(),console.log("[AdManager] åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ")},saveAdRemovedState(){try{localStorage.setItem("inusanpo_ads_removed","true")}catch(h){console.error("[AdManager] çŠ¶æ…‹ä¿å­˜ã‚¨ãƒ©ãƒ¼:",h)}},loadAdRemovedState(){try{const h=localStorage.getItem("inusanpo_ads_removed");this.isAdRemoved=h==="true"}catch(h){console.error("[AdManager] çŠ¶æ…‹å¾©å…ƒã‚¨ãƒ©ãƒ¼:",h)}},setAdInterval(h){this.AD_INTERVAL=Math.max(1,h),console.log(`[AdManager] åºƒå‘Šè¡¨ç¤ºé–“éš”ã‚’ ${this.AD_INTERVAL} ã‚¹ãƒ†ãƒ¼ã‚¸ã”ã¨ã«è¨­å®š`)}};var Ve;(function(h){h[h.APPLE_SEARCH_ADS=0]="APPLE_SEARCH_ADS",h[h.ADJUST=1]="ADJUST",h[h.APPSFLYER=2]="APPSFLYER",h[h.BRANCH=3]="BRANCH",h[h.TENJIN=4]="TENJIN",h[h.FACEBOOK=5]="FACEBOOK"})(Ve||(Ve={}));var de;(function(h){h.INAPP="inapp",h.SUBS="subs"})(de||(de={}));var je;(function(h){h[h.SUBSCRIPTIONS=0]="SUBSCRIPTIONS",h[h.SUBSCRIPTIONS_UPDATE=1]="SUBSCRIPTIONS_UPDATE",h[h.IN_APP_ITEMS_ON_VR=2]="IN_APP_ITEMS_ON_VR",h[h.SUBSCRIPTIONS_ON_VR=3]="SUBSCRIPTIONS_ON_VR",h[h.PRICE_CHANGE_CONFIRMATION=4]="PRICE_CHANGE_CONFIRMATION"})(je||(je={}));var Xe;(function(h){h[h.UNKNOWN_SUBSCRIPTION_UPGRADE_DOWNGRADE_POLICY=0]="UNKNOWN_SUBSCRIPTION_UPGRADE_DOWNGRADE_POLICY",h[h.IMMEDIATE_WITH_TIME_PRORATION=1]="IMMEDIATE_WITH_TIME_PRORATION",h[h.IMMEDIATE_AND_CHARGE_PRORATED_PRICE=2]="IMMEDIATE_AND_CHARGE_PRORATED_PRICE",h[h.IMMEDIATE_WITHOUT_PRORATION=3]="IMMEDIATE_WITHOUT_PRORATION",h[h.DEFERRED=4]="DEFERRED"})(Xe||(Xe={}));var qe;(function(h){h.UNKNOWN="UNKNOWN",h.CUSTOM="CUSTOM",h.LIFETIME="LIFETIME",h.ANNUAL="ANNUAL",h.SIX_MONTH="SIX_MONTH",h.THREE_MONTH="THREE_MONTH",h.TWO_MONTH="TWO_MONTH",h.MONTHLY="MONTHLY",h.WEEKLY="WEEKLY"})(qe||(qe={}));var Ze;(function(h){h[h.INTRO_ELIGIBILITY_STATUS_UNKNOWN=0]="INTRO_ELIGIBILITY_STATUS_UNKNOWN",h[h.INTRO_ELIGIBILITY_STATUS_INELIGIBLE=1]="INTRO_ELIGIBILITY_STATUS_INELIGIBLE",h[h.INTRO_ELIGIBILITY_STATUS_ELIGIBLE=2]="INTRO_ELIGIBILITY_STATUS_ELIGIBLE"})(Ze||(Ze={}));const le=be("NativePurchases",{web:()=>Re(()=>import("./web-yrZVTxYl.js"),__vite__mapDeps([3,1])).then(h=>new h.NativePurchasesWeb)}),K={initialized:!1,billingSupported:!1,purchaseState:{removeAds:!1,customize:!1,deluxe:!1},PRODUCT_IDS:{DELUXE:"com.kerofen.inusanpo.deluxe",CUSTOMIZE:"com.kerofen.inusanpo.customize",REMOVE_ADS:"com.kerofen.inusanpo.remove_ads",SINGLE_DOG:"com.kerofen.inusanpo.single_dog"},products:[],async initialize(){if(Z.getPlatform()==="web"){console.log("[PurchaseManager] Webç’°å¢ƒã®ãŸã‚èª²é‡‘ã¯ç„¡åŠ¹ã§ã™");return}if(this.initialized){console.log("[PurchaseManager] æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿ã§ã™");return}try{const{isBillingSupported:h}=await le.isBillingSupported();if(this.billingSupported=h,!h){console.warn("[PurchaseManager] ã“ã®ç«¯æœ«ã§ã¯èª²é‡‘ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“");return}this.loadPurchaseState(),await this.loadProducts(),await this.restorePurchasesSilent(),this.initialized=!0,console.log("[PurchaseManager] åˆæœŸåŒ–å®Œäº†")}catch(h){console.error("[PurchaseManager] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",h)}},async loadProducts(){if(!this.billingSupported)return[];try{const{products:h}=await le.getProducts({productIdentifiers:[this.PRODUCT_IDS.DELUXE,this.PRODUCT_IDS.CUSTOMIZE,this.PRODUCT_IDS.REMOVE_ADS],productType:de.INAPP}),{products:e}=await le.getProducts({productIdentifiers:[this.PRODUCT_IDS.SINGLE_DOG],productType:de.INAPP});return this.products=[...h||[],...e||[]],console.log("[PurchaseManager] å•†å“æƒ…å ±å–å¾—:",this.products),console.log("[PurchaseManager] å–å¾—ã—ãŸå•†å“æ•°:",this.products.length),this.products.length===0&&(console.warn("[PurchaseManager] âš ï¸ å•†å“ãŒ0ä»¶ã§ã™ã€‚App Store Connectã§å•†å“ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚"),console.warn("[PurchaseManager] æœŸå¾…ã•ã‚Œã‚‹å•†å“ID:",[this.PRODUCT_IDS.DELUXE,this.PRODUCT_IDS.CUSTOMIZE,this.PRODUCT_IDS.REMOVE_ADS,this.PRODUCT_IDS.SINGLE_DOG])),this.products}catch(h){return console.error("[PurchaseManager] å•†å“æƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼:",h),[]}},getProduct(h){return this.products.find(e=>e.productIdentifier===h)||null},async purchaseDeluxe(){const h=await this.purchaseProduct(this.PRODUCT_IDS.DELUXE,"deluxe");return h.success&&(this.purchaseState.removeAds=!0,this.purchaseState.customize=!0,this.savePurchaseState(),this.onRemoveAdsPurchased(),this.onCustomizePurchased()),h},async purchaseCustomize(){const h=await this.purchaseProduct(this.PRODUCT_IDS.CUSTOMIZE,"customize");return h.success&&this.onCustomizePurchased(),h},async purchaseRemoveAds(){const h=await this.purchaseProduct(this.PRODUCT_IDS.REMOVE_ADS,"removeAds");return h.success&&this.onRemoveAdsPurchased(),h},async purchaseSingleDog(){var h,e,s,t;if(Z.getPlatform()==="web")return{success:!1,error:"Webç’°å¢ƒã§ã¯è³¼å…¥ã§ãã¾ã›ã‚“"};if(!this.billingSupported)return{success:!1,error:"ã“ã®ç«¯æœ«ã§ã¯èª²é‡‘ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{console.log(`[PurchaseManager] è³¼å…¥é–‹å§‹: ${this.PRODUCT_IDS.SINGLE_DOG}`);const i=await le.purchaseProduct({productIdentifier:this.PRODUCT_IDS.SINGLE_DOG,productType:de.INAPP,quantity:1});return console.log("[PurchaseManager] è³¼å…¥çµæœ:",i),i&&(i.transactionId||i.transaction||i.productIdentifier)?(window.dispatchEvent(new CustomEvent("singleDogPurchased")),{success:!0}):{success:!1,error:"è³¼å…¥ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"}}catch(i){return console.error("[PurchaseManager] è³¼å…¥ã‚¨ãƒ©ãƒ¼:",i),console.error("[PurchaseManager] ã‚¨ãƒ©ãƒ¼è©³ç´°:",JSON.stringify(i,null,2)),i.code==="PURCHASE_CANCELLED"||(h=i.message)!=null&&h.includes("cancel")||(e=i.message)!=null&&e.includes("Cancel")||(s=i.message)!=null&&s.includes("User cancelled")?{success:!1,error:"è³¼å…¥ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"}:(t=i.message)!=null&&t.includes("Cannot find product")?{success:!1,error:"å•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚App Store Connectã§å•†å“ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚"}:{success:!1,error:i.message||"è³¼å…¥å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"}}},async purchaseProduct(h,e){var s,t,i,o;if(Z.getPlatform()==="web")return{success:!1,error:"Webç’°å¢ƒã§ã¯è³¼å…¥ã§ãã¾ã›ã‚“"};if(!this.billingSupported)return{success:!1,error:"ã“ã®ç«¯æœ«ã§ã¯èª²é‡‘ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{console.log(`[PurchaseManager] è³¼å…¥é–‹å§‹: ${h}`);const n=await le.purchaseProduct({productIdentifier:h,productType:de.INAPP,quantity:1});return console.log("[PurchaseManager] è³¼å…¥çµæœ:",n),n&&(n.transactionId||n.transaction||n.productIdentifier)?(this.purchaseState[e]=!0,this.savePurchaseState(),{success:!0}):{success:!1,error:"è³¼å…¥ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"}}catch(n){return console.error("[PurchaseManager] è³¼å…¥ã‚¨ãƒ©ãƒ¼:",n),console.error("[PurchaseManager] ã‚¨ãƒ©ãƒ¼è©³ç´°:",JSON.stringify(n,null,2)),n.code==="PURCHASE_CANCELLED"||(s=n.message)!=null&&s.includes("cancel")||(t=n.message)!=null&&t.includes("Cancel")||(i=n.message)!=null&&i.includes("User cancelled")?{success:!1,error:"è³¼å…¥ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"}:(o=n.message)!=null&&o.includes("Cannot find product")?{success:!1,error:"å•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚App Store Connectã§å•†å“ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚"}:{success:!1,error:n.message||"è³¼å…¥å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"}}},_processPurchases(h){const e=[];for(const s of h){const t=s.productIdentifier;t===this.PRODUCT_IDS.DELUXE&&(this.purchaseState.deluxe=!0,this.purchaseState.removeAds=!0,this.purchaseState.customize=!0,e.push("ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚»ãƒƒãƒˆ"),this.onRemoveAdsPurchased(),this.onCustomizePurchased()),t===this.PRODUCT_IDS.CUSTOMIZE&&(this.purchaseState.customize=!0,e.push("ã„ã‚ã©ã‚Šãƒ‘ãƒƒã‚¯"),this.onCustomizePurchased()),t===this.PRODUCT_IDS.REMOVE_ADS&&(this.purchaseState.removeAds=!0,e.push("åºƒå‘Šå‰Šé™¤"),this.onRemoveAdsPurchased())}return e.length>0&&this.savePurchaseState(),e},async restorePurchases(){if(Z.getPlatform()==="web")return{success:!1,restored:[],error:"Webç’°å¢ƒã§ã¯å¾©å…ƒã§ãã¾ã›ã‚“"};if(!this.billingSupported)return{success:!1,restored:[],error:"ã“ã®ç«¯æœ«ã§ã¯èª²é‡‘ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“"};try{console.log("[PurchaseManager] è³¼å…¥å¾©å…ƒé–‹å§‹"),await le.restorePurchases();const{purchases:h}=await le.getPurchases({productType:de.INAPP});console.log("[PurchaseManager] è³¼å…¥å±¥æ­´:",h);const e=this._processPurchases(h||[]);return e.length>0?(console.log("[PurchaseManager] å¾©å…ƒå®Œäº†:",e),{success:!0,restored:e}):{success:!0,restored:[],error:"å¾©å…ƒå¯èƒ½ãªè³¼å…¥ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ"}}catch(h){return console.error("[PurchaseManager] è³¼å…¥å¾©å…ƒã‚¨ãƒ©ãƒ¼:",h),{success:!1,restored:[],error:h.message||"å¾©å…ƒå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"}}},async restorePurchasesSilent(){try{await le.restorePurchases();const{purchases:h}=await le.getPurchases({productType:de.INAPP});this._processPurchases(h||[])}catch(h){console.log("[PurchaseManager] ã‚µã‚¤ãƒ¬ãƒ³ãƒˆå¾©å…ƒã‚¹ã‚­ãƒƒãƒ—:",h.message)}},onRemoveAdsPurchased(){try{window.dispatchEvent(new CustomEvent("adsRemoved")),localStorage.setItem("inusanpo_ads_removed","true")}catch(h){console.error("[PurchaseManager] åºƒå‘Šå‰Šé™¤é€šçŸ¥ã‚¨ãƒ©ãƒ¼:",h)}},onCustomizePurchased(){try{window.dispatchEvent(new CustomEvent("customizeUnlocked"))}catch(h){console.error("[PurchaseManager] ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºè§£æ”¾é€šçŸ¥ã‚¨ãƒ©ãƒ¼:",h)}},savePurchaseState(){try{localStorage.setItem("inusanpo_purchase_state",JSON.stringify(this.purchaseState))}catch(h){console.error("[PurchaseManager] çŠ¶æ…‹ä¿å­˜ã‚¨ãƒ©ãƒ¼:",h)}},loadPurchaseState(){try{const h=localStorage.getItem("inusanpo_purchase_state");if(h){const e=JSON.parse(h);this.purchaseState={...this.purchaseState,...e}}}catch(h){console.error("[PurchaseManager] çŠ¶æ…‹å¾©å…ƒã‚¨ãƒ©ãƒ¼:",h)}},isAdsRemoved(){return this.purchaseState.removeAds},hasCustomize(){return this.purchaseState.customize},hasDeluxe(){return this.purchaseState.deluxe},hasPremiumDogs(){return this.purchaseState.customize||this.purchaseState.deluxe},getFormattedPrice(h){var s;const e=this.getProduct(h);return e&&(e.priceString||((s=e.price)==null?void 0:s.toString()))||"---"},getShopItems(){return[{id:this.PRODUCT_IDS.DELUXE,name:"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚»ãƒƒãƒˆ",description:"åºƒå‘Šã‘ã—ï¼‹ã„ã‚ã©ã‚Šãƒ‘ãƒƒã‚¯ ã¾ã¨ã‚ã¦ãŠã¨ãï¼",price:this.getFormattedPrice(this.PRODUCT_IDS.DELUXE),purchased:this.purchaseState.deluxe,icon:"pack_premium",isHero:!0},{id:this.PRODUCT_IDS.CUSTOMIZE,name:"ã„ã‚ã©ã‚Šãƒ‘ãƒƒã‚¯",description:"è‚‰çƒã‚«ãƒ©ãƒ¼ã‚„ãã›ã‹ãˆã€ãƒ†ãƒ¼ãƒã‚’ãœã‚“ã¶è§£æ”¾ï¼",price:this.getFormattedPrice(this.PRODUCT_IDS.CUSTOMIZE),purchased:this.purchaseState.customize,icon:"pack_customize"},{id:this.PRODUCT_IDS.REMOVE_ADS,name:"ã“ã†ã“ãã‘ã—",description:"ã™ã¹ã¦ã®åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã™",price:this.getFormattedPrice(this.PRODUCT_IDS.REMOVE_ADS),purchased:this.purchaseState.removeAds,icon:"pack_noads"},{id:this.PRODUCT_IDS.SINGLE_DOG,name:"ãƒ¯ãƒ³ã‚³ã‚’è¿ãˆã‚‹",description:"ã™ããªãƒ¯ãƒ³ã‚³ã‚’ï¼‘åŒ¹ãˆã‚‰ã¹ã‚‹ï¼",price:this.getFormattedPrice(this.PRODUCT_IDS.SINGLE_DOG),purchased:!1,icon:"pack_dog",isConsumable:!0}]}};if(typeof window<"u"&&window.console){const h=console.warn,e=console.error,s=t=>{const i=t.toLowerCase();return i.includes("audiocontext was not allowed to start")||i.includes("must be resumed (or created) after a user gesture")||i.includes("blocked call to navigator.vibrate")||i.includes("error decoding audio")||i.includes("unable to decode audio data")||i.includes("failed to process file")||i.includes("audio")&&i.includes("error")};console.warn=function(...t){const i=t.join(" ");s(i)||h.apply(console,t)},console.error=function(...t){const i=t.join(" ");s(i)||e.apply(console,t)}}const Dt=!1;class _{static preload(e){this.loadedAudioFiles=this.loadedAudioFiles||new Set,e.load.on("filecomplete-audio",s=>{this.loadedAudioFiles.add(s)}),e.load.on("loaderror",s=>{var t,i;s.type==="audio"||(t=s.key)!=null&&t.startsWith("sfx_")||(i=s.key)!=null&&i.startsWith("bgm_")}),e.load.on("filecomplete",(s,t)=>{t==="audio"&&this.loadedAudioFiles.add(s)}),Object.entries(this.AUDIO_MAP).forEach(([s,t])=>{try{e.load.audio(s,t.path)}catch{}})}static ensureUnlocked(e){var a;const s=e==null?void 0:e.sound;if(!(e!=null&&e.input)||!s)return;const t=(a=s.context)==null?void 0:a.state,i=s.locked||t==="suspended";if(console.log("ğŸ”Š AudioManager.ensureUnlocked:",{contextState:t,soundLocked:s.locked,needsUnlock:i,unlocked:this.unlocked,listenerAttached:this.unlockListenerAttached}),!i&&this.unlocked||this.unlockListenerAttached)return;const o=this,n=()=>{typeof window>"u"||o.globalUnlockEvents.forEach(l=>{window.removeEventListener(l,r,!0)})},r=async l=>{var f,g,m,y,S;console.log("ğŸ”Š tryUnlock called:",l==null?void 0:l.type),o.unlockListenerAttached=!1,n();const c=e.sound;if(!c)return;if(console.log("ğŸ”Š Current context state:",(f=c.context)==null?void 0:f.state,"locked:",c.locked),((g=c.context)==null?void 0:g.state)==="suspended"){console.log("ğŸ”Š Attempting to resume AudioContext...");try{l&&l.type&&(await c.context.resume(),console.log("ğŸ”Š AudioContext resumed successfully! State:",(m=c.context)==null?void 0:m.state))}catch(F){console.log("ğŸ”Š AudioContext resume failed:",F)}}if(c.locked)try{c.unlock();for(let F=0;F<10;F++)if(await new Promise(x=>setTimeout(x,50)),!c.locked){console.log("ğŸ”Š Sound unlocked after",(F+1)*50,"ms");break}}catch(F){console.debug("Sound unlock failed",F)}const d=((y=c.context)==null?void 0:y.state)==="running",u=d&&!c.locked;if(console.log("ğŸ”Š After unlock attempt - context state:",(S=c.context)==null?void 0:S.state,"locked:",c.locked,"isRunning:",u),d){if(console.log("ğŸ”Š AudioContext is running! Unlocking AudioManager..."),o.unlocked=!0,o.pendingBgm){console.log("ğŸ”Š Playing pending BGM:",o.pendingBgm.key);const F=o.pendingBgm;o.pendingBgm=null,setTimeout(()=>{o.playBgm(F.scene,F.key,F.config)},100)}}else console.log("ğŸ”Š AudioContext still not running, will retry on next interaction"),o.ensureUnlocked(e)};e.input.once("pointerdown",r),e.input.once("pointerup",r),typeof window<"u"&&this.globalUnlockEvents.forEach(l=>{window.addEventListener(l,r,{once:!0,passive:!0,capture:!0})}),this.unlockListenerAttached=!0}static applySettings(e={}){if(this.bgmEnabled=e.bgmEnabled!==!1,this.seEnabled=e.seEnabled!==!1,this.bgmVolume=typeof e.bgmVolume=="number"?e.bgmVolume:1,this.seVolume=typeof e.seVolume=="number"?e.seVolume:1,this.bgmEnabled||this.stopBgm(0),this.currentBgmSound&&this.currentBgmSound.isPlaying){const s=this.AUDIO_MAP[this.currentBgmKey],t=(s==null?void 0:s.volume)??.6;this.currentBgmSound.setVolume(t*this.bgmVolume)}}static playBgm(e,s,t={}){var r;if(this.lastScene=e,this.lastRequestedBgm=s,!this.bgmEnabled||!(e!=null&&e.sound))return;const i=e.sound,o=(r=i.context)==null?void 0:r.state;if(o==="suspended"){this.pendingBgm={scene:e,key:s,config:t},this.ensureUnlocked(e);return}if(!this.unlocked&&o==="running"&&(this.unlocked=!0,console.log("ğŸ”Š AudioManager auto-unlocked because context is running")),this.currentBgmKey===s&&!t.forceRestart)return;this.stopBgm(200);const n=this.AUDIO_MAP[s];if(n&&!(this.loadedAudioFiles&&!this.loadedAudioFiles.has(s)))try{if(!e.cache.audio.exists(s))return;const a=n.volume??.6,l=i.add(s,{loop:n.loop!==!1,volume:a*this.bgmVolume,...t});l.play(),this.currentBgmSound=l,this.currentBgmKey=s}catch{}}static stopBgm(e=150){if(this.currentBgmSound){const s=this.currentBgmSound,t=this.lastScene;e>0&&t&&t.tweens?t.tweens.add({targets:s,volume:0,duration:e,onComplete:()=>s.stop()}):s.stop()}this.currentBgmSound=null,this.currentBgmKey=null}static playSfx(e,s,t={}){var r;const i=e==null?void 0:e.sound;if(!i)return;if(((r=i.context)==null?void 0:r.state)==="suspended"){i.once(w.Sound.Events.UNLOCKED,()=>this.playSfx(e,s,t));return}if(!this.seEnabled)return;const n=this.AUDIO_MAP[s];if(n&&!(this.loadedAudioFiles&&!this.loadedAudioFiles.has(s)))try{if(!e.cache.audio.exists(s))return;const a=n.volume??.6;i.play(s,{volume:a*this.seVolume,...t})}catch{}}static setBgmEnabled(e){this.bgmEnabled=e,e?this.lastScene&&this.lastRequestedBgm&&this.playBgm(this.lastScene,this.lastRequestedBgm):(this.stopBgm(150),this.pendingBgm=null)}static setSeEnabled(e){this.seEnabled=e}static setBgmVolume(e){if(this.bgmVolume=Math.max(0,Math.min(1,e)),this.currentBgmSound&&this.currentBgmSound.isPlaying){const s=this.AUDIO_MAP[this.currentBgmKey],t=(s==null?void 0:s.volume)??.6;this.currentBgmSound.setVolume(t*this.bgmVolume)}}static setSeVolume(e){this.seVolume=Math.max(0,Math.min(1,e))}static async unlockFromUserGesture(e){const s=e==null?void 0:e.sound;if(!(!s||!s.context)){if(console.log("ğŸ”Š unlockFromUserGesture called, context state:",s.context.state),s.context.state==="suspended")try{await s.context.resume(),console.log("ğŸ”Š AudioContext resumed! New state:",s.context.state)}catch(t){console.log("ğŸ”Š Resume failed:",t)}if(s.locked)try{s.unlock()}catch(t){console.debug("Sound unlock failed",t)}if(s.context.state==="running"&&!s.locked&&(this.unlocked=!0,console.log("ğŸ”Š AudioManager unlocked successfully!"),this.pendingBgm)){console.log("ğŸ”Š Playing pending BGM:",this.pendingBgm.key);const t=this.pendingBgm;this.pendingBgm=null,this.playBgm(t.scene,t.key,t.config)}}}}W(_,"bgmEnabled",!0),W(_,"seEnabled",!0),W(_,"bgmVolume",1),W(_,"seVolume",1),W(_,"currentBgmKey",null),W(_,"currentBgmSound",null),W(_,"lastScene",null),W(_,"lastRequestedBgm",null),W(_,"unlocked",!1),W(_,"pendingBgm",null),W(_,"unlockListenerAttached",!1),W(_,"globalUnlockEvents",["pointerdown","touchstart","mousedown","keydown"]),W(_,"AUDIO_MAP",{bgm_title:{path:"./assets/audio/bgm/bgm_title_comicalnichijo.mp3",volume:.32,loop:!0},bgm_select:{path:"./assets/audio/bgm/bgm_menu_puzzle_cooking.mp3",volume:.22,loop:!0},bgm_story:{path:"./assets/audio/bgm/bgm_game_honobono.mp3",volume:.36,loop:!0},bgm_challenge:{path:"./assets/audio/bgm/bgm_game_honobono.mp3",volume:.36,loop:!0},sfx_ui_tap:{path:"./assets/audio/se/se_button_tap.mp3",volume:.95},sfx_ui_toggle:{path:"./assets/audio/se/se_button_tap.mp3",volume:.85},sfx_draw_start:{path:"./assets/audio/se/se_tile_trace.mp3",volume:.39},sfx_draw_step:{path:"./assets/audio/se/se_tile_trace.mp3",volume:.22},sfx_connect:{path:"./assets/audio/se/se_connect_v2_koron.mp3",volume:.9},sfx_reset:{path:"./assets/audio/se/se_connect_v2_pokon.mp3",volume:.62},sfx_hint:{path:"./assets/audio/se/se_clear_v2_kirakira.mp3",volume:.85},sfx_clear:{path:"./assets/audio/se/se_clear_v2_pyurun.mp3",volume:.9},sfx_gameover:{path:"./assets/audio/se/se_gameover_v2_koron.mp3",volume:.57},sfx_challenge_combo:{path:"./assets/audio/se/se_connect_v2_poyoyon.mp3",volume:.85},sfx_achievement:{path:"./assets/audio/se/se_clear_v2_pikon.mp3",volume:.9},sfx_unlock_item:{path:"./assets/audio/se/ã‚·ãƒ£ã‚­ãƒ¼ãƒ³2.mp3",volume:.71},sfx_medal:{path:"./assets/audio/se/se_clear_v2_pikon.mp3",volume:.9}});function tt(){try{const h=localStorage.getItem("inusanpo_cleared");return h?JSON.parse(h):[]}catch(h){return console.error("ã‚¯ãƒªã‚¢çŠ¶æ…‹ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",h),[]}}function Rt(h){try{const e=tt();e.includes(h)||(e.push(h),localStorage.setItem("inusanpo_cleared",JSON.stringify(e)),console.log(`âœ… ã‚¹ãƒ†ãƒ¼ã‚¸ ${h} ã‚¯ãƒªã‚¢ä¿å­˜ï¼`))}catch(e){console.error("ã‚¯ãƒªã‚¢çŠ¶æ…‹ã®ä¿å­˜ã«å¤±æ•—:",e)}}const H={CELL_PADDING:6,CORNER_RADIUS:8},M={TOP:50,BOTTOM:34},I={sky:8900331,grass:9419919,grassDark:7048811,ground:14596231,cellBg:16775920,cellOutline:4868682,uiBg:16776693,uiOutline:6114871,textDark:"#4A4A4A"},D={title:{fontFamily:"KeiFont, sans-serif",fontSize:"32px",color:I.textDark,stroke:"#FFFFFF",strokeThickness:6,shadow:{offsetX:2,offsetY:3,color:"#00000033",blur:4,fill:!0}},heading:{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:I.textDark,stroke:"#FFFFFF",strokeThickness:3},section:{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:4,shadow:{offsetX:1,offsetY:2,color:"#00000022",blur:2,fill:!0}},body:{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:I.textDark},small:{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:"#666666"},button:{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#FFFFFF",stroke:"#00000055",strokeThickness:4,shadow:{offsetX:1,offsetY:2,color:"#00000044",blur:2,fill:!0}},buttonSmall:{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#FFFFFF",stroke:"#00000044",strokeThickness:3},score:{fontFamily:"KeiFont, sans-serif",fontSize:"48px",color:"#FFD700",stroke:"#8B4513",strokeThickness:5,shadow:{offsetX:2,offsetY:3,color:"#00000044",blur:4,fill:!0}},special:{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFD700",stroke:"#8B4513",strokeThickness:4,shadow:{offsetX:2,offsetY:2,color:"#FFD70066",blur:8,fill:!0}}},z={1:{name:"æŸ´çŠ¬",color:13789470,accentColor:16767659,earType:"pointed",eyeType:"round",feature:"none"},2:{name:"ãƒ‘ã‚°",color:12887933,accentColor:16770244,earType:"floppy",eyeType:"big",feature:"wrinkle"},3:{name:"ãƒˆã‚¤ãƒ—ãƒ¼ãƒ‰ãƒ«",color:9127187,accentColor:14596231,earType:"curly",eyeType:"round",feature:"fluffy"},4:{name:"ãƒã‚¹ã‚­ãƒ¼",color:7372944,accentColor:16777215,earType:"pointed",eyeType:"almond",feature:"mask"},5:{name:"ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼",color:14329120,accentColor:16775388,earType:"floppy",eyeType:"gentle",feature:"none"},6:{name:"ã‚³ãƒ¼ã‚®ãƒ¼",color:13468991,accentColor:16777215,earType:"big_pointed",eyeType:"round",feature:"short_legs"},7:{name:"ãƒ€ãƒ«ãƒ¡ã‚·ã‚¢ãƒ³",color:16777215,accentColor:3355443,earType:"floppy",eyeType:"round",feature:"spots"},8:{name:"ãƒãƒ¯ãƒ¯",color:3355443,accentColor:16777215,earType:"huge",eyeType:"huge",feature:"tiny"},9:{name:"ã‚·ãƒ¥ãƒŠã‚¦ã‚¶ãƒ¼",color:6908265,accentColor:12632256,earType:"folded",eyeType:"bushy",feature:"beard"},10:{name:"ãƒ‰ãƒ¼ãƒ™ãƒ«ãƒãƒ³",color:1842204,accentColor:13468991,earType:"cropped",eyeType:"sharp",feature:"tan_points"},11:{name:"ã‚»ãƒ³ãƒˆãƒãƒ¼ãƒŠãƒ¼ãƒ‰",color:13468991,accentColor:16777215,earType:"floppy",eyeType:"droopy",feature:"saint_pattern"},12:{name:"ãƒœãƒ«ã‚¾ã‚¤",color:16775920,accentColor:16113331,earType:"elegant",eyeType:"noble",feature:"long_nose"},13:{name:"ãƒãƒ¼ãƒ‹ãƒ¼ã‚º",color:1842204,accentColor:16777215,earType:"floppy",eyeType:"gentle",feature:"bernese_pattern"},14:{name:"ã‚µãƒ¢ã‚¨ãƒ‰",color:16777200,accentColor:16777215,earType:"pointed",eyeType:"round",feature:"fluffy_white"},15:{name:"ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ³",color:13808780,accentColor:1842204,earType:"floppy",eyeType:"gentle",feature:"huge_dog"},16:{name:"ã‚­ãƒ£ãƒãƒªã‚¢",color:13468991,accentColor:16777215,earType:"long_curly",eyeType:"round",feature:"spaniel"},17:{name:"ã‚¸ãƒ£ãƒƒã‚¯ãƒ©ãƒƒã‚»ãƒ«ãƒ†ãƒªã‚¢",color:16777215,accentColor:13468991,earType:"folded",eyeType:"round",feature:"terrier"},18:{name:"ãƒ‘ãƒ”ãƒ¨ãƒ³",color:16777215,accentColor:9127187,earType:"butterfly",eyeType:"round",feature:"butterfly_ears"},19:{name:"ãƒ–ãƒ«ãƒ‰ãƒƒã‚°",color:13808780,accentColor:16777215,earType:"rose",eyeType:"droopy",feature:"underbite"},20:{name:"é»’æŸ´",color:1842204,accentColor:16767659,earType:"pointed",eyeType:"round",feature:"black_shiba",isSecret:!0},21:{name:"ãƒãƒ¯ãƒ—ãƒ¼",color:8421504,accentColor:12632256,earType:"curly",eyeType:"round",feature:"fluffy"},22:{name:"ãƒ€ãƒƒã‚¯ã‚¹ãƒ•ãƒ³ãƒ‰",color:1842204,accentColor:13468991,earType:"long_floppy",eyeType:"round",feature:"long_body"},23:{name:"ãƒ“ã‚·ãƒ§ãƒ³ãƒ•ãƒªãƒ¼ã‚¼",color:16777215,accentColor:16775920,earType:"hidden",eyeType:"round",feature:"cotton_ball"},24:{name:"ãƒãƒ¡ãƒ©ãƒ‹ã‚¢ãƒ³",color:16775920,accentColor:16777215,earType:"pointed",eyeType:"round",feature:"fluffy_white"},25:{name:"ãƒãƒ£ã‚¦ãƒãƒ£ã‚¦",color:13468991,accentColor:14596231,earType:"small_pointed",eyeType:"small",feature:"lion_mane"},26:{name:"ãƒ‹ãƒ¥ãƒ¼ãƒ•ã‚¡ãƒ³ãƒ‰ãƒ©ãƒ³ãƒ‰",color:1842204,accentColor:3355443,earType:"floppy",eyeType:"gentle",feature:"giant_fluffy"},27:{name:"ã‚·ãƒ£ãƒ¼ãƒšã‚¤",color:13808780,accentColor:14596231,earType:"tiny",eyeType:"small",feature:"wrinkle"},28:{name:"ãƒãƒ£ã‚¤ãƒ‹ãƒ¼ã‚ºã‚¯ãƒ¬ã‚¹ãƒ†ãƒƒãƒ‰",color:14596231,accentColor:16777215,earType:"huge",eyeType:"almond",feature:"hairless",isSecret:!0},29:{name:"ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³",color:16766720,accentColor:16775388,earType:"floppy",eyeType:"sparkle",feature:"golden_sparkle",isSecret:!0,isSpecialEncounter:!0,isLegendary:!0},30:{name:"ãƒœãƒ¼ãƒ€ãƒ¼ã‚³ãƒªãƒ¼",color:1842204,accentColor:16777215,earType:"semi_erect",eyeType:"smart",feature:"border_pattern"},31:{name:"ãƒ“ãƒ¼ã‚°ãƒ«",color:13468991,accentColor:16777215,earType:"long_floppy",eyeType:"round",feature:"beagle_pattern"},32:{name:"ãƒãƒ«ãƒãƒ¼ã‚º",color:16777215,accentColor:16775920,earType:"hidden",eyeType:"round",feature:"silky_white",isSecret:!0},33:{name:"ãƒã‚¯ãƒ¯",color:14596231,accentColor:16770244,earType:"erect",eyeType:"round",feature:"chikuwa",isSecret:!0,isLegendary:!0},34:{name:"ãµã‚ã‚‚ã“ã‚­ãƒ³ã‚°",color:16775930,accentColor:16758465,earType:"hidden",eyeType:"sparkle",feature:"fluffy_king",isSecret:!0,isLegendary:!0},35:{name:"ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ‡ãƒ³",color:7372944,accentColor:65535,earType:"erect",eyeType:"cyber",feature:"cyborg",isSecret:!0,isLegendary:!0},36:{name:"ã‚»ãƒ³ãƒˆãƒãƒŠãƒŠãƒ¼ãƒ‰",color:16769333,accentColor:9127187,earType:"floppy",eyeType:"round",feature:"banana",isSecret:!0,isLegendary:!0},37:{name:"æ­¦è€…çŠ¬",color:9109504,accentColor:16766720,earType:"erect",eyeType:"fierce",feature:"samurai",isSecret:!0,isLegendary:!0},38:{name:"ç‚ã®çŠ¬",color:16729344,accentColor:16777215,earType:"hidden",eyeType:"flame",feature:"fire",isSecret:!0,isLegendary:!0},39:{name:"ã‹ã„ã˜ã‚…ã†",color:2263842,accentColor:9498256,earType:"hidden",eyeType:"cute",feature:"kigurumi",isSecret:!0,isLegendary:!0},40:{name:"ã‚´ãƒªãƒ©",color:3100495,accentColor:6908265,earType:"round",eyeType:"powerful",feature:"gorilla",isSecret:!0,isLegendary:!0}},he={29:{id:29,name:"ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³",requiredDogId:5,requiredCostume:null,probability:1/100,encounterMessage:"ã¾ã°ã‚†ã„ã²ã‹ã‚ŠãŒâ€¦ï¼",unlockMessage:`ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},33:{id:33,name:"ãƒã‚¯ãƒ¯",requiredDogId:8,requiredCostume:null,probability:1/100,encounterMessage:"ãƒã‚¯ãƒ¯ã®ã‹ãŠã‚ŠãŒâ€¦ï¼",unlockMessage:`ãƒã‚¯ãƒ¯ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ãƒãƒ¯ãƒ¯ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},34:{id:34,name:"ãµã‚ã‚‚ã“ã‚­ãƒ³ã‚°",requiredDogId:null,requiredCostume:"crown_gold",probability:1/100,encounterMessage:"ãŠã†ã•ã¾ã®ã‚ªãƒ¼ãƒ©ãŒâ€¦ï¼",unlockMessage:`ãµã‚ã‚‚ã“ã‚­ãƒ³ã‚°ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ãŠã†ã‹ã‚“ã‚’è£…ç€ã—ã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},35:{id:35,name:"ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ‡ãƒ³",requiredDogId:15,requiredCostume:null,probability:1/100,encounterMessage:"ãã‚‡ã ã„ãªã‹ã’ãŒâ€¦ï¼",unlockMessage:`ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ‡ãƒ³ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ³ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},36:{id:36,name:"ã‚»ãƒ³ãƒˆãƒãƒŠãƒŠãƒ¼ãƒ‰",requiredDogId:11,requiredCostume:null,probability:1/100,encounterMessage:"ãƒãƒŠãƒŠã®ã«ãŠã„ãŒâ€¦ï¼",unlockMessage:`ã‚»ãƒ³ãƒˆãƒãƒŠãƒŠãƒ¼ãƒ‰ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ã‚»ãƒ³ãƒˆãƒãƒ¼ãƒŠãƒ¼ãƒ‰ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},37:{id:37,name:"æ­¦è€…çŠ¬",requiredDogId:1,requiredCostume:null,probability:1/100,encounterMessage:"ã„ã«ã—ãˆã®ã¤ã‚ã‚‚ã®ãŒâ€¦ï¼",unlockMessage:`æ­¦è€…çŠ¬ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`æŸ´çŠ¬ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},38:{id:38,name:"ç‚ã®çŠ¬",requiredDogId:14,requiredCostume:null,probability:1/100,encounterMessage:"ã»ã®ãŠã®ã„ã¶ããŒâ€¦ï¼",unlockMessage:`ç‚ã®çŠ¬ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ã‚µãƒ¢ã‚¨ãƒ‰ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},39:{id:39,name:"ã‹ã„ã˜ã‚…ã†",requiredDogId:4,requiredCostume:null,probability:1/100,encounterMessage:"ã¨ãŠãã§ã»ãˆã”ãˆãŒâ€¦ï¼",unlockMessage:`ã‹ã„ã˜ã‚…ã†ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ãƒã‚¹ã‚­ãƒ¼ã‚’é€£ã‚Œã¦
ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å‡ºä¼šãˆã‚‹`},40:{id:40,name:"ã‚´ãƒªãƒ©",requiredDogId:null,requiredCostume:null,probability:1/500,encounterMessage:"ã‚¸ãƒ£ãƒ³ã‚°ãƒ«ã®ã‹ãœãŒâ€¦ï¼",unlockMessage:`ã‚´ãƒªãƒ©ãŒ
ãªã‹ã¾ã«ãªã£ãŸï¼`,description:`ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§
ã¾ã‚Œã«å‡ºä¼šãˆã‚‹ï¼ˆ1/500ï¼‰`}},Se={1:{folder:"dog_01_shiba",name:"æŸ´çŠ¬",hasImage:!0},2:{folder:"dog_02_pug",name:"ãƒ‘ã‚°",hasImage:!0},3:{folder:"dog_03_toypoodle",name:"ãƒˆã‚¤ãƒ—ãƒ¼ãƒ‰ãƒ«",hasImage:!0},4:{folder:"dog_04_husky",name:"ãƒã‚¹ã‚­ãƒ¼",hasImage:!0},5:{folder:"dog_05_golden",name:"ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼",hasImage:!0},6:{folder:"dog_06_corgi",name:"ã‚³ãƒ¼ã‚®ãƒ¼",hasImage:!0},7:{folder:"dog_07_dalmatian",name:"ãƒ€ãƒ«ãƒ¡ã‚·ã‚¢ãƒ³",hasImage:!0},8:{folder:"dog_08_chihuahua",name:"ãƒãƒ¯ãƒ¯",hasImage:!0},9:{folder:"dog_09_schnauzer",name:"ã‚·ãƒ¥ãƒŠã‚¦ã‚¶ãƒ¼",hasImage:!0},10:{folder:"dog_10_doberman",name:"ãƒ‰ãƒ¼ãƒ™ãƒ«ãƒãƒ³",hasImage:!0},11:{folder:"dog_11_stbernard",name:"ã‚»ãƒ³ãƒˆãƒãƒ¼ãƒŠãƒ¼ãƒ‰",hasImage:!0},12:{folder:"dog_12_borzoi",name:"ãƒœãƒ«ã‚¾ã‚¤",hasImage:!0},13:{folder:"dog_13_bernese",name:"ãƒãƒ¼ãƒ‹ãƒ¼ã‚º",hasImage:!0},14:{folder:"dog_14_samoyed",name:"ã‚µãƒ¢ã‚¨ãƒ‰",hasImage:!0},15:{folder:"dog_15_greatdane",name:"ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ³",hasImage:!0},16:{folder:"dog_16_cavalier",name:"ã‚­ãƒ£ãƒãƒªã‚¢",hasImage:!0},17:{folder:"dog_17_jackrussell",name:"ã‚¸ãƒ£ãƒƒã‚¯ãƒ©ãƒƒã‚»ãƒ«ãƒ†ãƒªã‚¢",hasImage:!0},18:{folder:"dog_18_papillon",name:"ãƒ‘ãƒ”ãƒ¨ãƒ³",hasImage:!0},19:{folder:"dog_19_bulldog",name:"ãƒ–ãƒ«ãƒ‰ãƒƒã‚°",hasImage:!0},20:{folder:"dog_20_blackshiba",name:"é»’æŸ´",hasImage:!0},21:{folder:"dog_21_chipoo",name:"ãƒãƒ¯ãƒ—ãƒ¼",hasImage:!0},22:{folder:"dog_22_dachshund",name:"ãƒ€ãƒƒã‚¯ã‚¹ãƒ•ãƒ³ãƒ‰",hasImage:!0},23:{folder:"dog_23_bichon",name:"ãƒ“ã‚·ãƒ§ãƒ³ãƒ•ãƒªãƒ¼ã‚¼",hasImage:!0},24:{folder:"dog_24_pomeranian",name:"ãƒãƒ¡ãƒ©ãƒ‹ã‚¢ãƒ³",hasImage:!0},25:{folder:"dog_25_chowchow",name:"ãƒãƒ£ã‚¦ãƒãƒ£ã‚¦",hasImage:!0},26:{folder:"dog_26_newfoundland",name:"ãƒ‹ãƒ¥ãƒ¼ãƒ•ã‚¡ãƒ³ãƒ‰ãƒ©ãƒ³ãƒ‰",hasImage:!0},27:{folder:"dog_27_sharpei",name:"ã‚·ãƒ£ãƒ¼ãƒšã‚¤",hasImage:!0},28:{folder:"dog_28_chinesecrested",name:"ãƒãƒ£ã‚¤ãƒ‹ãƒ¼ã‚ºã‚¯ãƒ¬ã‚¹ãƒ†ãƒƒãƒ‰",hasImage:!0},29:{folder:"dog_29_goldenwanko",name:"ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³",hasImage:!0},30:{folder:"dog_30_bordercollie",name:"ãƒœãƒ¼ãƒ€ãƒ¼ã‚³ãƒªãƒ¼",hasImage:!0},31:{folder:"dog_31_beagle",name:"ãƒ“ãƒ¼ã‚°ãƒ«",hasImage:!0},32:{folder:"dog_32_maltese",name:"ãƒãƒ«ãƒãƒ¼ã‚º",hasImage:!0},33:{folder:"legend_02_chikuwa",name:"ãƒã‚¯ãƒ¯",hasImage:!0},34:{folder:"legend_03_fuwamokoking",name:"ãµã‚ã‚‚ã“ã‚­ãƒ³ã‚°",hasImage:!0},35:{folder:"legend_04_greatdeden",name:"ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ‡ãƒ³",hasImage:!0,expressionMap:{neutral:"happy",happy:"excited"}},36:{folder:"legend_05_sentobanana-do",name:"ã‚»ãƒ³ãƒˆãƒãƒŠãƒŠãƒ¼ãƒ‰",hasImage:!0},37:{folder:"legend_17_mushainu",name:"æ­¦è€…çŠ¬",hasImage:!0},38:{folder:"legend_18_rengoku",name:"ç‚ã®çŠ¬",hasImage:!0},39:{folder:"legend_20_kigurumi",name:"ã‹ã„ã˜ã‚…ã†",hasImage:!0},40:{folder:"legend_21_gorilla",name:"ã‚´ãƒªãƒ©",hasImage:!0}},Ot=["neutral","happy","sad","excited"],ve={golden:{id:"golden",dogId:5,name:"ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼è§£æ”¾",description:"ã‚¹ãƒ†ãƒ¼ã‚¸1ã‚’ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:1}},corgi:{id:"corgi",dogId:6,name:"ã‚³ãƒ¼ã‚®ãƒ¼è§£æ”¾",description:"åˆè¨ˆ10ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:10}},dalmatian:{id:"dalmatian",dogId:7,name:"ãƒ€ãƒ«ãƒ¡ã‚·ã‚¢ãƒ³è§£æ”¾",description:"åˆè¨ˆ15ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:15}},chihuahua:{id:"chihuahua",dogId:8,name:"ãƒãƒ¯ãƒ¯è§£æ”¾",description:"åˆè¨ˆ20ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:20}},schnauzer:{id:"schnauzer",dogId:9,name:"ã‚·ãƒ¥ãƒŠã‚¦ã‚¶ãƒ¼è§£æ”¾",description:"åˆè¨ˆ30ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:30}},doberman:{id:"doberman",dogId:10,name:"ãƒ‰ãƒ¼ãƒ™ãƒ«ãƒãƒ³è§£æ”¾",description:"åˆè¨ˆ40ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:40}},stbernard:{id:"stbernard",dogId:11,name:"ã‚»ãƒ³ãƒˆãƒãƒ¼ãƒŠãƒ¼ãƒ‰è§£æ”¾",description:"åˆè¨ˆ50ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:50}},borzoi:{id:"borzoi",dogId:12,name:"ãƒœãƒ«ã‚¾ã‚¤è§£æ”¾",description:"åˆè¨ˆ60ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:60}},bernese:{id:"bernese",dogId:13,name:"ãƒãƒ¼ãƒ‹ãƒ¼ã‚ºè§£æ”¾",description:"åˆè¨ˆ80ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:80}},samoyed:{id:"samoyed",dogId:14,name:"ã‚µãƒ¢ã‚¨ãƒ‰è§£æ”¾",description:"åˆè¨ˆ100ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢",condition:{type:"total_clears",value:100}},greatdane:{id:"greatdane",dogId:15,name:"ã‚°ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ³è§£æ”¾",description:"ç´¯è¨ˆ100ãƒ”ãƒ¼ã‚¹æ¶ˆã™",condition:{type:"total_pieces",value:100}},cavalier:{id:"cavalier",dogId:16,name:"ã‚­ãƒ£ãƒãƒªã‚¢è§£æ”¾",description:"ç´¯è¨ˆ200ãƒ”ãƒ¼ã‚¹æ¶ˆã™",condition:{type:"total_pieces",value:200}},jackrussell:{id:"jackrussell",dogId:17,name:"ã‚¸ãƒ£ãƒƒã‚¯ãƒ©ãƒƒã‚»ãƒ«ãƒ†ãƒªã‚¢è§£æ”¾",description:"ç´¯è¨ˆ300ãƒ”ãƒ¼ã‚¹æ¶ˆã™",condition:{type:"total_pieces",value:300}},papillon:{id:"papillon",dogId:18,name:"ãƒ‘ãƒ”ãƒ¨ãƒ³è§£æ”¾",description:"ç´¯è¨ˆ400ãƒ”ãƒ¼ã‚¹æ¶ˆã™",condition:{type:"total_pieces",value:400}},bulldog:{id:"bulldog",dogId:19,name:"ãƒ–ãƒ«ãƒ‰ãƒƒã‚°è§£æ”¾",description:"ç´¯è¨ˆ500ãƒ”ãƒ¼ã‚¹æ¶ˆã™",condition:{type:"total_pieces",value:500}},blackshiba:{id:"blackshiba",dogId:20,name:"é»’æŸ´è§£æ”¾",description:"ç´¯è¨ˆ600ãƒ”ãƒ¼ã‚¹æ¶ˆã™",condition:{type:"total_pieces",value:600}},chipoo:{id:"chipoo",dogId:21,name:"ãƒãƒ¯ãƒ—ãƒ¼è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸5é€£å‹",condition:{type:"challenge_streak",value:5}},dachshund:{id:"dachshund",dogId:22,name:"ãƒ€ãƒƒã‚¯ã‚¹ãƒ•ãƒ³ãƒ‰è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸10é€£å‹",condition:{type:"challenge_streak",value:10}},bichon:{id:"bichon",dogId:23,name:"ãƒ“ã‚·ãƒ§ãƒ³ãƒ•ãƒªãƒ¼ã‚¼è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸20é€£å‹",condition:{type:"challenge_streak",value:20}},pomeranian:{id:"pomeranian",dogId:24,name:"ãƒãƒ¡ãƒ©ãƒ‹ã‚¢ãƒ³è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸30é€£å‹",condition:{type:"challenge_streak",value:30}},chowchow:{id:"chowchow",dogId:25,name:"ãƒãƒ£ã‚¦ãƒãƒ£ã‚¦è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸50é€£å‹",condition:{type:"challenge_streak",value:50}},newfoundland:{id:"newfoundland",dogId:26,name:"ãƒ‹ãƒ¥ãƒ¼ãƒ•ã‚¡ãƒ³ãƒ‰ãƒ©ãƒ³ãƒ‰è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸100é€£å‹",condition:{type:"challenge_streak",value:100}},sharpei:{id:"sharpei",dogId:27,name:"ã‚·ãƒ£ãƒ¼ãƒšã‚¤è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸150é€£å‹",condition:{type:"challenge_streak",value:150}},chinesecrested:{id:"chinesecrested",dogId:28,name:"ãƒãƒ£ã‚¤ãƒ‹ãƒ¼ã‚ºã‚¯ãƒ¬ã‚¹ãƒ†ãƒƒãƒ‰è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸200é€£å‹",condition:{type:"challenge_streak",value:200}},bordercollie:{id:"bordercollie",dogId:30,name:"ãƒœãƒ¼ãƒ€ãƒ¼ã‚³ãƒªãƒ¼è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸250é€£å‹",condition:{type:"challenge_streak",value:250}},beagle:{id:"beagle",dogId:31,name:"ãƒ“ãƒ¼ã‚°ãƒ«è§£æ”¾",description:"ãƒãƒ£ãƒ¬ãƒ³ã‚¸300é€£å‹",condition:{type:"challenge_streak",value:300}},maltese:{id:"maltese",dogId:32,name:"ãƒãƒ«ãƒãƒ¼ã‚ºè§£æ”¾",description:"7æ—¥é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³",condition:{type:"consecutive_logins",value:7}}},vt={crown_gold:{id:"costume_crown_gold",costumeId:"crown_gold",name:"ãŠã†ã‹ã‚“è§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},hat_straw:{id:"costume_hat_straw",costumeId:"hat_straw",name:"ã‚€ãã‚ã‚‰ã¼ã†ã—è§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},beret:{id:"costume_beret",costumeId:"beret",name:"ãƒ™ãƒ¬ãƒ¼ã¼ã†è§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},flower_sakura:{id:"costume_flower_sakura",costumeId:"flower_sakura",name:"ã•ãã‚‰è§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},flower_sunflower:{id:"costume_flower_sunflower",costumeId:"flower_sunflower",name:"ã²ã¾ã‚ã‚Šè§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},ribbon_red:{id:"costume_ribbon_red",costumeId:"ribbon_red",name:"ã‚ã‹ãƒªãƒœãƒ³è§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},glasses_star:{id:"costume_glasses_star",costumeId:"glasses_star",name:"ã»ã—ãƒ¡ã‚¬ãƒè§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}},glasses:{id:"costume_glasses",costumeId:"glasses",name:"ã‚µãƒ³ã‚°ãƒ©ã‚¹è§£æ”¾",description:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«15æšãŸã‚ã‚‹",condition:{type:"medals",value:15}}},Fe=[{id:"play_1",name:"ãŠã•ã‚“ã½ã™ã‚‹",target:1,type:"clear",difficulty:"easy"},{id:"challenge_try",name:"ã‚¨ãƒ³ãƒ‰ãƒ¬ã‚¹ã§ã‚ãã¶",target:1,type:"challenge_try",difficulty:"easy"},{id:"play_2",name:"2å›ãŠã•ã‚“ã½ã™ã‚‹",target:2,type:"clear",difficulty:"normal"},{id:"challenge_1",name:"ã‚¨ãƒ³ãƒ‰ãƒ¬ã‚¹ã§1å›ã‚¯ãƒªã‚¢",target:1,type:"challenge",difficulty:"normal"},{id:"perfect_1",name:"ãƒãƒ¼ãƒŸã‚¹ã§ã‚¯ãƒªã‚¢ã™ã‚‹",target:1,type:"perfect",difficulty:"normal"},{id:"play_3",name:"3å›ãŠã•ã‚“ã½ã™ã‚‹",target:3,type:"clear",difficulty:"hard"},{id:"challenge_3",name:"ã‚¨ãƒ³ãƒ‰ãƒ¬ã‚¹ã§3å›ã‚¯ãƒªã‚¢",target:3,type:"challenge",difficulty:"hard"}],ee={brown:{name:"ã“ã’ã¡ã‚ƒ",color:9136404,imageKey:"paw_brown",suffix:"bone"},pink:{name:"ãƒ”ãƒ³ã‚¯",color:16758465,imageKey:"paw_pink",suffix:"heart",unlockCondition:"clear_10_stages"},red:{name:"ã‚ã‹",color:16739179,imageKey:"paw_red",suffix:"heart",unlockCondition:"clear_15_stages"},blue:{name:"ã‚ãŠ",color:7058431,imageKey:"paw_blue",suffix:"heart",unlockCondition:"challenge_3_streak"},cyan:{name:"ã¿ãšã„ã‚",color:52945,imageKey:"paw_cyan",suffix:"bone",unlockCondition:"clear_20_stages"},green:{name:"ã¿ã©ã‚Š",color:8313175,imageKey:"paw_green",suffix:"star",unlockCondition:"clear_25_stages"},purple:{name:"ã‚€ã‚‰ã•ã",color:11640025,imageKey:"paw_purple",suffix:"star",unlockCondition:"challenge_5_streak"},orange:{name:"ã‚ªãƒ¬ãƒ³ã‚¸",color:16752453,imageKey:"paw_orange",suffix:"heart",unlockCondition:"clear_30_stages"},gold:{name:"ãã‚“",color:16766720,imageKey:"paw_gold",suffix:"bone",unlockCondition:"clear_40_stages"},gray:{name:"ã‚°ãƒ¬ãƒ¼",color:8421504,imageKey:"paw_gray",suffix:"bone",unlockCondition:"use_all_4_dogs"},lavender:{name:"ãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼",color:15132410,imageKey:"paw_lavender",suffix:"bone",unlockCondition:"challenge_7_streak"},lime:{name:"ãƒ©ã‚¤ãƒ ",color:3329330,imageKey:"paw_lime",suffix:"bone",unlockCondition:"challenge_12_streak"},teal:{name:"ãƒ†ã‚£ãƒ¼ãƒ«",color:32896,imageKey:"paw_teal",suffix:"bone",unlockCondition:"challenge_15_streak"},magenta:{name:"ãƒã‚¼ãƒ³ã‚¿",color:16711935,imageKey:"paw_magenta",suffix:"sparkle",unlockCondition:"clear_50_stages"},yellow:{name:"ãã„ã‚",color:16766720,imageKey:"paw_yellow",suffix:"star",unlockCondition:"challenge_10_streak"},rainbow:{name:"ã«ã˜ã„ã‚",color:"rainbow",imageKey:"paw_rainbow",suffix:"sparkle",unlockCondition:"all_paws_unlocked"}},ke={default:{name:"ã“ã†ãˆã‚“",sky:8900331,ground:9498256,image:"theme_kouen"},beach:{name:"ã†ã¿",sky:49151,ground:16113331,unlockCondition:"clear_20_stages",image:"theme_umi"},snow:{name:"ã‚†ã",sky:14745599,ground:16777215,unlockCondition:"challenge_5_streak",image:"theme_yuki"},sunset:{name:"ã‚†ã†ã‚„ã‘",sky:16744272,ground:9127187,unlockCondition:"clear_30_stages",image:"theme_yuuyake"},night:{name:"ã‚ˆã‚‹",sky:1644912,ground:3100495,unlockCondition:"challenge_4_streak",image:"theme_yoru"},sakura:{name:"ã•ãã‚‰",sky:16770273,ground:16758465,unlockCondition:"challenge_6_streak",icon:"ğŸŒ¸",image:"theme_sakura"},fireworks:{name:"ã¯ãªã³",sky:858922,ground:1779259,unlockCondition:"challenge_8_streak",icon:"ğŸ†",image:"theme_hanabi"},rainbow:{name:"ã«ã˜",sky:8900331,ground:10025880,unlockCondition:"challenge_14_streak",icon:"ğŸŒˆ",image:"theme_nizi"},starry:{name:"ã»ã—ãã‚‰",sky:723781,ground:1710684,unlockCondition:"challenge_20_streak",icon:"â­",image:"theme_hosizora"}},Ee={crown_gold:{name:"ãŠã†ã‹ã‚“",icon:"ğŸ‘‘",type:"hat",position:"head",imageKey:"costume_crown_gold",unlockCondition:"medals_15",description:"ãã‚‰ãã‚‰ã®ãŠã†ã‹ã‚“"},hat_straw:{name:"ã‚€ãã‚ã‚‰ã¼ã†ã—",icon:"ğŸ‘’",type:"hat",position:"head",imageKey:"costume_hat_straw",unlockCondition:"medals_15",description:"ãªã¤ã®ã²ã–ã—å¯¾ç­–ï¼",offsetY:-18},beret:{name:"ãƒ™ãƒ¬ãƒ¼ã¼ã†",icon:"ğŸ¨",type:"hat",position:"head",imageKey:"costume_beret",unlockCondition:"medals_15",description:"ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆãã©ã‚Š"},flower_sakura:{name:"ã•ãã‚‰",icon:"ğŸŒ¸",type:"flower",position:"ear",imageKey:"costume_flower_sakura",unlockCondition:"medals_15",description:"ã¯ã‚‹ã®ã‹ãŠã‚Š",offsetX:14,offsetY:-20,customScale:.07},flower_sunflower:{name:"ã²ã¾ã‚ã‚Š",icon:"ğŸŒ»",type:"flower",position:"ear",imageKey:"costume_flower_sunflower",unlockCondition:"medals_15",description:"ãªã¤ã®ãŠã²ã•ã¾ï¼",offsetX:14,offsetY:-20,customScale:.07},ribbon_red:{name:"ã‚ã‹ãƒªãƒœãƒ³",icon:"ğŸ€",type:"accessory",position:"neck",imageKey:"costume_ribbon_red",unlockCondition:"medals_15",description:"ã‹ã‚ã„ã„èµ¤ã„ãƒªãƒœãƒ³",offsetY:28},glasses_star:{name:"ã»ã—ãƒ¡ã‚¬ãƒ",icon:"â­",type:"glasses",position:"face",imageKey:"costume_glasses_star",unlockCondition:"medals_15",description:"ã‚­ãƒ©ã‚­ãƒ©ã»ã—ãƒ¡ã‚¬ãƒ",customScale:.14},glasses:{name:"ã‚µãƒ³ã‚°ãƒ©ã‚¹",icon:"ğŸ•¶ï¸",type:"glasses",position:"face",imageKey:"costume_glasses",unlockCondition:"medals_15",description:"ã‚¯ãƒ¼ãƒ«ã«ãã‚ã‚ˆã†",customScale:.14}},Et={deluxe:{id:"deluxe",name:"ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚»ãƒƒãƒˆ",description:"åºƒå‘Šã‘ã—ï¼‹ã„ã‚ã©ã‚Šãƒ‘ãƒƒã‚¯ ã¾ã¨ã‚ã¦ãŠã¨ãï¼",price:1160,originalPrice:1460,icon:"ğŸ‘‘",iconKey:"pack_premium",color:16766720,badge:"ğŸ”¥ ä¸€ç•ªäººæ°—ï¼",discountBadge:"20%OFF",isHero:!0},allCustomize:{id:"allCustomize",name:"ã„ã‚ã©ã‚Šãƒ‘ãƒƒã‚¯",description:`è‚‰çƒã‚«ãƒ©ãƒ¼ã‚„ãã›ã‹ãˆã€
ãƒ†ãƒ¼ãƒã‚’ãœã‚“ã¶è§£æ”¾ï¼`,price:980,icon:"ğŸ¨",iconKey:"pack_customize",color:15277667},adFree:{id:"adFree",name:"ã“ã†ã“ãã‘ã—",description:"ã™ã¹ã¦ã®åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã™",price:480,icon:"ğŸ”‡",iconKey:"pack_noads",color:5025616},singleDog:{id:"singleDog",name:"ãƒ¯ãƒ³ã‚³ã‚’è¿ãˆã‚‹",description:"ã™ããªãƒ¯ãƒ³ã‚³ã‚’ï¼‘åŒ¹ãˆã‚‰ã¹ã‚‹ï¼",price:300,icon:"ğŸ•",iconKey:"pack_dog",color:16750592,isSingleDog:!0}};class v{static getDefaultData(){const e=new Date().toISOString().split("T")[0];return{unlockedDogs:[1,2,3,4],dogUnlockDates:{1:e,2:e,3:e,4:e},selectedDogs:[1,2,3,4],achievements:{},stats:{totalClears:0,challengeHighScore:0,challengeCurrentStreak:0,maxComboCount:0,goldenClears:0,dogUsage:{},totalPieces:0,consecutiveClears:0,maxConsecutiveClears:0,consecutiveLogins:0,lastLoginDate:null,noMissClears:0,currentNoMissStreak:0,themeClears:{},dayOfWeekClears:{},dogSpecificClears:{}},dogLevels:{},daily:{lastLogin:null,missions:[],progress:{}},customize:{pawColor:null,theme:"default",equippedCostumes:[]},rewards:{medals:0,stamps:[],stampWeekStart:null,weeklyBonusClaimed:!1,totalWeeklyComplete:0,unlockedCostumes:[]},costumeAchievements:{},settings:{bgmEnabled:!0,seEnabled:!0,bgmVolume:1,seVolume:1},purchases:{adFree:!1,allDogs:!1,allCustomize:!1,deluxe:!1,limitedDogs:[]},tutorial:{completed:!1,step:0,inProgress:!1}}}static load(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(e){const s=JSON.parse(e);return s.settings&&(typeof s.settings.bgmEnabled>"u"&&typeof s.settings.bgm<"u"&&(s.settings.bgmEnabled=s.settings.bgm!==!1),typeof s.settings.seEnabled>"u"&&typeof s.settings.se<"u"&&(s.settings.seEnabled=s.settings.se!==!1),typeof s.settings.bgmVolume!="number"&&(s.settings.bgmVolume=1),typeof s.settings.seVolume!="number"&&(s.settings.seVolume=1)),s.tutorial||(s.tutorial={completed:!0,step:0,inProgress:!1}),{...this.getDefaultData(),...s}}}catch(e){console.error("ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",e)}return this.getDefaultData()}static save(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(s){console.error("ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ©ãƒ¼:",s)}}static isDogUnlocked(e,s){var t,i;return(t=e.purchases)!=null&&t.deluxe||(i=e.purchases)!=null&&i.allDogs?!0:e.unlockedDogs.includes(s)}static isAdFree(e){var s,t;return((s=e.purchases)==null?void 0:s.adFree)||((t=e.purchases)==null?void 0:t.deluxe)}static updateStats(e,s,t=1,i=null){switch(e.stats.totalPieces||(e.stats.totalPieces=0),e.stats.consecutiveClears||(e.stats.consecutiveClears=0),e.stats.maxConsecutiveClears||(e.stats.maxConsecutiveClears=0),e.stats.noMissClears||(e.stats.noMissClears=0),e.stats.currentNoMissStreak||(e.stats.currentNoMissStreak=0),e.stats.themeClears||(e.stats.themeClears={}),e.stats.dayOfWeekClears||(e.stats.dayOfWeekClears={}),e.stats.dogSpecificClears||(e.stats.dogSpecificClears={}),e.stats.consecutiveLogins||(e.stats.consecutiveLogins=0),s){case"clear":e.stats.totalClears+=t,e.stats.consecutiveClears+=t,e.stats.consecutiveClears>e.stats.maxConsecutiveClears&&(e.stats.maxConsecutiveClears=e.stats.consecutiveClears);break;case"clear_reset":e.stats.consecutiveClears=0,e.stats.currentNoMissStreak=0;break;case"challenge_clear":e.stats.challengeCurrentStreak+=t,e.stats.challengeCurrentStreak>e.stats.challengeHighScore&&(e.stats.challengeHighScore=e.stats.challengeCurrentStreak);break;case"challenge_reset":e.stats.challengeCurrentStreak=0;break;case"golden":e.stats.goldenClears+=t;break;case"dog_usage":e.stats.dogUsage[t]||(e.stats.dogUsage[t]=0),e.stats.dogUsage[t]++;break;case"pieces":e.stats.totalPieces+=t;break;case"no_miss_clear":e.stats.currentNoMissStreak+=t,e.stats.noMissClears+=t;break;case"miss":e.stats.currentNoMissStreak=0;break;case"theme_clear":i&&(e.stats.themeClears[i]||(e.stats.themeClears[i]=0),e.stats.themeClears[i]+=t);break;case"day_clear":const o=new Date().getDay();e.stats.dayOfWeekClears[o]||(e.stats.dayOfWeekClears[o]=0),e.stats.dayOfWeekClears[o]+=t;break;case"dog_clear":i&&(e.stats.dogSpecificClears[i]||(e.stats.dogSpecificClears[i]=0),e.stats.dogSpecificClears[i]+=t);break;case"login":const n=new Date().toDateString(),r=e.stats.lastLoginDate;if(r){const a=new Date(r),l=new Date(n),c=Math.floor((l-a)/(1e3*60*60*24));c===1?e.stats.consecutiveLogins+=1:c>1&&(e.stats.consecutiveLogins=1)}else e.stats.consecutiveLogins=1;e.stats.lastLoginDate=n;break}this.save(e)}static checkAchievements(e){const s=[];return e.stats.totalPieces||(e.stats.totalPieces=0),e.stats.maxConsecutiveClears||(e.stats.maxConsecutiveClears=0),e.stats.consecutiveLogins||(e.stats.consecutiveLogins=0),e.stats.noMissClears||(e.stats.noMissClears=0),e.stats.themeClears||(e.stats.themeClears={}),e.stats.dayOfWeekClears||(e.stats.dayOfWeekClears={}),e.stats.dogSpecificClears||(e.stats.dogSpecificClears={}),Object.values(ve).forEach(t=>{var n;if(e.achievements[t.id])return;let i=!1;const o=t.condition;switch(o.type){case"challenge_streak":i=e.stats.challengeHighScore>=o.value;break;case"total_clears":i=e.stats.totalClears>=o.value;break;case"golden_clears":i=e.stats.goldenClears>=o.value;break;case"use_all_dogs":const r=e.stats.dogUsage;i=[1,2,3,4].every(u=>r[u]>=1);break;case"total_pieces":i=e.stats.totalPieces>=o.value;break;case"max_combo":i=e.stats.maxComboCount>=o.value;break;case"consecutive_clears":i=e.stats.maxConsecutiveClears>=o.value;break;case"consecutive_logins":i=e.stats.consecutiveLogins>=o.value;break;case"theme_clears":i=(e.stats.themeClears[o.theme]||0)>=o.value;break;case"no_miss_clears":i=e.stats.noMissClears>=o.value;break;case"day_of_week_clears":i=(e.stats.dayOfWeekClears[o.day]||0)>=o.value;break;case"weekly_complete":i=(((n=e.rewards)==null?void 0:n.totalWeeklyComplete)||0)>=o.value;break;case"dog_specific_clears":i=(e.stats.dogSpecificClears[o.dogId]||0)>=o.value;break}i&&(e.achievements[t.id]=!0,t.dogId&&!e.unlockedDogs.includes(t.dogId)&&(e.unlockedDogs.push(t.dogId),e.dogUnlockDates||(e.dogUnlockDates={}),e.dogUnlockDates[t.dogId]=new Date().toISOString().split("T")[0]),s.push(t))}),s}static checkNikukyuUnlocks(e){var o;e.unlockedNikukyuColors||(e.unlockedNikukyuColors=["brown"]),e.unlockedNikukyuColors.includes("default")&&!e.unlockedNikukyuColors.includes("brown")&&e.unlockedNikukyuColors.push("brown");const s=[],t=e.stats,i=((o=e.rewards)==null?void 0:o.medals)||0;return Object.entries(ee).forEach(([n,r])=>{if(n==="rainbow"||e.unlockedNikukyuColors.includes(n)||!r.unlockCondition)return;let a=!1;const l=r.unlockCondition;if(l.startsWith("medals_")){const c=parseInt(l.split("_")[1]);a=i>=c}else if(l==="use_all_4_dogs"){const c=t.dogUsage||{};a=[1,2,3,4].every(d=>(c[d]||0)>=1)}else switch(l){case"clear_10_stages":a=t.totalClears>=10;break;case"clear_15_stages":a=t.totalClears>=15;break;case"clear_20_stages":a=t.totalClears>=20;break;case"clear_25_stages":a=t.totalClears>=25;break;case"clear_30_stages":a=t.totalClears>=30;break;case"clear_40_stages":a=t.totalClears>=40;break;case"clear_50_stages":a=t.totalClears>=50;break;case"challenge_3_streak":a=t.challengeHighScore>=3;break;case"challenge_5_streak":a=t.challengeHighScore>=5;break;case"challenge_7_streak":a=t.challengeHighScore>=7;break;case"challenge_10_streak":a=t.challengeHighScore>=10;break;case"challenge_12_streak":a=t.challengeHighScore>=12;break;case"challenge_15_streak":a=t.challengeHighScore>=15;break}a&&(e.unlockedNikukyuColors.push(n),s.push({type:"nikukyu",key:n,...r}))}),e.unlockedNikukyuColors.includes("rainbow")||Object.keys(ee).filter(a=>a!=="rainbow").every(a=>e.unlockedNikukyuColors.includes(a))&&(e.unlockedNikukyuColors.push("rainbow"),s.push({type:"nikukyu",key:"rainbow",...ee.rainbow})),s}static checkThemeUnlocks(e){var n,r;e.unlockedThemes||(e.unlockedThemes=["default"]);const s=[],t=e.stats,i=((n=e.rewards)==null?void 0:n.medals)||0,o=((r=e.rewards)==null?void 0:r.totalWeeklyComplete)||0;return Object.entries(ke).forEach(([a,l])=>{if(e.unlockedThemes.includes(a)||!l.unlockCondition)return;let c=!1;const d=l.unlockCondition;if(d.startsWith("medals_")){const u=parseInt(d.split("_")[1]);c=i>=u}else if(d.startsWith("stamp_complete_")){const u=parseInt(d.split("_")[2]);c=o>=u}else switch(d){case"clear_20_stages":c=t.totalClears>=20;break;case"clear_30_stages":c=t.totalClears>=30;break;case"challenge_4_streak":c=t.challengeHighScore>=4;break;case"challenge_5_streak":c=t.challengeHighScore>=5;break;case"challenge_6_streak":c=t.challengeHighScore>=6;break;case"challenge_8_streak":c=t.challengeHighScore>=8;break;case"challenge_14_streak":c=t.challengeHighScore>=14;break;case"challenge_20_streak":c=t.challengeHighScore>=20;break;case"golden_3_times":c=t.goldenClears>=3;break;case"use_all_4_dogs":const u=t.dogUsage;c=[1,2,3,4].every(f=>u[f]>=1);break}c&&(e.unlockedThemes.push(a),s.push({type:"theme",key:a,...l}))}),s}static checkAllUnlocks(e){const s=[];this.checkAchievements(e).forEach(n=>{n.dogId&&s.push({type:"dog",dogId:n.dogId,...n})});const i=this.checkNikukyuUnlocks(e);s.push(...i);const o=this.checkThemeUnlocks(e);return s.push(...o),s}}W(v,"STORAGE_KEY","wantsunagi_data");class X{static checkAndResetDaily(e){const s=new Date().toDateString();if(e.daily.lastLogin!==s){e.daily.lastLogin=s,e.daily.progress={},e.daily.medalsClaimedToday=[];const t=Fe.filter(g=>g.difficulty==="easy"),i=Fe.filter(g=>g.difficulty==="normal"),o=[...Fe],n=g=>[...g].sort(()=>Math.random()-.5),r=[],a=[],c=n(t).find(g=>!a.includes(g.type));c&&(r.push(c.id),a.push(c.type));const u=n(i).find(g=>!a.includes(g.type));u&&(r.push(u.id),a.push(u.type));const f=n(o).filter(g=>!r.includes(g.id)&&!a.includes(g.type));f.length>0&&(r.push(f[0].id),a.push(f[0].type)),e.daily.missions=r,e.daily.todaysDog=e.selectedDogs[Math.floor(Math.random()*e.selectedDogs.length)],v.save(e)}return e}static getTodaysMissions(e){const s=[];return(e.daily.missions||[]).forEach(i=>{const o=Fe.find(n=>n.id===i);o&&s.push({...o,progress:e.daily.progress[i]||0,completed:(e.daily.progress[i]||0)>=o.target})}),s}static updateProgress(e,s,t=1){(e.daily.missions||[]).forEach(o=>{const n=Fe.find(r=>r.id===o);n&&n.type===s&&(e.daily.progress[o]||(e.daily.progress[o]=0),e.daily.progress[o]+=t)}),v.save(e)}static areAllMissionsComplete(e){const s=this.getTodaysMissions(e);return s.length===0?!1:s.every(t=>t.completed)}static isMissionComplete(e,s){const i=this.getTodaysMissions(e).find(o=>o.id===s);return i?i.completed:!1}static isMedalClaimed(e,s){return e.daily.medalsClaimedToday||(e.daily.medalsClaimedToday=[]),e.daily.medalsClaimedToday.includes(s)}static getClaimableMedalCount(e){const s=this.getTodaysMissions(e);return e.daily.medalsClaimedToday||(e.daily.medalsClaimedToday=[]),s.filter(t=>t.completed&&!e.daily.medalsClaimedToday.includes(t.id)).length}static awardMedalForMission(e,s){var i;if(!this.isMissionComplete(e,s))return{awarded:!1};if(this.isMedalClaimed(e,s))return{awarded:!1};e.rewards||(e.rewards={medals:0,stamps:[],stampWeekStart:null,weeklyBonusClaimed:!1,totalWeeklyComplete:0,unlockedCostumes:[]}),e.daily.medalsClaimedToday||(e.daily.medalsClaimedToday=[]),e.rewards.medals=(e.rewards.medals||0)+1,e.daily.medalsClaimedToday.push(s),this.areAllMissionsComplete(e)&&e.daily.medalsClaimedToday.length>=3&&this.addTodayStamp(e);const t=this.checkCostumeUnlocks(e);return v.save(e),{awarded:!0,totalMedals:e.rewards.medals,newCostumes:t,stampCount:((i=e.rewards.stamps)==null?void 0:i.length)||0}}static awardMedalIfComplete(e){var n;if(this.getClaimableMedalCount(e)===0)return{awarded:!1};const t=this.getTodaysMissions(e);e.daily.medalsClaimedToday||(e.daily.medalsClaimedToday=[]);let i=0;if(t.forEach(r=>{r.completed&&!e.daily.medalsClaimedToday.includes(r.id)&&(e.rewards||(e.rewards={medals:0,stamps:[],stampWeekStart:null,weeklyBonusClaimed:!1,totalWeeklyComplete:0,unlockedCostumes:[]}),e.rewards.medals=(e.rewards.medals||0)+1,e.daily.medalsClaimedToday.push(r.id),i++)}),i===0)return{awarded:!1};this.areAllMissionsComplete(e)&&e.daily.medalsClaimedToday.length>=3&&this.addTodayStamp(e);const o=this.checkCostumeUnlocks(e);return v.save(e),{awarded:!0,awardedCount:i,totalMedals:e.rewards.medals,newCostumes:o,stampCount:((n=e.rewards.stamps)==null?void 0:n.length)||0}}static addTodayStamp(e){e.rewards||(e.rewards={medals:0,stamps:[],stampWeekStart:null,weeklyBonusClaimed:!1,totalWeeklyComplete:0,unlockedCostumes:[]});const s=new Date,t=s.getDay(),o=this.getMondayOfWeek(s).toDateString();e.rewards.stampWeekStart!==o&&(e.rewards.stamps=[],e.rewards.stampWeekStart=o,e.rewards.weeklyBonusClaimed=!1);const n=t===0?6:t-1;e.rewards.stamps.includes(n)||e.rewards.stamps.push(n)}static getMondayOfWeek(e){const s=new Date(e),t=s.getDay(),i=s.getDate()-t+(t===0?-6:1);return new Date(s.setDate(i))}static checkWeeklyBonus(e){return e.rewards?e.rewards.weeklyBonusClaimed?{canClaim:!1,alreadyClaimed:!0}:e.rewards.stamps.length<7?{canClaim:!1,current:e.rewards.stamps.length}:{canClaim:!0,current:7}:{canClaim:!1}}static claimWeeklyBonus(e){if(!this.checkWeeklyBonus(e).canClaim)return{success:!1};e.rewards.weeklyBonusClaimed=!0,e.rewards.totalWeeklyComplete=(e.rewards.totalWeeklyComplete||0)+1,e.rewards.medals=(e.rewards.medals||0)+3;const t=this.checkCostumeUnlocks(e);return v.save(e),{success:!0,bonusMedals:3,totalMedals:e.rewards.medals,totalWeeklyComplete:e.rewards.totalWeeklyComplete,newCostumes:t}}static checkCostumeUnlocks(e){if(!e.rewards)return[];e.rewards.unlockedCostumes||(e.rewards.unlockedCostumes=[]),e.costumeAchievements||(e.costumeAchievements={});const s=[],t=e.rewards.medals||0,i=e.rewards.totalWeeklyComplete||0;return Object.entries(Ee).forEach(([o,n])=>{if(e.rewards.unlockedCostumes.includes(o))return;let r=!1;const a=n.unlockCondition;if(a.startsWith("medals_")){const l=parseInt(a.split("_")[1]);r=t>=l}else if(a.startsWith("stamp_complete_")){const l=parseInt(a.split("_")[2]);r=i>=l}if(r){e.rewards.unlockedCostumes.push(o);const l=`costume_${o}`;vt[o]&&(e.costumeAchievements[l]={unlockedAt:new Date().toISOString(),costumeId:o}),s.push({id:o,...n})}}),s}static isCostumeUnlocked(e,s){var t;return(t=e.rewards)!=null&&t.unlockedCostumes?e.rewards.unlockedCostumes.includes(s):!1}static getStampRallyInfo(e){if(!e.rewards)return{stamps:[],weekStart:null,daysRemaining:7,canClaimBonus:!1};const s=new Date,t=this.getMondayOfWeek(s),i=t.toDateString();if(e.rewards.stampWeekStart!==i)return{stamps:[],weekStart:i,daysRemaining:7,canClaimBonus:!1};const o=e.rewards.stamps||[],n=new Date(t);n.setDate(n.getDate()+6);const r=Math.max(0,7-o.length),a=o.length>=7&&!e.rewards.weeklyBonusClaimed;return{stamps:o,weekStart:i,daysRemaining:r,canClaimBonus:a,totalWeeklyComplete:e.rewards.totalWeeklyComplete||0}}}let p=v.load();_.applySettings(p.settings);let G=[];class Ce{static buildShareText(e,s,t=!1){const i="ğŸ•";let o=`${i} ã„ã¬ã•ã‚“ã½ ${i}
`;switch(e){case"normal":o+=`ã‚¹ãƒ†ãƒ¼ã‚¸ ${s+1} ã‚’ã‚¯ãƒªã‚¢ã—ãŸã‚ˆï¼
`;break;case"challenge":o+=`ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§ ${s} ã‚¹ãƒ†ãƒ¼ã‚¸çªç ´ï¼
`,t&&(o+=`ğŸ‰ NEW RECORD! ğŸ‰
`);break;case"gameover":o+=`ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§ ${s} ã‚¹ãƒ†ãƒ¼ã‚¸ ã‚¯ãƒªã‚¢ï¼
`,t&&(o+=`ğŸ‰ NEW RECORD! ğŸ‰
`);break}return o+=`
â–¼ ã‚ãã‚“ã§ã¿ã¦ã­ï¼
${this.GAME_URL}`,o}static async share(e,s,t=!1){const i=this.buildShareText(e,s,t),o={title:"ã„ã¬ã•ã‚“ã½",text:i,url:this.GAME_URL};if(navigator.share)try{return await navigator.share(o),{success:!0,method:"share"}}catch(n){if(n.name==="AbortError")return{success:!1,method:"cancelled"};console.error("ã‚·ã‚§ã‚¢ã‚¨ãƒ©ãƒ¼:",n)}try{return await navigator.clipboard.writeText(i),{success:!0,method:"clipboard"}}catch(n){return console.error("ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:",n),{success:!1,method:"error"}}}static createShareButton(e,s,t,i,o,n=!1){const r=e.add.container(s,t),a=e.add.graphics();a.fillStyle(1942002,1),a.fillRoundedRect(-50,-18,100,36,8),a.lineStyle(2,I.cellOutline,1),a.strokeRoundedRect(-50,-18,100,36,8);const l=e.add.image(-28,0,"icon_share"),c=22/Math.max(l.width,l.height);l.setScale(c);const d=e.add.text(8,0,"ã‚·ã‚§ã‚¢",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#FFFFFF"}).setOrigin(.5);return r.add([a,l,d]),r.setSize(100,36),r.setInteractive({useHandCursor:!0}),r.on("pointerup",async()=>{_.playSfx(e,"sfx_ui_tap");const u=await this.share(i,o,n);if(u.success&&u.method==="clipboard"){const f=e.add.text(s,t-50,"ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#FFFFFF",backgroundColor:"#333333",padding:{x:10,y:5}}).setOrigin(.5);e.tweens.add({targets:f,alpha:0,y:t-70,duration:1500,onComplete:()=>f.destroy()})}}),r.on("pointerover",()=>{e.tweens.add({targets:r,scale:1.05,duration:100})}),r.on("pointerout",()=>{e.tweens.add({targets:r,scale:1,duration:100})}),r}}W(Ce,"GAME_URL","https://kerofen.github.io/inusanpo/");class L{static draw(e,s,t,i,o=25,n="neutral",r=1){if(!z[i])return e.add.container(s,t);const l=e.add.container(s,t),c=Se[i],d=`dog_${i}_${n}`;if(c!=null&&c.hasImage&&e.textures.exists(d)){const u=o*2.2,f=e.add.image(0,0,d);f.setDisplaySize(u,u),l.add(f);const g=o/25;return this.drawCostumes(e,l,g),l}return this.drawWithGraphics(e,s,t,i,o,n,r)}static drawWithGraphics(e,s,t,i,o=25,n="neutral",r=1){const a=z[i];if(!a)return e.add.container(s,t);const l=e.add.container(s,t),c=e.add.graphics(),d=o/25;return this.drawEars(c,a,d),c.fillStyle(a.color,1),c.fillCircle(0,0,22*d),c.lineStyle(2*d,0,.3),c.strokeCircle(0,0,22*d),this.drawFeature(c,a,d),c.fillStyle(a.accentColor,1),c.fillEllipse(0,8*d,14*d,10*d),this.drawEyes(c,a,d,n,r),c.fillStyle(3355443,1),c.fillCircle(0,6*d,4*d),this.drawMouth(c,d,n),l.add(c),this.drawCostumes(e,l,d),l}static drawCostumes(e,s,t){var o;const i=((o=p.customize)==null?void 0:o.equippedCostumes)||[];i.length!==0&&i.forEach(n=>{const r=Ee[n];if(r&&r.imageKey&&e.textures.exists(r.imageKey)){const a=e.add.image(0,0,r.imageKey);let l=0,c=0,d=.1;switch(r.position){case"head":c=-28,d=.12;break;case"ear":l=14,c=-20,d=.07;break;case"neck":c=16,d=.1;break;case"face":c=-4,d=.08;break;case"body":c=8,l=12,d=.08;break}const u=(r.offsetX!==void 0?r.offsetX:l)*t,f=(r.offsetY!==void 0?r.offsetY:c)*t,g=r.customScale!==void 0?r.customScale:d;a.setX(u),a.setY(f),a.setScale(t*g),s.add(a)}})}static drawEars(e,s,t){const i=s.earType||"pointed";switch(e.fillStyle(s.color,1),i){case"pointed":e.beginPath(),e.moveTo(-18*t,-8*t),e.lineTo(-12*t,-28*t),e.lineTo(-6*t,-10*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(18*t,-8*t),e.lineTo(12*t,-28*t),e.lineTo(6*t,-10*t),e.closePath(),e.fillPath();break;case"floppy":e.fillEllipse(-18*t,0,10*t,16*t),e.fillEllipse(18*t,0,10*t,16*t);break;case"curly":e.fillCircle(-16*t,-8*t,10*t),e.fillCircle(16*t,-8*t,10*t),e.fillCircle(-20*t,-4*t,6*t),e.fillCircle(20*t,-4*t,6*t);break;case"huge":e.beginPath(),e.moveTo(-16*t,-5*t),e.lineTo(-26*t,-30*t),e.lineTo(-6*t,-12*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(16*t,-5*t),e.lineTo(26*t,-30*t),e.lineTo(6*t,-12*t),e.closePath(),e.fillPath();break;case"big_pointed":e.beginPath(),e.moveTo(-16*t,-6*t),e.lineTo(-18*t,-32*t),e.lineTo(-4*t,-10*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(16*t,-6*t),e.lineTo(18*t,-32*t),e.lineTo(4*t,-10*t),e.closePath(),e.fillPath();break;case"rose":e.fillEllipse(-18*t,-10*t,8*t,10*t),e.fillEllipse(18*t,-10*t,8*t,10*t);break;case"small_pointed":e.beginPath(),e.moveTo(-14*t,-10*t),e.lineTo(-10*t,-22*t),e.lineTo(-6*t,-12*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(14*t,-10*t),e.lineTo(10*t,-22*t),e.lineTo(6*t,-12*t),e.closePath(),e.fillPath();break;case"long_floppy":e.fillEllipse(-20*t,5*t,10*t,20*t),e.fillEllipse(20*t,5*t,10*t,20*t);break;case"semi_floppy":e.beginPath(),e.moveTo(-18*t,-8*t),e.lineTo(-14*t,-22*t),e.lineTo(-8*t,-10*t),e.closePath(),e.fillPath(),e.fillEllipse(-16*t,-18*t,6*t,8*t),e.beginPath(),e.moveTo(18*t,-8*t),e.lineTo(14*t,-22*t),e.lineTo(8*t,-10*t),e.closePath(),e.fillPath(),e.fillEllipse(16*t,-18*t,6*t,8*t);break;case"bat":e.beginPath(),e.moveTo(-14*t,-5*t),e.lineTo(-20*t,-28*t),e.lineTo(-6*t,-8*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(14*t,-5*t),e.lineTo(20*t,-28*t),e.lineTo(6*t,-8*t),e.closePath(),e.fillPath(),e.fillStyle(16758465,.5),e.beginPath(),e.moveTo(-13*t,-8*t),e.lineTo(-17*t,-22*t),e.lineTo(-9*t,-10*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(13*t,-8*t),e.lineTo(17*t,-22*t),e.lineTo(9*t,-10*t),e.closePath(),e.fillPath(),e.fillStyle(s.color,1);break;case"folded":e.beginPath(),e.moveTo(-16*t,-8*t),e.lineTo(-12*t,-20*t),e.lineTo(-6*t,-10*t),e.closePath(),e.fillPath(),e.fillEllipse(-12*t,-16*t,8*t,6*t),e.beginPath(),e.moveTo(16*t,-8*t),e.lineTo(12*t,-20*t),e.lineTo(6*t,-10*t),e.closePath(),e.fillPath(),e.fillEllipse(12*t,-16*t,8*t,6*t);break;case"cropped":e.beginPath(),e.moveTo(-14*t,-6*t),e.lineTo(-10*t,-32*t),e.lineTo(-6*t,-8*t),e.closePath(),e.fillPath(),e.beginPath(),e.moveTo(14*t,-6*t),e.lineTo(10*t,-32*t),e.lineTo(6*t,-8*t),e.closePath(),e.fillPath();break;case"elegant":e.fillEllipse(-22*t,0,8*t,22*t),e.fillEllipse(22*t,0,8*t,22*t),e.fillStyle(s.accentColor,.6),e.fillEllipse(-24*t,8*t,6*t,14*t),e.fillEllipse(24*t,8*t,6*t,14*t),e.fillStyle(s.color,1);break}}static drawFeature(e,s,t){switch(s.feature){case"mask":e.fillStyle(s.accentColor,1),e.fillEllipse(0,2*t,16*t,18*t);break;case"wrinkle":e.lineStyle(1.5*t,0,.2),e.beginPath(),e.moveTo(-8*t,-8*t),e.lineTo(-4*t,-6*t),e.strokePath(),e.beginPath(),e.moveTo(8*t,-8*t),e.lineTo(4*t,-6*t),e.strokePath();break;case"fluffy":e.fillStyle(s.color,1);for(let i=0;i<8;i++){const o=i/8*Math.PI*2,n=Math.cos(o)*18*t,r=Math.sin(o)*18*t;e.fillCircle(n,r,6*t)}break;case"golden":e.fillStyle(16766720,.3),e.fillCircle(0,0,26*t);break;case"spots":e.fillStyle(s.accentColor,1),e.fillCircle(-10*t,-8*t,4*t),e.fillCircle(8*t,-12*t,3*t),e.fillCircle(12*t,4*t,3*t),e.fillCircle(-14*t,6*t,2*t);break;case"fluffy_face":e.fillStyle(s.accentColor,1);for(let i=0;i<12;i++){const o=i/12*Math.PI*2,n=Math.cos(o)*20*t,r=Math.sin(o)*20*t;e.fillCircle(n,r,5*t)}break;case"tricolor":e.fillStyle(s.accentColor,1),e.fillEllipse(0,5*t,14*t,12*t),e.fillStyle(1842204,1),e.fillEllipse(0,-14*t,12*t,8*t);break;case"border_pattern":e.fillStyle(s.accentColor,1),e.fillEllipse(0,6*t,16*t,14*t),e.fillStyle(s.color,1),e.fillEllipse(0,-12*t,10*t,8*t);break;case"friendly":e.fillStyle(16775885,.2),e.fillCircle(0,0,24*t);break;case"long_body":e.fillStyle(s.accentColor,1),e.fillEllipse(0,8*t,16*t,10*t);break;case"bat_face":e.fillStyle(s.accentColor,1),e.fillEllipse(0,4*t,18*t,12*t),e.lineStyle(1*t,0,.15),e.beginPath(),e.arc(0,-4*t,8*t,.5,Math.PI-.5,!1),e.strokePath();break;case"beard":e.fillStyle(s.accentColor,1),e.fillEllipse(-10*t,-10*t,8*t,4*t),e.fillEllipse(10*t,-10*t,8*t,4*t),e.fillEllipse(0,10*t,14*t,10*t);break;case"tan_points":e.fillStyle(s.accentColor,1),e.fillEllipse(0,6*t,14*t,10*t),e.fillCircle(-8*t,-10*t,4*t),e.fillCircle(8*t,-10*t,4*t);break;case"akita_mask":e.fillStyle(s.accentColor,1),e.fillEllipse(0,4*t,18*t,16*t);break;case"brindle":e.lineStyle(2*t,s.accentColor,.5);for(let i=-2;i<=2;i++)e.beginPath(),e.moveTo((i*6-3)*t,-16*t),e.lineTo((i*6+3)*t,16*t),e.strokePath();break;case"thick_fur":e.fillStyle(s.accentColor,.4);for(let i=0;i<10;i++){const o=i/10*Math.PI*2,n=Math.cos(o)*22*t,r=Math.sin(o)*22*t;e.fillCircle(n,r,4*t)}break;case"saint_pattern":e.fillStyle(s.accentColor,1),e.fillEllipse(0,5*t,16*t,14*t),e.fillStyle(s.color,.8),e.fillRoundedRect(-3*t,-18*t,6*t,20*t,2*t);break;case"long_nose":e.fillStyle(s.accentColor,1),e.fillEllipse(0,10*t,12*t,14*t);break;case"bernese_pattern":e.fillStyle(s.accentColor,1),e.fillEllipse(0,6*t,16*t,12*t),e.fillStyle(13468991,1),e.fillCircle(-10*t,-8*t,4*t),e.fillCircle(10*t,-8*t,4*t);break;case"pure_white":e.fillStyle(16777215,.4),e.fillCircle(0,0,26*t),e.fillStyle(16766720,.3),e.fillCircle(-12*t,-12*t,3*t),e.fillCircle(14*t,-8*t,2*t),e.fillCircle(8*t,14*t,2*t);break}}static drawEyes(e,s,t,i,o){const n=s.eyeType||"round";switch(e.fillStyle(0,1),o>=10&&i==="happy"?i="sparkle":o>=5&&i==="happy"&&Math.random()>.5&&(i="wink"),i){case"happy":e.lineStyle(3*t,0,1),e.beginPath(),e.arc(-8*t,-4*t,5*t,Math.PI,0,!1),e.strokePath(),e.beginPath(),e.arc(8*t,-4*t,5*t,Math.PI,0,!1),e.strokePath();break;case"wink":e.lineStyle(3*t,0,1),e.beginPath(),e.arc(-8*t,-4*t,5*t,Math.PI,0,!1),e.strokePath(),e.fillStyle(0,1),e.fillCircle(8*t,-4*t,4*t),e.fillStyle(16777215,1),e.fillCircle(10*t,-6*t,1.5*t);break;case"sparkle":e.fillStyle(0,1),e.fillCircle(-8*t,-4*t,5*t),e.fillCircle(8*t,-4*t,5*t),e.fillStyle(16777215,1),e.fillCircle(-6*t,-6*t,2*t),e.fillCircle(10*t,-6*t,2*t),e.fillCircle(-10*t,-2*t,1*t),e.fillCircle(6*t,-2*t,1*t);break;default:n==="big"||n==="huge"?(e.fillCircle(-8*t,-4*t,5*t),e.fillCircle(8*t,-4*t,5*t)):n==="almond"?(e.fillEllipse(-8*t,-4*t,5*t,4*t),e.fillEllipse(8*t,-4*t,5*t,4*t)):n==="smart"?(e.fillEllipse(-8*t,-4*t,4*t,3*t),e.fillEllipse(8*t,-4*t,4*t,3*t),e.lineStyle(1.5*t,0,.4),e.beginPath(),e.moveTo(-12*t,-8*t),e.lineTo(-4*t,-7*t),e.strokePath(),e.beginPath(),e.moveTo(12*t,-8*t),e.lineTo(4*t,-7*t),e.strokePath()):n==="gentle"?(e.fillEllipse(-8*t,-3*t,4*t,4*t),e.fillEllipse(8*t,-3*t,4*t,4*t)):n==="bushy"?(e.fillCircle(-8*t,-4*t,3*t),e.fillCircle(8*t,-4*t,3*t)):n==="sharp"?(e.fillEllipse(-8*t,-4*t,4*t,3*t),e.fillEllipse(8*t,-4*t,4*t,3*t),e.lineStyle(2*t,0,.6),e.beginPath(),e.moveTo(-12*t,-9*t),e.lineTo(-5*t,-7*t),e.strokePath(),e.beginPath(),e.moveTo(12*t,-9*t),e.lineTo(5*t,-7*t),e.strokePath()):n==="wild"?(e.fillEllipse(-7*t,-5*t,4*t,3*t),e.fillEllipse(7*t,-5*t,4*t,3*t)):n==="noble"?(e.fillEllipse(-8*t,-4*t,4*t,4*t),e.fillEllipse(8*t,-4*t,4*t,4*t)):n==="droopy"?(e.fillEllipse(-8*t,-2*t,5*t,4*t),e.fillEllipse(8*t,-2*t,5*t,4*t)):(e.fillCircle(-8*t,-4*t,4*t),e.fillCircle(8*t,-4*t,4*t)),e.fillStyle(16777215,1),e.fillCircle(-6*t,-6*t,1.5*t),e.fillCircle(10*t,-6*t,1.5*t)}}static drawMouth(e,s,t){e.lineStyle(2*s,0,.8),t==="happy"||t==="wink"||t==="sparkle"?(e.beginPath(),e.arc(0,10*s,6*s,.2,Math.PI-.2,!1),e.strokePath()):(e.beginPath(),e.moveTo(-4*s,12*s),e.lineTo(0,14*s),e.lineTo(4*s,12*s),e.strokePath())}}class oe{static draw(e,s,t,i=16758465,o=16,n=1){const r=e.add.container(s,t);if(i==="rainbow"){const F=[16739179,16766720,9498256,8900331,14524637];i=F[Math.floor(Math.random()*F.length)]}const a=i>>16&255,l=i>>8&255,c=i&255,d=w.Display.Color.GetColor(Math.min(255,a+60),Math.min(255,l+60),Math.min(255,c+60));w.Display.Color.GetColor(Math.max(0,a-40),Math.max(0,l-40),Math.max(0,c-40));const u=e.add.graphics();u.fillStyle(0,.15),u.fillEllipse(o*.05,o*.3,o*.55,o*.45),[{x:-o*.28,y:-o*.2},{x:-o*.08,y:-o*.35},{x:o*.12,y:-o*.35},{x:o*.32,y:-o*.2}].forEach(F=>{u.fillCircle(F.x,F.y,o*.16)}),r.add(u);const g=e.add.graphics();g.fillStyle(i,1),g.fillEllipse(0,o*.18,o*.52,o*.42);const m=[{x:-o*.3,y:-o*.22,sz:.17},{x:-o*.1,y:-o*.38,sz:.16},{x:o*.1,y:-o*.38,sz:.16},{x:o*.3,y:-o*.22,sz:.17}];m.forEach(F=>{g.fillCircle(F.x,F.y,o*F.sz)}),r.add(g);const y=e.add.graphics();y.fillStyle(d,.6),y.fillEllipse(-o*.12,o*.08,o*.2,o*.15),m.forEach(F=>{y.fillCircle(F.x-o*.05,F.y-o*.05,o*.06)}),r.add(y);const S=e.add.graphics();return S.fillStyle(16777215,.8),S.fillCircle(-o*.15,o*.05,o*.08),S.fillCircle(-o*.2,-o*.3,o*.04),r.add(S),r.setAlpha(n),r}static drawSprite(e,s,t,i,o=16,n=1){if(!e.textures.exists(i))return this.draw(e,s,t,9136404,o,n);const r=e.add.image(s,t,i),l=e.textures.get(i).get(),c=o/Math.max(l.width,l.height);return r.setScale(c),r.setAlpha(n),r}}class Bt extends w.Scene{constructor(){super({key:"BootScene"})}preload(){console.log("ğŸ• ãƒ¯ãƒ³ã“ã­ãã¨ - ç”»åƒã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿ä¸­...");const{width:e,height:s}=this.scale,t=this.add.graphics();t.fillStyle(16770273,1),t.fillRoundedRect(e/2-100,s/2+50,200,20,10);const i=this.add.graphics(),o=this.add.text(e/2,s/2+30,"ãƒ¯ãƒ³ã‚³ãŸã¡ã‚’ã‚ˆã‚“ã§ã„ã¾ã™...",{...D.title,fontSize:"18px"}).setOrigin(.5);this.load.on("progress",n=>{i.clear(),i.fillStyle(16758465,1),i.fillRoundedRect(e/2-98,s/2+52,196*n,16,8)}),this.load.on("complete",()=>{i.destroy(),t.destroy(),o.destroy(),console.log("âœ… ç”»åƒã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿å®Œäº†ï¼")}),_.preload(this),Object.entries(Se).forEach(([n,r])=>{r.hasImage&&r.folder&&Ot.forEach(a=>{var u;const l=`dog_${n}_${a}`,c=((u=r.expressionMap)==null?void 0:u[a])||a,d=`./assets/characters/${r.folder}/${c}.png`;this.load.image(l,d)})}),this.load.image("title_bg","./assets/title/titlehaikei.png"),this.load.image("title_logo","./assets/title/titlelogo.png"),this.load.image("mainmenu_bg","./assets/mainmenu/haikei.png"),this.load.image("erabu_bg","./assets/mainmenu/erabu.png"),this.load.image("zukan_bg","./assets/mainmenu/zukan.png"),this.load.image("kisekae_bg","./assets/mainmenu/kisekae.png"),this.load.image("shop_bg","./assets/mainmenu/shop.png"),this.load.image("settei_bg","./assets/mainmenu/settei.png"),this.load.image("masu","./assets/osanpo/masu_single.png"),this.load.image("osanpo_select_bg","./assets/osanpo/selectgamen.png"),this.load.image("theme_kouen","./assets/kisekae/kouen/kouen.png"),this.load.image("theme_umi","./assets/kisekae/kouen/umi.png"),this.load.image("theme_yuki","./assets/kisekae/kouen/yuki.png"),this.load.image("theme_yuuyake","./assets/kisekae/kouen/yuuyake.png"),this.load.image("theme_yoru","./assets/kisekae/kouen/yoru.png"),this.load.image("theme_sakura","./assets/kisekae/kouen/sakura.png"),this.load.image("theme_hanabi","./assets/kisekae/kouen/hanabi.png"),this.load.image("theme_nizi","./assets/kisekae/kouen/nizi.png"),this.load.image("theme_hosizora","./assets/kisekae/kouen/hosizora.png"),this.load.image("costume_ribbon_red","./assets/kisekae/isyou/ribbon_red.png"),this.load.image("costume_crown_gold","./assets/kisekae/isyou/crown_gold.png"),this.load.image("costume_glasses_star","./assets/kisekae/isyou/glasses_star.png"),this.load.image("costume_flower_sakura","./assets/kisekae/isyou/flower_sakura.png"),this.load.image("costume_beret","./assets/kisekae/isyou/beret.png"),this.load.image("costume_flower_sunflower","./assets/kisekae/isyou/flower_sunflower.png"),this.load.image("costume_hat_straw","./assets/kisekae/isyou/hat_straw.png"),this.load.image("costume_glasses","./assets/kisekae/isyou/glasses.png"),this.load.image("icon_settings","./assets/icon/inu1/settings.png"),this.load.image("icon_music","./assets/icon/inu1/music.png"),this.load.image("icon_sound","./assets/icon/inu1/sound.png"),this.load.image("icon_vibration","./assets/icon/inu1/vibration.png"),this.load.image("icon_back","./assets/icon/inu1/back.png"),this.load.image("icon_refresh","./assets/icon/inu1/refresh.png"),this.load.image("icon_hint","./assets/icon/inu1/hint.png"),this.load.image("icon_play","./assets/icon/inu1/play.png"),this.load.image("icon_pause","./assets/icon/inu1/pause.png"),this.load.image("icon_star","./assets/icon/inu1/star.png"),this.load.image("icon_lock","./assets/icon/inu1/lock.png"),this.load.image("icon_coin","./assets/icon/inu1/coin.png"),this.load.image("icon_paw","./assets/icon/inu1/paw.png"),this.load.image("icon_heart","./assets/icon/inu1/heart.png"),this.load.image("icon_share","./assets/icon/inu1/share.png"),this.load.image("menu_osanpo","./assets/icon/menu/osanpo.png"),this.load.image("menu_endless","./assets/icon/menu/endless.png"),this.load.image("menu_settings","./assets/icon/menu/settings.png"),this.load.image("menu_erabu","./assets/icon/menu/erabu.png"),this.load.image("menu_zukan","./assets/icon/menu/zukan.png"),this.load.image("menu_kisekae","./assets/icon/menu/kisekae.png"),this.load.image("menu_shop","./assets/icon/menu/shop.png"),this.load.image("menu_color","./assets/icon/menu/color.png"),this.load.image("menu_costume","./assets/icon/menu/ribbon.png"),this.load.image("menu_theme","./assets/icon/menu/theme.png"),this.load.image("pack_premium","./assets/icon/shop/pack_premium.png"),this.load.image("pack_customize","./assets/icon/shop/pack_customize.png"),this.load.image("pack_noads","./assets/icon/shop/pack_noads.png"),this.load.image("pack_dog","./assets/icon/shop/pack_dog.png"),Object.entries(ee).forEach(([n,r])=>{const a=`./assets/nikukyu/individual/paw_${n}_${r.suffix}.png`;this.load.image(r.imageKey,a)})}create(){const{width:e,height:s}=this.scale;this.initializeMonetization(),this.add.rectangle(0,0,e,s,I.sky).setOrigin(0);const t=s/2-40,i=[1,2,3,4];this.dogs=[],i.forEach((n,r)=>{const a=e*(.2+r*.2),l=L.draw(this,a,t,n,18,"happy");this.dogs.push(l),this.tweens.add({targets:l,y:t-10,duration:400+r*50,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:r*100})});const o=Math.min(e*.08,28);this.add.text(e/2,s/2+30,"ãƒ¯ãƒ³ã“ã­ãã¨",{...D.title,fontSize:`${o}px`}).setOrigin(.5),this.statusText=this.add.text(e/2,s/2+70,"ã‚ˆã¿ã“ã¿ã¡ã‚…ã†...",{...D.body,fontSize:"16px"}).setOrigin(.5),this.pawProgress=this.add.container(e/2,s/2+110),this.time.delayedCall(300,()=>this.initializeLevels())}initializeLevels(){if(typeof we<"u"){const t=new we(6,20260126);G=[];const i=new Set;let o=0;const n=()=>{var l;let r=0;for(;r<25&&G.length<100;){const c=G.length<30?1:G.length<70?2:3,d=t.generate({difficulty:c,maxAttempts:50});if(d){const u=d.snacks.map(f=>`${f.row},${f.col},${f.type}`).sort().join("|");i.has(u)?o++:(i.add(u),d.id=G.length+1,G.push(d),o=0)}else o++;o>30&&(i.clear(),o=0),r++}this.statusText.setText(`ã‚¹ãƒ†ãƒ¼ã‚¸ç”Ÿæˆä¸­... ${G.length}/100`),this.pawProgress.removeAll(!0);const a=Math.floor(G.length/10);for(let c=0;c<a;c++){const d=c%4+1,u=((l=z[d])==null?void 0:l.color)||16758465,f=oe.draw(this,(c-4.5)*25,0,u,12);this.pawProgress.add(f)}G.length<100?setTimeout(n,10):(this.statusText.setText("ã‹ã‚“ã‚Šã‚‡ã†ï¼"),this.time.delayedCall(600,()=>this.scene.start("TitleScene")))};n()}else G=[{id:1,gridSize:6,pathCount:4,snacks:[{row:0,col:0,type:1},{row:5,col:5,type:1},{row:0,col:5,type:2},{row:5,col:0,type:2},{row:2,col:0,type:3},{row:3,col:5,type:3},{row:3,col:0,type:4},{row:2,col:5,type:4}]}],this.scene.start("TitleScene")}async initializeMonetization(){try{await ie.initialize(),console.log("âœ… AdManager åˆæœŸåŒ–å®Œäº†"),await K.initialize(),console.log("âœ… PurchaseManager åˆæœŸåŒ–å®Œäº†"),console.log("ğŸ” PurchaseManager methods:",{isAdsRemoved:typeof K.isAdsRemoved,hasPremiumDogs:typeof K.hasPremiumDogs,hasCustomize:typeof K.hasCustomize,keys:Object.keys(K)}),K.isAdsRemoved&&K.isAdsRemoved()&&(ie.removeAds(),p.purchases.adFree=!0,v.save(p)),K.hasPremiumDogs&&K.hasPremiumDogs()&&(p.purchases.premiumDogs=!0,v.save(p)),window.addEventListener("adsRemoved",()=>{ie.removeAds(),p.purchases.adFree=!0,v.save(p)})}catch(e){console.warn("âš ï¸ åºƒå‘Šãƒ»èª²é‡‘åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼ï¼ˆWebç’°å¢ƒã§ã¯æ­£å¸¸ï¼‰:",e.message)}}}class Mt extends w.Scene{constructor(){super({key:"TitleScene"})}create(){const{width:e,height:s}=this.scale;p=X.checkAndResetDaily(p),v.save(p),_.ensureUnlocked(this),E.ensureUserGestureListener(),p.tutorial||(p.tutorial={completed:!1,step:0,inProgress:!1},v.save(p)),_.playBgm(this,"bgm_title"),this.createBackground(),this.createLogo(),this.createSettingsButton(),this.createStartText(),this.createVersionText(),this.cameras.main.fadeIn(500)}createBackground(){const{width:e,height:s}=this.scale,t=this.add.image(e/2,s/2,"title_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n)}createLogo(){const{width:e,height:s}=this.scale,t=s*.35,i=this.add.image(e/2,t,"title_logo"),n=e*1.1/i.width;i.setScale(n),i.setDepth(10)}createSettingsButton(){const{width:e}=this.scale,s=M.TOP+12,t=50,i=this.add.container(e-20-t/2,s+t/2),o=this.add.graphics();o.fillStyle(0,.3),o.fillCircle(2,3,t/2),i.add(o);const n=this.add.graphics();n.fillStyle(16777215,.85),n.fillCircle(0,0,t/2),n.lineStyle(2.5,13935988,1),n.strokeCircle(0,0,t/2),i.add(n);const r=this.add.image(0,0,"menu_settings"),a=t*.65/Math.max(r.width,r.height);r.setScale(a),i.add(r),i.setSize(t,t),i.setInteractive({useHandCursor:!0}),i.setDepth(20),i.on("pointerover",()=>this.tweens.add({targets:i,scale:1.1,duration:80})),i.on("pointerout",()=>this.tweens.add({targets:i,scale:1,duration:80})),i.on("pointerdown",()=>{this.tweens.add({targets:i,scale:.9,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),i.on("pointerup",()=>{this.tweens.add({targets:i,scale:1,duration:80}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("SettingsScene"))})}createStartText(){const{width:e,height:s}=this.scale,t=s*.78,i=this.add.rectangle(e/2,t,e,150,0,0).setInteractive({useHandCursor:!0}),o=this.add.text(e/2,t,"â–¶ ã¯ã˜ã‚ã‚‹",{...D.title,fontSize:"28px"}).setOrigin(.5).setDepth(20);this.tweens.add({targets:o,alpha:{from:1,to:.3},duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),i.on("pointerdown",()=>{this.tweens.killTweensOf(o),o.setAlpha(1),this.tweens.add({targets:o,scale:1.2,duration:100,yoyo:!0}),E.impact("Medium")}),i.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{p.tutorial.completed?this.scene.start("MainMenuScene"):(p.tutorial.inProgress=!0,p.tutorial.step=0,v.save(p),this.scene.start("GameScene",{stage:1,mode:"story",tutorialMode:!0}))})})}createVersionText(){const{width:e,height:s}=this.scale;this.add.text(e/2,s-M.BOTTOM-10,"Ver 1.0.0",{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:"#FFFFFF",stroke:"#000000",strokeThickness:2}).setOrigin(.5).setAlpha(.7).setDepth(15)}createStartButton(){const{width:e,height:s}=this.scale,t=e-50,i=70,o=i/2,n=s-M.BOTTOM-i/2-30,r=this.add.container(e/2,n);r.setDepth(20);const a=this.add.graphics();a.fillStyle(0,.4),a.fillRoundedRect(-t/2+5,-i/2+8,t,i,o),r.add(a);const l=this.add.graphics();l.fillStyle(14172949,1),l.fillRoundedRect(-t/2,-i/2+5,t,i,o),r.add(l);const c=this.add.graphics();c.fillStyle(16740419,1),c.fillRoundedRect(-t/2,-i/2,t,i-5,o),r.add(c);const d=this.add.graphics();d.fillStyle(16755601,.6),d.fillRoundedRect(-t/2+8,-i/2+4,t-16,i*.35,o*.6),r.add(d);const u=this.add.graphics();u.fillStyle(16777215,.35),u.fillRoundedRect(-t/2+15,-i/2+5,t-30,10,5),r.add(u);const f=this.add.graphics();f.lineStyle(4,16777215,.7),f.strokeRoundedRect(-t/2,-i/2,t,i-5,o),r.add(f);const g=this.add.text(2,2,"â–¶ ã‚²ãƒ¼ãƒ ã‚’ã¯ã˜ã‚ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#BF360C",fontStyle:"bold"}).setOrigin(.5);r.add(g);const m=this.add.text(0,0,"â–¶ ã‚²ãƒ¼ãƒ ã‚’ã¯ã˜ã‚ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#FFFFFF",fontStyle:"bold",stroke:"#E64A19",strokeThickness:4}).setOrigin(.5);r.add(m),r.setSize(t,i),r.setInteractive({useHandCursor:!0});const y=n;r.on("pointerover",()=>this.tweens.add({targets:r,scale:1.05,duration:100,ease:"Back.easeOut"})),r.on("pointerout",()=>this.tweens.add({targets:r,scale:1,duration:100})),r.on("pointerdown",()=>{this.tweens.add({targets:r,y:y+5,scale:.97,duration:50}),E.impact("Medium")}),r.on("pointerup",()=>{this.tweens.add({targets:r,y,scale:1.08,duration:100,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:r,scale:1,duration:80})}}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{p.tutorial.completed?this.scene.start("MainMenuScene"):(p.tutorial.inProgress=!0,p.tutorial.step=0,v.save(p),this.scene.start("GameScene",{stage:1,mode:"story",tutorialMode:!0}))})}),this.tweens.add({targets:r,scale:{from:1,to:1.02},duration:1200,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}createDogs(){const{width:e,height:s}=this.scale,t=s*.52,i=t-5,o=p.selectedDogs;this.dogContainers=[];const n=[{x:.18,scale:32,offsetY:0},{x:.38,scale:38,offsetY:-15},{x:.62,scale:36,offsetY:-10},{x:.85,scale:30,offsetY:5}];for(let r=0;r<4;r++){const a=o[r]||r+1,l=n[r],c=e*l.x,d=i+l.offsetY,u=L.draw(this,c,d,a,l.scale,"happy");this.dogContainers.push({dog:u,x:c,y:d,type:a,baseY:d});const f=this.add.ellipse(c,d+l.scale+5,l.scale*1.5,l.scale*.4,0,.15);f.setDepth(-1);const g=l.scale*2.5,m=this.add.rectangle(c,d,g,g,0,0).setInteractive({useHandCursor:!0}),y=d;m.on("pointerdown",()=>{this.tweens.killTweensOf(u),this.tweens.add({targets:u,y:y-25,duration:100,yoyo:!0,repeat:2,ease:"Quad.easeOut",onComplete:()=>{this.tweens.add({targets:u,y:y-8,duration:600+r*100,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}});const S=this.add.text(c,d-l.scale-20,"ã‚ã‚“ï¼",{fontSize:"16px",fontFamily:"KeiFont, sans-serif",color:"#5D4037",backgroundColor:"#FFFFFF",padding:{x:10,y:5},stroke:"#FFB6C1",strokeThickness:2}).setOrigin(.5).setScale(0);this.tweens.add({targets:S,scale:1.2,y:d-l.scale-45,duration:200,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:S,alpha:0,y:S.y-20,scale:.8,duration:400,delay:400,onComplete:()=>S.destroy()})}});for(let F=0;F<3;F++){const x=this.add.text(c+w.Math.Between(-20,20),d-l.scale*.5,"â™¥",{fontSize:`${18+F*4}px`,color:"#FF6B8A"}).setOrigin(.5).setScale(0);this.tweens.add({targets:x,y:x.y-50-F*15,scale:{from:0,to:1.3},alpha:{from:1,to:0},duration:700,delay:F*100,ease:"Cubic.easeOut",onComplete:()=>x.destroy()})}E.selection(),_.playSfx(this,"sfx_ui_tap")}),this.tweens.add({targets:u,y:y-8,duration:600+r*100,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:r*200}),this.tweens.add({targets:f,scaleX:{from:1,to:1.1},scaleY:{from:1,to:.9},duration:600+r*100,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:r*200})}this.time.addEvent({delay:3e3,callback:()=>{const r=w.Math.Between(0,3),a=n[r],l=e*a.x,c=t+a.offsetY,d=this.add.text(l,c-a.scale*.3,"â™¥",{fontSize:"20px",color:"#FF6B8A"}).setOrigin(.5).setAlpha(0);this.tweens.add({targets:d,y:d.y-40,alpha:{from:1,to:0},scale:{from:.5,to:1.5},duration:800,onComplete:()=>d.destroy()})},loop:!0})}createDailyMission(){const{width:e,height:s}=this.scale,t=X.getTodaysMissions(p);if(t.length===0)return;const i=t.filter(C=>C.completed).length,o=(p.daily.medalsClaimedToday||[]).length,n=X.getClaimableMedalCount(p)>0,r=20,a=s*.58,l=e-40,c=75,d=this.add.graphics();d.fillStyle(6111287,.25),d.fillRoundedRect(r+4,a+5,l,c,16);const u=this.add.graphics();u.fillStyle(16776176,.98),u.fillRoundedRect(r,a,l,c,16);const f=i===3?16766720:13935988;u.fillStyle(f,1),u.fillRoundedRect(r,a,l,6,{tl:16,tr:16,bl:0,br:0}),u.lineStyle(2.5,f,1),u.strokeRoundedRect(r,a,l,c,16),this.add.text(r+20,a+22,"ğŸ¾ ãã‚‡ã†ã®ãŠã•ã‚“ã½",{fontFamily:"KeiFont, sans-serif",fontSize:"15px",color:"#5D4037",fontStyle:"bold"}).setOrigin(0,.5);const g=e-r-80,m=a+22,y=10,S=26;for(let C=0;C<3;C++){const T=g+C*S,O=this.add.graphics();C<o?(O.fillStyle(16766720,1),O.fillCircle(T,m,y),this.add.text(T,m,"ğŸ…",{fontSize:"12px"}).setOrigin(.5)):C<i?(O.fillStyle(5025616,.3),O.fillCircle(T,m,y),O.lineStyle(2,5025616,1),O.strokeCircle(T,m,y),this.add.text(T,m,"âœ“",{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:"#4CAF50",fontStyle:"bold"}).setOrigin(.5)):(O.fillStyle(14737632,.5),O.fillCircle(T,m,y),O.lineStyle(2,12434877,1),O.strokeCircle(T,m,y))}let F="",x="#888888";o===3?(F="ğŸ‰ ä»Šæ—¥ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼",x="#FFD700"):n?(F="âœ¨ ãƒ¡ãƒ€ãƒ«ãŒã‚‚ã‚‰ãˆã‚‹ã‚ˆï¼",x="#4CAF50"):(F="ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ç¢ºèª â†’",x="#8B7355"),this.add.text(e/2,a+52,F,{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:x,fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5)}createStartButton(){const{width:e,height:s}=this.scale,t=e-50,i=80,o=i/2,n=s*.82,r=this.add.container(e/2,n),a=this.add.graphics();a.fillStyle(6111287,.5),a.fillRoundedRect(-t/2+5,-i/2+10,t,i,o),r.add(a);const l=this.add.graphics();l.fillStyle(14172949,1),l.fillRoundedRect(-t/2,-i/2+6,t,i,o),r.add(l);const c=this.add.graphics();c.fillStyle(16740419,1),c.fillRoundedRect(-t/2,-i/2,t,i-6,o),r.add(c);const d=this.add.graphics();d.fillStyle(16755601,.6),d.fillRoundedRect(-t/2+8,-i/2+4,t-16,i*.35,o*.6),r.add(d);const u=this.add.graphics();u.fillStyle(16777215,.35),u.fillRoundedRect(-t/2+15,-i/2+6,t-30,12,6),r.add(u);const f=this.add.graphics();f.lineStyle(5,16777215,.7),f.strokeRoundedRect(-t/2,-i/2,t,i-6,o),r.add(f);const g=this.add.text(2,3,"â–¶ ã‚²ãƒ¼ãƒ ã‚’ã¯ã˜ã‚ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"32px",color:"#BF360C",fontStyle:"bold"}).setOrigin(.5);r.add(g);const m=this.add.text(0,0,"â–¶ ã‚²ãƒ¼ãƒ ã‚’ã¯ã˜ã‚ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"32px",color:"#FFFFFF",fontStyle:"bold",stroke:"#E64A19",strokeThickness:5}).setOrigin(.5);r.add(m),r.setSize(t,i),r.setInteractive({useHandCursor:!0});const y=n;r.on("pointerover",()=>this.tweens.add({targets:r,scale:1.06,duration:100,ease:"Back.easeOut"})),r.on("pointerout",()=>this.tweens.add({targets:r,scale:1,duration:100})),r.on("pointerdown",()=>{this.tweens.add({targets:r,y:y+6,scale:.97,duration:50}),E.impact("Medium")}),r.on("pointerup",()=>{this.tweens.add({targets:r,y,scale:1.1,duration:100,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:r,scale:1,duration:80})}}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{this.scene.start("MainMenuScene")})}),this.tweens.add({targets:r,scale:{from:1,to:1.03},duration:1e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}createPrimaryButton(e,s,t,i,o,n,r){const a=this.add.container(e,s),l=this.add.graphics();l.fillStyle(0,.22),l.fillRoundedRect(-o/2+3,-n/2+5,o,n,12),a.add(l);const c=this.add.graphics();c.fillStyle(i,1),c.fillRoundedRect(-o/2,-n/2,o,n,12),c.lineStyle(3,16777215,.6),c.strokeRoundedRect(-o/2,-n/2,o,n,12),a.add(c);const d=this.add.text(0,0,t,{...D.button,fontSize:"22px",fontStyle:"bold"}).setOrigin(.5);return a.add(d),a.setSize(o,n),a.setInteractive({useHandCursor:!0}),a.on("pointerover",()=>this.tweens.add({targets:a,scale:1.06,duration:80,ease:"Back.easeOut"})),a.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80})),a.on("pointerdown",()=>{this.tweens.add({targets:a,y:s+4,scale:.94,duration:40}),E.impact("Light")}),a.on("pointerup",()=>{this.tweens.add({targets:a,y:s,scale:1.08,duration:80,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:a,scale:1,duration:60})}}),r()}),a}createImportantButtons(){const{width:e,height:s}=this.scale,t=[{iconKey:"menu_erabu",label:"ãˆã‚‰ã¶",scene:"DogSelectScene"},{iconKey:"menu_zukan",label:"ãšã‹ã‚“",scene:"ZukanScene"},{iconKey:"menu_kisekae",label:"ãã›ã‹ãˆ",scene:"CustomizeScene"},{iconKey:"menu_shop",label:"ã‚·ãƒ§ãƒƒãƒ—",scene:"ShopScene"}],i=e-M.LEFT-M.RIGHT-20,o=86,n=64,r=i/t.length-12,a=w.Math.Clamp(Math.min(o,r),n,o),l=t.length*a,c=(e-l)/(t.length+1),d=s-M.BOTTOM-a*.4-40;t.forEach((u,f)=>{const g=c+a/2+f*(a+c);this.createNavButton(g,d,a,u)})}createNavButton(e,s,t,i){const o=this.add.container(e,s),n=t/2,r=this.add.graphics();r.fillStyle(6111287,.25),r.fillCircle(3,4,n+4),o.add(r);const a=this.add.graphics();a.fillStyle(16776176,1),a.fillCircle(0,0,n),a.fillStyle(16777215,.45),a.fillEllipse(0,-n/3,t*.65,t*.38),a.lineStyle(3,13935988,1),a.strokeCircle(0,0,n),o.add(a);const l=this.add.image(0,-4,i.iconKey),c=t*.68/Math.max(l.width,l.height);l.setScale(c),o.add(l);const d=t*.38,u=t*1.05,f=n+10,g=this.add.graphics();g.fillStyle(16774359,.95),g.fillRoundedRect(-u/2,f,u,d,d/2),g.lineStyle(2,13935988,.6),g.strokeRoundedRect(-u/2,f,u,d,d/2),o.add(g);const m=this.add.text(0,f+d/2,i.label,{fontFamily:"KeiFont, sans-serif",fontSize:`${Math.round(t*.32)}px`,color:"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:6}).setOrigin(.5);return m.setShadow(0,2,"rgba(0,0,0,0.2)",2,!0,!1),o.add(m),o.setSize(t,t+d+40),o.setInteractive({useHandCursor:!0}),o.on("pointerover",()=>this.tweens.add({targets:o,scale:1.12,y:s-3,duration:80,ease:"Back.easeOut"})),o.on("pointerout",()=>this.tweens.add({targets:o,scale:1,y:s,duration:80})),o.on("pointerdown",()=>{this.tweens.add({targets:o,scale:.92,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),o.on("pointerup",()=>{this.tweens.add({targets:o,scale:1,duration:80}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start(i.scene))}),o}createSecondaryButton(e,s,t,i,o,n,r,a=!1){const l=this.add.container(e,s),c=this.add.graphics();c.fillStyle(0,.15),c.fillRoundedRect(-o/2+2,-n/2+3,o,n,10),l.add(c);const d=this.add.graphics();if(d.fillStyle(i,1),d.fillRoundedRect(-o/2,-n/2,o,n,10),d.lineStyle(2,16777215,.5),d.strokeRoundedRect(-o/2,-n/2,o,n,10),l.add(d),a){const f=this.add.text(-o/2+10,0,"âœ¨",{fontSize:"10px"}).setOrigin(.5),g=this.add.text(o/2-10,0,"âœ¨",{fontSize:"10px"}).setOrigin(.5);l.add([f,g]),this.tweens.add({targets:[f,g],alpha:{from:1,to:.3},yoyo:!0,repeat:-1,duration:500})}const u=this.add.text(0,0,t,{...D.buttonSmall,fontSize:"13px",color:a?"#5D4037":"#FFFFFF"}).setOrigin(.5);return l.add(u),l.setSize(o,n),l.setInteractive({useHandCursor:!0}),l.on("pointerover",()=>this.tweens.add({targets:l,scale:1.05,duration:80})),l.on("pointerout",()=>this.tweens.add({targets:l,scale:1,duration:80})),l.on("pointerdown",()=>{this.tweens.add({targets:l,y:s+2,scale:.95,duration:40}),E.impact("Light")}),l.on("pointerup",()=>{this.tweens.add({targets:l,y:s,scale:1.06,duration:80,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:l,scale:1,duration:60})}}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start(r))}),l}createMainButton(e,s,t,i,o,n,r){const a=this.add.container(e,s),l=this.add.graphics();l.fillStyle(0,.2),l.fillRoundedRect(-o/2+3,-n/2+5,o,n,12);const c=this.add.graphics();c.fillStyle(i,1),c.fillRoundedRect(-o/2,-n/2,o,n,12),c.lineStyle(3,16777215,.5),c.strokeRoundedRect(-o/2,-n/2,o,n,12);const d=this.add.text(0,0,t,{...D.button,fontSize:n>55?"26px":"22px"}).setOrigin(.5);return a.add([l,c,d]),a.setSize(o,n),a.setInteractive({useHandCursor:!0}),a.on("pointerover",()=>this.tweens.add({targets:a,scale:1.05,duration:80})),a.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80})),a.on("pointerdown",()=>this.tweens.add({targets:a,y:s+4,duration:50})),a.on("pointerup",()=>{this.tweens.add({targets:a,y:s,duration:80}),r()}),a}createSubButton(e,s,t,i,o,n,r){const a=this.add.container(e,s),l=this.add.graphics();l.fillStyle(i,1),l.fillRoundedRect(-o/2,-n/2,o,n,8),l.lineStyle(2,16777215,.4),l.strokeRoundedRect(-o/2,-n/2,o,n,8);const c=this.add.text(0,0,t,{...D.buttonSmall,fontSize:"13px",align:"center",lineSpacing:-2}).setOrigin(.5);return a.add([l,c]),a.setSize(o,n),a.setInteractive({useHandCursor:!0}),a.on("pointerover",()=>this.tweens.add({targets:a,scale:1.05,duration:80})),a.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80})),a.on("pointerup",r),a}createIconButton(e,s,t,i,o){const n=this.add.container(e,s),r=this.add.graphics();r.fillStyle(16777215,.9),r.fillCircle(0,0,28),r.lineStyle(2,13421772,1),r.strokeCircle(0,0,28);const a=this.add.text(0,-2,t,{fontSize:"24px"}).setOrigin(.5),l=this.add.text(0,38,i,{fontSize:"10px",color:"#666666"}).setOrigin(.5);return n.add([r,a,l]),n.setSize(56,56),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.1,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80})),n.on("pointerup",o),n}createBigShopButton(e,s){const t=this.add.container(e,s),i=200,o=50,n=this.add.graphics();n.fillStyle(13408512,.4),n.fillRoundedRect(-i/2+3,-o/2+4,i,o,25),t.add(n);const r=this.add.graphics();r.fillGradientStyle(16766720,16766720,16761095,16761095,1),r.fillRoundedRect(-i/2,-o/2,i,o,25),r.lineStyle(3,16777215,.6),r.strokeRoundedRect(-i/2,-o/2,i,o,25),t.add(r);const a=this.add.text(-i/2+20,0,"âœ¨",{fontSize:"16px"}).setOrigin(.5);t.add(a);const l=this.add.text(-35,0,"ğŸ›’",{fontSize:"22px"}).setOrigin(.5);t.add(l);const c=this.add.text(15,0,"ã‚·ãƒ§ãƒƒãƒ—",{...D.button,fontSize:"20px",color:"#5D4037"}).setOrigin(.5);t.add(c);const d=this.add.text(i/2-20,0,"âœ¨",{fontSize:"16px"}).setOrigin(.5);return t.add(d),t.setSize(i,o),t.setInteractive({useHandCursor:!0}),this.tweens.add({targets:[a,d],alpha:{from:1,to:.3},scale:{from:1,to:1.3},yoyo:!0,repeat:-1,duration:600,ease:"Sine.easeInOut"}),t.on("pointerover",()=>{this.tweens.add({targets:t,scale:1.08,duration:100,ease:"Back.easeOut"})}),t.on("pointerout",()=>{this.tweens.add({targets:t,scale:1,duration:100})}),t.on("pointerdown",()=>{this.tweens.add({targets:t,y:s+3,scale:.97,duration:50})}),t.on("pointerup",()=>{this.tweens.add({targets:t,y:s,scale:1,duration:80}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("ShopScene"))}),t}}class Pt extends w.Scene{constructor(){super({key:"MainMenuScene"})}init(e){this.tutorialMode=(e==null?void 0:e.tutorialMode)||!1,this.tutorialStep=0,this.tutorialContainer=null,this.menuButtons={}}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select"),this.createBackground(),this.createHeader(),this.createDailyMissions(),this.createMenuButtons(),this.cameras.main.fadeIn(300),this.tutorialMode&&!p.tutorial.completed&&this.time.delayedCall(500,()=>{this.startMenuTutorial()})}createBackground(){const{width:e,height:s}=this.scale,t=this.add.image(e/2,s/2,"mainmenu_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n),t.setDepth(0)}createHeader(){const{width:e}=this.scale,s=M.TOP+20;this.createBackButton(42,s),this.add.text(e/2,s,"ğŸ¾ ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼",{...D.heading,fontSize:"17px"}).setOrigin(.5)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.85),i.fillRoundedRect(-30,-13,60,26,8),i.lineStyle(1.5,z[3].color,.7),i.strokeRoundedRect(-30,-13,60,26,8);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"11px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(60,26),t.setInteractive({useHandCursor:!0}),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("TitleScene"))}),t}createDailyMissions(){const{width:e,height:s}=this.scale,t=X.getTodaysMissions(p);if(t.length===0)return;const i=M.TOP+50,n=s-M.BOTTOM-15-i,r=.85+1.2+1,a=n*(.85/r),l=n*(1.2/r),c=24,d=Math.min(105,a-10),u=i+(a-d)/2,f=e-48;this.mainZoneCenterY=i+a+l/2,this.subZoneCenterY=i+a+l+(n-a-l)/2,this.menuButtons.dailyCard={x:c,y:u,w:f,h:d};const g=this.add.graphics();g.fillStyle(6111287,.08),g.fillRoundedRect(c+2,u+2,f,d,14);const m=this.add.graphics();m.fillStyle(16777215,.55),m.fillRoundedRect(c,u,f,d,14),m.fillStyle(16777215,.25),m.fillRoundedRect(c,u,f,d*.4,{tl:14,tr:14,bl:0,br:0});const S=t.filter(O=>O.completed).length===3?16766720:12886122;m.lineStyle(1.5,S,.6),m.strokeRoundedRect(c,u,f,d,14);const F=(p.daily.medalsClaimedToday||[]).length;this.add.text(c+14,u+14,"ğŸ¾ ãã‚‡ã†ã®ãŠã•ã‚“ã½",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",color:"#6D5847",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:1.5}).setOrigin(0,.5),this.add.text(c+f-14,u+14,`ğŸ… ${F}/3`,{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:F===3?"#DAA520":"#8B7355",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:1.5}).setOrigin(1,.5);const x=u+30,C=22,T=3;t.forEach((O,k)=>{const b=x+k*(C+T);this.createMissionRow(c+10,b,f-20,C,O,k)})}createMissionRow(e,s,t,i,o,n){const r=X.isMedalClaimed(p,o.id),a=o.completed&&!r,l=this.add.graphics();r?l.fillStyle(16766720,.12):o.completed?l.fillStyle(5025616,.15):l.fillStyle(9139029,.08),l.fillRoundedRect(e,s,t,i,6);const c=e+22;if(r)this.add.text(c,s+i/2,"ğŸ…",{fontSize:"12px"}).setOrigin(.5);else if(o.completed)this.add.text(c,s+i/2,"âœ“",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",color:"#4CAF50",fontStyle:"bold"}).setOrigin(.5);else{const g=o.progress,m=o.target,y=Math.min(g/m,1),S=26,F=6,x=this.add.graphics();x.fillStyle(9139029,.2),x.fillRoundedRect(c-S/2,s+i/2-F/2,S,F,3),x.fillStyle(5025616,.8),x.fillRoundedRect(c-S/2,s+i/2-F/2,S*y,F,3),this.add.text(c,s+i/2+7,`${g}/${m}`,{fontFamily:"KeiFont, sans-serif",fontSize:"8px",color:"#8B7355"}).setOrigin(.5)}const d=e+44,u=r?"#A89888":o.completed?"#4CAF50":"#5D4037",f=r?"normal":"bold";if(this.add.text(d,s+i/2,o.name,{fontFamily:"KeiFont, sans-serif",fontSize:"11px",color:u,fontStyle:f,stroke:"#FFFFFF",strokeThickness:1}).setOrigin(0,.5),a){const y=e+t-50-4,S=s+(i-18)/2,F=this.add.container(y+50/2,S+18/2),x=this.add.graphics();x.fillStyle(16766720,1),x.fillRoundedRect(-50/2,-18/2,50,18,18/2),x.fillStyle(16772235,.5),x.fillRoundedRect(-50/2+2,-18/2+2,46,18*.4,5),F.add(x);const C=this.add.text(0,0,"GET!",{fontFamily:"KeiFont, sans-serif",fontSize:"10px",color:"#5D4037",fontStyle:"bold"}).setOrigin(.5);F.add(C),F.setSize(50,18),F.setInteractive({useHandCursor:!0}),this.tweens.add({targets:F,scale:{from:1,to:1.08},duration:350,yoyo:!0,repeat:-1}),F.on("pointerdown",()=>{this.tweens.add({targets:F,scale:.9,duration:50}),E.impact("Light")}),F.on("pointerup",()=>{const T=X.awardMedalForMission(p,o.id);T.awarded&&this.scene.start("MedalCelebrationScene",{totalMedals:T.totalMedals,newCostumes:T.newCostumes,stampCount:T.stampCount,returnScene:"MainMenuScene"})})}}createMenuButtons(){const{width:e,height:s}=this.scale,t=this.mainZoneCenterY||s*.46,i=this.subZoneCenterY||s*.8,o=(e-60)/2,n=105,r=12,a=this.createMainMenuButton(e/2-o/2-r/2,t-12,o,n,"menu_osanpo","ãŠã•ã‚“ã½",2533018,35195,()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("SelectScene"))});this.menuButtons.osanpo=a,this.add.text(e/2-o/2-r/2,t-12+n/2+14,"å…¨100ã‚¹ãƒ†ãƒ¼ã‚¸",{fontFamily:"KeiFont, sans-serif",fontSize:"11px",color:"#1B5E50",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5),this.createMainMenuButton(e/2+o/2+r/2,t-12,o,n,"menu_endless","ã‚¨ãƒ³ãƒ‰ãƒ¬ã‚¹",16740419,15092249,()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("GameScene",{mode:"challenge"}))}),this.add.text(e/2+o/2+r/2,t-12+n/2+14,"1ãƒŸã‚¹ã§ãŠã‚ã‚Šï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"11px",color:"#BF360C",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);const l=62,c=10,d=[{iconKey:"menu_erabu",label:"ãˆã‚‰ã¶",scene:"DogSelectScene",color:16758465},{iconKey:"menu_zukan",label:"ãšã‹ã‚“",scene:"ZukanScene",color:11393254},{iconKey:"menu_kisekae",label:"ãã›ã‹ãˆ",scene:"CustomizeScene",color:14524637},{iconKey:"menu_shop",label:"ã‚·ãƒ§ãƒƒãƒ—",scene:"ShopScene",color:16766720}],u=d.length*l+(d.length-1)*c,f=(e-u)/2+l/2;d.forEach((g,m)=>{const y=f+m*(l+c),S=this.createSubMenuButton(y,i,l,g);g.scene==="DogSelectScene"&&(this.menuButtons.erabu=S,this.menuButtons.erabuPos={x:y,y:i}),g.scene==="CustomizeScene"&&(this.menuButtons.kisekae=S,this.menuButtons.kisekaePos={x:y,y:i})})}createMainMenuButton(e,s,t,i,o,n,r,a,l){const c=this.add.container(e,s),d=this.add.graphics();d.fillStyle(0,.08),d.fillRoundedRect(-t/2+6,-i/2+10,t,i,18),c.add(d);const u=this.add.graphics();u.fillStyle(0,.18),u.fillRoundedRect(-t/2+3,-i/2+6,t,i,16),c.add(u);const f=this.add.graphics();f.fillStyle(a,1),f.fillRoundedRect(-t/2,-i/2,t,i,18),f.fillStyle(r,1),f.fillRoundedRect(-t/2,-i/2,t,i*.65,{tl:18,tr:18,bl:0,br:0}),f.fillStyle(16777215,.35),f.fillRoundedRect(-t/2+8,-i/2+5,t-16,i*.25,12),f.fillStyle(16777215,.15),f.fillRoundedRect(-t/2+4,-i/2+2,t-8,i*.4,14),f.lineStyle(3.5,16777215,.6),f.strokeRoundedRect(-t/2,-i/2,t,i,18),c.add(f);const g=this.add.image(0,-18,o),m=i*.42/Math.max(g.width,g.height);g.setScale(m),c.add(g);const y=this.add.text(0,26,n,{...D.button,fontSize:"21px",stroke:"#00000066",strokeThickness:4}).setOrigin(.5);return c.add(y),c.setSize(t,i),c.setInteractive({useHandCursor:!0}),c.on("pointerover",()=>this.tweens.add({targets:c,scale:1.06,duration:100,ease:"Back.easeOut"})),c.on("pointerout",()=>this.tweens.add({targets:c,scale:1,duration:100})),c.on("pointerdown",()=>{this.tweens.add({targets:c,y:s+5,scale:.96,duration:50}),E.impact("Light")}),c.on("pointerup",()=>{this.tweens.add({targets:c,y:s,scale:1.05,duration:100,ease:"Back.easeOut",onComplete:()=>this.tweens.add({targets:c,scale:1,duration:80})}),l()}),c}createSubMenuButton(e,s,t,i){const o=this.add.container(e,s),n=this.add.graphics();n.fillStyle(6111287,.2),n.fillCircle(2,3,t/2),o.add(n);const r=this.add.graphics();r.fillStyle(i.color,1),r.fillCircle(0,0,t/2),r.fillStyle(16777215,.35),r.fillEllipse(0,-t/6,t*.52,t*.28),r.lineStyle(2.5,16777215,.55),r.strokeCircle(0,0,t/2),o.add(r);const a=this.add.image(0,-2,i.iconKey),l=t*.54/Math.max(a.width,a.height);a.setScale(l),o.add(a);const c=this.add.text(0,t/2+13,i.label,{fontFamily:"KeiFont, sans-serif",fontSize:"11px",color:"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:2.5}).setOrigin(.5);return o.add(c),o.setSize(t,t+24),o.setInteractive({useHandCursor:!0}),o.on("pointerover",()=>this.tweens.add({targets:o,scale:1.1,y:s-2,duration:80,ease:"Back.easeOut"})),o.on("pointerout",()=>this.tweens.add({targets:o,scale:1,y:s,duration:80})),o.on("pointerdown",()=>{this.tweens.add({targets:o,scale:.92,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),o.on("pointerup",()=>{this.tweens.add({targets:o,scale:1,duration:80}),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start(i.scene))}),o}startMenuTutorial(){this.tutorialStep=0,this.showMenuTutorialStep()}showMenuTutorialStep(){const{width:e,height:s}=this.scale,t=[{text:"ã“ã“ãŒãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã ã‚ˆï¼",subText:"ã„ã‚ã‚“ãªéŠã³æ–¹ãŒã§ãã‚‹ã‚ˆ",highlightType:"none"},{text:"ã€Œãã‚‡ã†ã®ãŠã•ã‚“ã½ã€ã‚’é”æˆã—ã‚ˆã†ï¼",subText:"ã‚¯ãƒªã‚¢ã™ã‚‹ã¨ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«ãŒã‚‚ã‚‰ãˆã‚‹ã‚ˆ",highlightType:"daily"},{text:"ã€ŒãŠã•ã‚“ã½ã€ã§ã‚¹ãƒ†ãƒ¼ã‚¸ã«æŒ‘æˆ¦ï¼",subText:"å…¨100ã‚¹ãƒ†ãƒ¼ã‚¸ã‚ã‚‹ã‚ˆ",highlightType:"osanpo"},{text:"ã€Œãã›ã‹ãˆã€ã§ãŠã—ã‚ƒã‚Œã—ã‚ˆã†ï¼",subText:"ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«ã§ã“ã†ã‹ã‚“ã§ãã‚‹ã‚ˆ",highlightType:"kisekae"},{text:"ã€Œãˆã‚‰ã¶ã€ã§ãƒ¯ãƒ³ã‚³ã‚’å¤‰ãˆã‚ˆã†ï¼",subText:"ã•ã£ãã‚²ãƒƒãƒˆã—ãŸãƒ¯ãƒ³ã‚³ã‚’è¨­å®šã—ã¦ã¿ã‚ˆã†",highlightType:"erabu"}];if(this.tutorialStep>=t.length){p.tutorial.inProgress=!0,v.save(p),this.hideTutorialOverlay(),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{this.scene.start("DogSelectScene",{tutorialMode:!0})});return}const i=t[this.tutorialStep];this.showTutorialOverlay(i)}showTutorialOverlay(e){const{width:s,height:t}=this.scale;this.hideTutorialOverlay(),this.tutorialContainer=this.add.container(0,0).setDepth(1e3);const i=this.add.graphics();i.fillStyle(0,.7),i.fillRect(0,0,s,t),this.tutorialContainer.add(i),e.highlightType==="osanpo"&&this.menuButtons.osanpo?this.highlightButton(this.menuButtons.osanpo):e.highlightType==="erabu"&&this.menuButtons.erabu?this.highlightButtonCircle(this.menuButtons.erabuPos):e.highlightType==="daily"&&this.menuButtons.dailyCard?this.highlightRect(this.menuButtons.dailyCard):e.highlightType==="kisekae"&&this.menuButtons.kisekae&&this.highlightButtonCircle(this.menuButtons.kisekaePos);const o=t*.78,n=this.add.graphics();n.fillStyle(16777215,.95),n.fillRoundedRect(30,o-50,s-60,120,16),this.tutorialContainer.add(n);const r=this.add.text(s/2,o-15,e.text,{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#5D4037",fontStyle:"bold",wordWrap:{width:s-80},align:"center"}).setOrigin(.5);this.tutorialContainer.add(r);const a=this.add.text(s/2,o+18,e.subText,{fontFamily:"KeiFont, sans-serif",fontSize:"15px",color:"#8D6E63",wordWrap:{width:s-80},align:"center"}).setOrigin(.5);this.tutorialContainer.add(a);const l=this.add.text(s/2,o+52,"â–¼ ã‚¿ãƒƒãƒ—ã—ã¦ã¤ã¥ã‘ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#A1887F"}).setOrigin(.5);this.tutorialContainer.add(l),this.tweens.add({targets:l,alpha:{from:1,to:.4},duration:600,yoyo:!0,repeat:-1});const c=this.add.rectangle(s/2,t/2,s,t,0,0).setInteractive({useHandCursor:!0});this.tutorialContainer.add(c),c.on("pointerdown",()=>{E.selection(),_.playSfx(this,"sfx_ui_tap"),this.tutorialStep++,this.showMenuTutorialStep()})}highlightButton(e){const s=e.getBounds(),t=this.add.graphics();t.fillStyle(16777215,.3),t.fillRoundedRect(s.x-10,s.y-10,s.width+20,s.height+20,20),this.tutorialContainer.add(t),this.tweens.add({targets:t,alpha:{from:.3,to:.6},duration:500,yoyo:!0,repeat:-1})}highlightButtonCircle(e){const s=this.add.graphics();s.fillStyle(16777215,.3),s.fillCircle(e.x,e.y,45),this.tutorialContainer.add(s),this.tweens.add({targets:s,alpha:{from:.3,to:.6},scaleX:{from:1,to:1.1},scaleY:{from:1,to:1.1},duration:500,yoyo:!0,repeat:-1})}highlightRect(e){const s=this.add.graphics();s.fillStyle(16777215,.3),s.fillRoundedRect(e.x-5,e.y-5,e.w+10,e.h+10,18),s.lineStyle(3,16766287,1),s.strokeRoundedRect(e.x-5,e.y-5,e.w+10,e.h+10,18),this.tutorialContainer.add(s),this.tweens.add({targets:s,alpha:{from:.3,to:.6},duration:500,yoyo:!0,repeat:-1})}hideTutorialOverlay(){this.tutorialContainer&&(this.tutorialContainer.destroy(),this.tutorialContainer=null)}}class At extends w.Scene{constructor(){super({key:"ModeSelectScene"})}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select"),this.add.rectangle(0,0,e,s,I.sky).setOrigin(0);const t=this.add.graphics();t.fillStyle(I.ground,1),t.fillRect(0,s*.6,e,s*.4);const i=M.TOP+32,o=this.add.graphics();o.fillStyle(I.uiBg,.95),o.fillRect(0,0,e,i+50),this.createBackButton(50,i),this.add.text(e/2,i,"ğŸ® ãƒ¢ãƒ¼ãƒ‰ã‚’ãˆã‚‰ã¶",{...D.heading,fontSize:"22px"}).setOrigin(.5);const n=s*.42,r=e-60,a=100,l=20;this.createModeButton(e/2,n-a/2-l/2,r,a,"ğŸ¯ ãŠã•ã‚“ã½","å…¨100ã‚¹ãƒ†ãƒ¼ã‚¸",5025616,()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("SelectScene"))}),this.createModeButton(e/2,n+a/2+l/2,r,a,"ğŸ”¥ ã‚¨ãƒ³ãƒ‰ãƒ¬ã‚¹","âš ï¸ 1ãƒŸã‚¹ã§ãŠã‚ã‚Šï¼ã©ã“ã¾ã§ã„ã‘ã‚‹ï¼Ÿ",16733986,()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("GameScene",{mode:"challenge"}))}),this.cameras.main.fadeIn(300)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("TitleScene"))}),t}createModeButton(e,s,t,i,o,n,r,a){const l=this.add.container(e,s),c=this.add.graphics();c.fillStyle(0,.2),c.fillRoundedRect(-t/2+4,-i/2+6,t,i,20),l.add(c);const d=this.add.graphics();d.fillStyle(r,1),d.fillRoundedRect(-t/2,-i/2,t,i,20),d.lineStyle(4,16777215,.5),d.strokeRoundedRect(-t/2,-i/2,t,i,20),l.add(d);const u=this.add.graphics();u.fillStyle(16777215,.2),u.fillRoundedRect(-t/2+10,-i/2+5,t-20,20,10),l.add(u);const f=this.add.text(0,-15,o,{fontFamily:"KeiFont, sans-serif",fontSize:"26px",color:"#FFFFFF",fontStyle:"bold",stroke:w.Display.Color.IntegerToColor(r).darken(30).color,strokeThickness:3}).setOrigin(.5);l.add(f);const g=this.add.text(0,20,n,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#FFFFFF",stroke:"#00000044",strokeThickness:2}).setOrigin(.5);return l.add(g),l.setSize(t,i),l.setInteractive({useHandCursor:!0}),l.on("pointerover",()=>this.tweens.add({targets:l,scale:1.03,duration:80})),l.on("pointerout",()=>this.tweens.add({targets:l,scale:1,duration:80})),l.on("pointerdown",()=>{this.tweens.add({targets:l,y:s+4,scale:.97,duration:40}),E.impact("Light")}),l.on("pointerup",()=>{this.tweens.add({targets:l,y:s,scale:1.05,duration:80,ease:"Back.easeOut"}),a()}),l.setScale(0),this.tweens.add({targets:l,scale:1,duration:300,ease:"Back.easeOut",delay:o.includes("ã‚¹ãƒ†ãƒ¼ã‚¸")?100:200}),l}}class It extends w.Scene{constructor(){super({key:"SelectScene"}),this.page=0,this.perPage=12}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select");const t=p.selectedDogs.includes(5),i=v.isDogUnlocked(p,29);if(t&&!i&&Math.random()<1/50){this.showGoldenWankoEncounter();return}const o=M.TOP+32;this.add.image(e/2,s/2,"osanpo_select_bg").setDisplaySize(e,s),this.createBackButton(50,o+2),this.add.text(e/2,o+2,"ğŸ¾ ãŠã•ã‚“ã½",{...D.heading,fontSize:"22px"}).setOrigin(.5),this.createGrid(),this.createPagination(),this.cameras.main.fadeIn(300)}showGoldenWankoEncounter(){const{width:e,height:s}=this.scale,t=this.add.graphics();t.fillGradientStyle(16766720,16766720,16753920,16753920,1),t.fillRect(0,0,e,s);for(let o=0;o<30;o++){const n=this.add.text(w.Math.Between(0,e),w.Math.Between(0,s),"âœ¨",{fontSize:w.Math.Between(16,32)+"px"});this.tweens.add({targets:n,alpha:{from:.3,to:1},scale:{from:.8,to:1.2},duration:w.Math.Between(500,1500),yoyo:!0,repeat:-1})}const i=this.add.text(e/2,s*.2,"ï¼ï¼ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"48px",color:"#FF6B6B",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:5,shadow:{offsetX:2,offsetY:3,color:"#00000033",blur:4,fill:!0}}).setOrigin(.5).setScale(0);this.tweens.add({targets:i,scale:1,duration:500,ease:"Back.easeOut"}),this.time.delayedCall(600,()=>{const o=L.draw(this,e/2,s*.45,29,50,"excited");o.setScale(0),this.tweens.add({targets:o,scale:1,duration:800,ease:"Back.easeOut"}),this.time.delayedCall(400,()=>{const n=this.add.text(e/2,s*.68,`ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³ã‚’
ã¯ã£ã‘ã‚“ï¼`,{...D.heading,fontSize:"26px",align:"center"}).setOrigin(.5).setAlpha(0);this.tweens.add({targets:n,alpha:1,duration:500})})}),this.time.delayedCall(2e3,()=>{v.unlockDog(p,29),v.save(p),this.add.text(e/2,s*.8,"ğŸ‰ ãªã‹ã¾ã«ãªã£ãŸï¼",{...D.section,fontSize:"22px",color:"#4CAF50"}).setOrigin(.5),this.time.delayedCall(800,()=>{const o=this.add.container(e/2,s*.9),n=this.add.graphics();n.fillStyle(5025616,1),n.fillRoundedRect(-80,-25,160,50,12);const r=this.add.text(0,0,"ã¤ã¥ã‘ã‚‹",{...D.buttonSmall,fontSize:"18px"}).setOrigin(.5);o.add([n,r]),o.setSize(160,50),o.setInteractive({useHandCursor:!0}),o.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.restart())}),o.setScale(0),this.tweens.add({targets:o,scale:1,duration:300,ease:"Back.easeOut"})})}),this.cameras.main.fadeIn(500)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("MainMenuScene"))}),t}createGrid(){const{width:e,height:s}=this.scale,t=3,i=90,o=100,n=10,r=t*i+(t-1)*n,a=(e-r)/2,l=M.TOP+90,d=s-M.BOTTOM-55-l,u=Math.ceil(this.perPage/t),f=u*o+(u-1)*n,g=l+(d-f)/2+o/2,m=this.page*this.perPage,y=Math.min(m+this.perPage,G.length);for(let S=m;S<y;S++){const F=S-m,x=F%t,C=Math.floor(F/t),T=a+x*(i+n)+i/2,O=g+C*(o+n);this.createCard(T,O,i,o,S)}}createCard(e,s,t,i,o){const n=this.add.container(e,s),r=G[o],a=o+1,l=tt().includes(a),c=this.add.graphics();c.fillStyle(8947848,.2),c.fillRoundedRect(-t/2,-i/2,t,i,8),c.x=3,c.y=3;const d=this.add.graphics();l?(d.fillStyle(16775910,1),d.fillRoundedRect(-t/2,-i/2,t,i,8),d.lineStyle(2,16766720,1),d.strokeRoundedRect(-t/2,-i/2,t,i,8)):(d.fillStyle(I.cellBg,1),d.fillRoundedRect(-t/2,-i/2,t,i,8),d.lineStyle(2,I.cellOutline,1),d.strokeRoundedRect(-t/2,-i/2,t,i,8));const u=this.add.text(0,-i/2+16,`${o+1}`,{fontSize:"16px",fontStyle:"bold",color:I.textDark}).setOrigin(.5),f=this.createPreview(r,42);if(n.add([c,d,u,f]),l){const g=this.add.text(t/2-12,-i/2+8,"â˜…",{fontSize:"18px",color:"#FFD700"}).setOrigin(.5);n.add(g)}return n.setSize(t,i),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.08,y:s-3,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,y:s,duration:80})),n.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("GameScene",{mode:"normal",levelIndex:o}))}),n.setScale(0),this.tweens.add({targets:n,scale:1,duration:200,delay:o%this.perPage*30,ease:"Back.easeOut"}),n}createPreview(e,s){var a;const t=this.add.container(0,15),i=s/6,o=-s/2,n=p.selectedDogs,r=this.add.graphics();r.fillStyle(I.grass,.3),r.fillRoundedRect(o-2,o-2,s+4,s+4,4),t.add(r);for(let l=0;l<6;l++)for(let c=0;c<6;c++){const d=o+c*i+i/2,u=o+l*i+i/2,f=e.snacks.find(m=>m.row===l&&m.col===c),g=this.add.graphics();if(f){const m=n[(f.type-1)%n.length],y=((a=z[m])==null?void 0:a.color)||14596231;g.fillStyle(y,1),g.fillCircle(d,u,i*.35),g.lineStyle(1,I.cellOutline,1),g.strokeCircle(d,u,i*.35)}else g.fillStyle(I.cellBg,1),g.fillCircle(d,u,i*.2);t.add(g)}return t}createPagination(){const{width:e,height:s}=this.scale,t=Math.ceil(G.length/this.perPage),i=s-M.BOTTOM-30,o=this.add.graphics();if(o.fillStyle(16777215,.9),o.fillRoundedRect(e/2-70,i-16,140,32,8),this.add.text(e/2,i,`${this.page+1} / ${t}`,{fontSize:"16px",fontStyle:"bold",color:I.textDark}).setOrigin(.5),this.page>0){const n=this.add.container(e/2-50,i),r=this.add.graphics();r.fillStyle(z[2].color,1),r.fillCircle(0,0,14);const a=this.add.text(0,0,"â—€",{fontSize:"14px",color:"#FFFFFF"}).setOrigin(.5);n.add([r,a]),n.setSize(28,28),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.15,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80})),n.on("pointerup",()=>{this.page--,this.scene.restart()})}if(this.page<t-1){const n=this.add.container(e/2+50,i),r=this.add.graphics();r.fillStyle(z[1].color,1),r.fillCircle(0,0,14);const a=this.add.text(0,0,"â–¶",{fontSize:"14px",color:"#FFFFFF"}).setOrigin(.5);n.add([r,a]),n.setSize(28,28),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.15,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80})),n.on("pointerup",()=>{this.page++,this.scene.restart()})}}}class zt extends w.Scene{constructor(){super({key:"GameScene"})}init(e){this.mode=e.mode||"normal",this.lvIndex=e.levelIndex||0,this.chalScore=e.challengeScore||0,this.hasGolden=!1,this.existingTypes=[],this.tutorialMode=e.tutorialMode||!1,this.tutorialStep=0,this.tutorialOverlay=null,this.tutorialContainer=null}create(){const{width:e,height:s}=this.scale,t=this.mode==="challenge"?"bgm_challenge":"bgm_story";_.playBgm(this,t),this.mode==="challenge"&&this.chalScore===0&&X.updateProgress(p,"challenge_try"),this.createBackground(),this.loadLevel(),this.createGrid(),this.createUI(),this.setupInput(),this.playEntryAnim(),this.cameras.main.fadeIn(300),this.legendEncounter&&this.time.delayedCall(500,()=>{this.showLegendEncounterEffect()}),this.tutorialMode&&this.time.delayedCall(800,()=>{this.startTutorial()})}showLegendEncounterEffect(){const{width:e,height:s}=this.scale;this.input.enabled=!1;const t=this.add.rectangle(e/2,s/2,e,s,0,.7).setDepth(1e3);for(let r=0;r<20;r++){const a=this.add.text(w.Math.Between(50,e-50),w.Math.Between(100,s-100),"âœ¨",{fontSize:w.Math.Between(20,40)+"px"}).setOrigin(.5).setDepth(1001).setAlpha(0);this.tweens.add({targets:a,alpha:{from:0,to:1},scale:{from:0,to:1.2},duration:500,delay:r*50,yoyo:!0,onComplete:()=>a.destroy()})}const i=this.add.text(e/2,s*.4,this.legendEncounter.encounterMessage,{fontFamily:"KeiFont",fontSize:"36px",color:"#FFD700",stroke:"#000",strokeThickness:4,align:"center"}).setOrigin(.5).setDepth(1002).setAlpha(0).setScale(.5);this.tweens.add({targets:i,alpha:1,scale:1,duration:500,ease:"Back.easeOut"});const o=this.add.text(e/2,s*.55,`ã€${this.legendEncounter.name}ã€‘`,{fontFamily:"KeiFont",fontSize:"28px",color:"#FFFFFF",stroke:"#8B0000",strokeThickness:3,align:"center"}).setOrigin(.5).setDepth(1002).setAlpha(0);this.tweens.add({targets:o,alpha:1,duration:500,delay:300});const n=this.add.text(e/2,s*.65,`ãƒ‘ã‚ºãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¦
ãªã‹ã¾ã«ã—ã‚ˆã†ï¼`,{fontFamily:"KeiFont",fontSize:"22px",color:"#FFFFFF",stroke:"#000",strokeThickness:2,align:"center"}).setOrigin(.5).setDepth(1002).setAlpha(0);this.tweens.add({targets:n,alpha:1,duration:500,delay:600}),this.time.delayedCall(2500,()=>{this.tweens.add({targets:[t,i,o,n],alpha:0,duration:300,onComplete:()=>{t.destroy(),i.destroy(),o.destroy(),n.destroy(),this.input.enabled=!0}})})}createBackground(){const{width:e,height:s}=this.scale,t=ke[p.customize.theme]||ke.default,i=M.TOP+60;if(t.image&&this.textures.exists(t.image)){const x=this.add.image(e/2,s/2,t.image),C=e/x.width,T=s/x.height,O=Math.max(C,T);x.setScale(O),x.setDepth(-1)}else{this.add.rectangle(0,0,e,s,t.sky).setOrigin(0);const x=this.add.graphics();x.fillStyle(t.ground,1),x.fillRect(0,i,e,s-i)}const o=M.TOP+60,n=M.BOTTOM+60,r=20,a=s-o-n-r,l=e-r*2,c=Math.min(l,a),d=(e-c)/2,u=o+(a-c)/2,f=8,g=d-f,m=u-f,y=c+f*2,S=c+f*2,F=this.add.graphics();F.fillStyle(I.grass,.85),F.fillRoundedRect(g,m,y,S,14),F.lineStyle(2,I.grassDark,1),F.strokeRoundedRect(g,m,y,S,14)}loadLevel(){if(this.mode==="challenge")if(typeof we<"u"){const t=new we(6),i=Math.min(3,1+Math.floor(this.chalScore/5));this.level=t.generate({difficulty:i,maxAttempts:50})||G[w.Math.Between(0,G.length-1)]}else this.level=G[w.Math.Between(0,G.length-1)];else this.level=G[this.lvIndex];if(this.legendEncounter=null,this.hasGolden=!1,this.mode==="challenge"){const t=this.checkLegendEncounter();t&&(this.legendEncounter=t,console.log(`âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³é­é‡ï¼ ${t.name}`))}this.grid=[];for(let t=0;t<6;t++){this.grid[t]=[];for(let i=0;i<6;i++)this.grid[t][i]={type:0,isEnd:!1,pathType:0}}const e=JSON.parse(JSON.stringify(this.level.snacks)),s=p.selectedDogs;if(e.forEach(t=>{t.type=s[(t.type-1)%s.length]}),this.legendEncounter){const t={};e.forEach((o,n)=>{t[o.type]||(t[o.type]=[]),t[o.type].push(n)});const i=Object.keys(t).filter(o=>t[o].length>=2);if(i.length>0){const o=parseInt(i[Math.floor(Math.random()*i.length)]);t[o].forEach(r=>{e[r].type=this.legendEncounter.id,e[r].isLegend=!0}),this.legendTargetType=this.legendEncounter.id,console.log(`âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ã‚’ãƒã‚¹ã«é…ç½®: ${this.legendEncounter.name}`)}}this.existingTypes=[...new Set(e.map(t=>t.type))],e.forEach(t=>{this.grid[t.row][t.col]={type:t.type,isEnd:!0,pathType:t.type,isLegend:t.isLegend}}),this.levelSnacks=e,this.paths={},this.trails={},this.existingTypes.forEach(t=>{this.paths[t]=[],this.trails[t]=[]}),this.drawing=!1,this.curType=null,this.lastCell=null}checkLegendEncounter(){var t;const e=p.selectedDogs||[],s=((t=p.equippedCostumes)==null?void 0:t.hat)||null;for(const i of Object.keys(he)){const o=he[i];if(v.isDogUnlocked(p,o.id))continue;let n=!1;if(o.requiredDogId!==null?n=e.includes(o.requiredDogId):o.requiredCostume!==null?n=s===o.requiredCostume:n=!0,!!n&&Math.random()<o.probability)return o}return null}createGrid(){const{width:e,height:s}=this.scale,t=M.TOP+60,i=M.BOTTOM+60,o=20,n=s-t-i-o,r=e-o*2,a=Math.min(r,n);this.cellSz=(a-H.CELL_PADDING*7)/6,this.gridX=(e-a)/2+H.CELL_PADDING,this.gridY=t+(n-a)/2+H.CELL_PADDING,this.cellCon=this.add.container(0,0),this.cells=[];for(let l=0;l<6;l++){this.cells[l]=[];for(let c=0;c<6;c++){const d=this.gridX+c*(this.cellSz+H.CELL_PADDING),u=this.gridY+l*(this.cellSz+H.CELL_PADDING),f=this.add.container(d,u),g=this.add.image(this.cellSz/2,this.cellSz/2,"masu");g.setDisplaySize(this.cellSz,this.cellSz);const m=this.add.graphics();f.add([g,m]),f.setData("fill",m),f.setData("bg",g),this.cells[l][c]=f,this.cellCon.add(f)}}this.trailCon=this.add.container(0,0),this.dogCon=this.add.container(0,0),this.dogIcons={},this.levelSnacks.forEach(l=>{const c=this.gridX+l.col*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,d=this.gridY+l.row*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,u=L.draw(this,c,d,l.type,this.cellSz*.4,"neutral");this.dogCon.add(u),this.dogIcons[`${l.row},${l.col}`]={container:u,type:l.type},he[l.type]&&this.addLegendarySparkle(u,this.cellSz*.4)})}addLegendarySparkle(e,s){const t=Math.max(8,s*.25);[{x:-s*.6,y:-s*.5},{x:s*.6,y:-s*.4},{x:-s*.5,y:s*.5},{x:s*.5,y:s*.6},{x:0,y:-s*.7}].forEach((o,n)=>{const r=this.add.text(o.x,o.y,"âœ¦",{fontSize:`${t}px`,color:"#FFD700"}).setOrigin(.5).setAlpha(0);e.add(r),this.tweens.add({targets:r,alpha:{from:0,to:1},scale:{from:.5,to:1.3},duration:800,delay:n*200,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})})}playEntryAnim(){for(let e=0;e<6;e++)for(let s=0;s<6;s++){const t=this.cells[e][s],i=t.y;t.y=i-40,t.alpha=0,this.tweens.add({targets:t,y:i,alpha:1,duration:250,delay:(e+s)*20,ease:"Back.easeOut"})}this.dogCon.list.forEach((e,s)=>{const t=e.scaleX;e.setScale(0),this.tweens.add({targets:e,scaleX:t,scaleY:t,duration:300,delay:280+s*35,ease:"Back.easeOut"})})}createUI(){var d,u,f;const{width:e,height:s}=this.scale,t=M.TOP+30,i=M.TOP+60,o=s-M.BOTTOM-37,n=s-M.BOTTOM-75,r=this.add.graphics();r.fillStyle(I.uiBg,1),r.fillRect(0,0,e,i),r.lineStyle(2,I.uiOutline,1),r.lineBetween(0,i,e,i),this.tutorialMode&&!((d=p.tutorial)!=null&&d.completed)||this.createBackBtn(48,t,()=>{this.mode==="challenge"?this.showConfirm():(this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("SelectScene")))});const l=this.mode==="challenge"?`ğŸ”¥ ã‚¹ãƒ†ãƒ¼ã‚¸ ${this.chalScore+1}`:`ğŸ¾ ã‚¹ãƒ†ãƒ¼ã‚¸ ${this.lvIndex+1}`;this.add.text(e/2,t,l,{...D.heading,fontSize:"22px"}).setOrigin(.5),this.progContainer=this.add.container(e/2,i+10),this.updateProgress();const c=this.add.graphics();c.fillStyle(I.uiBg,1),c.fillRect(0,n,e,s-n),c.lineStyle(2,I.uiOutline,1),c.lineBetween(0,n,e,n),this.createResetBtn(e/2,o,()=>this.resetLevel()),this.bgmBtn=this.createToggleButton(60,o,"icon_music",((u=p.settings)==null?void 0:u.bgmEnabled)!==!1,g=>{p.settings=p.settings||{},p.settings.bgmEnabled=g,_.setBgmEnabled(g),v.save(p)}),this.seBtn=this.createToggleButton(e-60,o,"icon_sound",((f=p.settings)==null?void 0:f.seEnabled)!==!1,g=>{p.settings=p.settings||{},p.settings.seEnabled=g,_.setSeEnabled(g),v.save(p)})}createBackBtn(e,s,t){const i=this.add.container(e,s),o=this.add.graphics();o.fillStyle(16777215,.95),o.fillRoundedRect(-38,-16,76,32,10),o.lineStyle(2.5,z[3].color,1),o.strokeRoundedRect(-38,-16,76,32,10);const n=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return i.add([o,n]),i.setSize(76,32),i.setInteractive({useHandCursor:!0}),i.on("pointerover",()=>this.tweens.add({targets:i,scale:1.08,duration:80})),i.on("pointerout",()=>this.tweens.add({targets:i,scale:1,duration:80})),i.on("pointerdown",()=>{this.tweens.add({targets:i,scale:.92,duration:40}),E.impact("Light")}),i.on("pointerup",()=>{this.tweens.add({targets:i,scale:1,duration:80}),_.playSfx(this,"sfx_ui_tap"),t()}),i}createResetBtn(e,s,t){const i=this.add.container(e,s),o=60,n=this.add.graphics();n.fillStyle(16777215,.95),n.fillRoundedRect(-o/2,-o/2,o,o,15),n.lineStyle(2,6710886,1),n.strokeRoundedRect(-o/2,-o/2,o,o,15);const r=this.add.image(0,0,"icon_refresh"),a=o*.6/Math.max(r.width,r.height);return r.setScale(a),i.add([n,r]),i.setSize(o,o),i.setInteractive({useHandCursor:!0}),i.on("pointerover",()=>this.tweens.add({targets:i,scale:1.1,duration:80})),i.on("pointerout",()=>this.tweens.add({targets:i,scale:1,duration:80})),i.on("pointerdown",()=>{this.tweens.add({targets:i,scale:.88,duration:40}),E.impact("Medium")}),i.on("pointerup",()=>{this.tweens.add({targets:r,rotation:-Math.PI*2,duration:300,ease:"Cubic.easeOut",onComplete:()=>{r.rotation=0}}),this.tweens.add({targets:i,scale:1,duration:80}),_.playSfx(this,"sfx_reset"),t()}),i}createToggleButton(e,s,t,i,o){const n=this.add.container(e,s),r=this.add.graphics(),a=d=>{r.clear(),r.fillStyle(d?5025616:8947848,1),r.fillRoundedRect(-30,-24,60,48,12),r.lineStyle(2,d?3046706:5592405,1),r.strokeRoundedRect(-30,-24,60,48,12)};a(i);const l=this.add.image(0,0,t),c=36/Math.max(l.width,l.height);return l.setScale(c),n.add([r,l]),n.setSize(60,48),n.setInteractive({useHandCursor:!0}),n.setData("on",i),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.08,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80})),n.on("pointerdown",()=>{this.tweens.add({targets:n,scale:.9,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),n.on("pointerup",()=>{this.tweens.add({targets:n,scale:1.1,duration:60,yoyo:!0});const d=!n.getData("on");n.setData("on",d),a(d),o(d)}),n}setupInput(){this.input.on("pointerdown",e=>this.onDown(e)),this.input.on("pointermove",e=>this.onMove(e)),this.input.on("pointerup",()=>this.onUp())}onDown(e){const s=this.getCell(e.x,e.y);if(!s)return;const{row:t,col:i}=s,o=this.grid[t][i];o.isEnd?(this.startDraw(o.type,t,i),this.showDog(e.x,e.y),E.impact("Light")):o.pathType>0&&(this.startFromPath(o.pathType,t,i),this.showDog(e.x,e.y),E.impact("Light"))}onMove(e){if(!this.drawing)return;const s=this.getCell(e.x,e.y);s&&this.continueDraw(s.row,s.col),this.dog&&this.dog.setPosition(e.x,e.y-55)}onUp(){if(this.mode==="challenge"&&this.drawing&&this.curType&&!this.pathComplete(this.curType)){this.cameras.main.shake(300,.02),this.cameras.main.flash(200,255,100,100),_.playSfx(this,"sfx_gameover"),this.time.delayedCall(500,()=>this.scene.start("GameOverScene",{score:this.chalScore}));return}this.drawing=!1,this.curType=null,this.lastCell=null,this.hideDog()}getCell(e,s){const t=this.cellSz*.15;for(let i=0;i<6;i++)for(let o=0;o<6;o++){const n=this.gridX+o*(this.cellSz+H.CELL_PADDING),r=this.gridY+i*(this.cellSz+H.CELL_PADDING),l=this.lastCell&&this.lastCell.row===i&&this.lastCell.col===o?t:0;if(e>=n-l&&e<=n+this.cellSz+l&&s>=r-l&&s<=r+this.cellSz+l)return{row:i,col:o}}return null}startDraw(e,s,t){this.clearPath(e),this.drawing=!0,this.curType=e,this.lastCell={row:s,col:t},this.paths[e].push({row:s,col:t}),_.playSfx(this,"sfx_draw_start");const i=`${s},${t}`;this.dogIcons[i]&&this.tweens.add({targets:this.dogIcons[i].container,scaleX:1.2,scaleY:.8,duration:80,yoyo:!0})}startFromPath(e,s,t){const i=this.paths[e],o=i.findIndex(n=>n.row===s&&n.col===t);o!==-1&&(i.splice(o+1).forEach(n=>{this.grid[n.row][n.col].isEnd||(this.grid[n.row][n.col].pathType=0)}),this.trails[e]=this.trails[e].slice(0,o),this.drawing=!0,this.curType=e,this.lastCell={row:s,col:t},this.renderPaths())}continueDraw(e,s){if(!this.drawing||!this.curType)return;const{row:t,col:i}=this.lastCell;if(e===t&&s===i||Math.abs(e-t)+Math.abs(s-i)!==1)return;const o=this.grid[e][s],n=this.paths[this.curType];if(n.length>=2){const r=n[n.length-2];if(r.row===e&&r.col===s){const a=n.pop();this.grid[a.row][a.col].isEnd||(this.grid[a.row][a.col].pathType=0),this.trails[this.curType].pop(),this.lastCell={row:e,col:s},this.updateProgress(),this.renderPaths();return}}if(o.pathType>0&&o.pathType!==this.curType){_.playSfx(this,"sfx_error");return}if(o.isEnd&&o.type===this.curType){if(n[0].row===e&&n[0].col===s)return;n.push({row:e,col:s}),this.addTrail(t,i,e,s),this.lastCell={row:e,col:s};const r=`${e},${s}`;this.dogIcons[r]&&this.tweens.add({targets:this.dogIcons[r].container,scale:1.3,duration:150,yoyo:!0,ease:"Back.easeOut"}),this.showConnectEffect(e,s),this.updateProgress(),this.renderPaths(),this.tutorialMode&&this.onTutorialPairConnected&&this.onTutorialPairConnected(),this.checkClear(),E.impact("Medium");return}if(o.pathType!==this.curType){if(o.isEnd&&o.type!==this.curType){_.playSfx(this,"sfx_error");return}n.push({row:e,col:s}),o.pathType=this.curType,this.addTrail(t,i,e,s),this.lastCell={row:e,col:s},this.updateProgress(),this.renderPaths(),E.selection(),_.playSfx(this,"sfx_draw_step")}}addTrail(e,s,t,i){const o=this.gridX+s*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,n=this.gridY+e*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,r=this.gridX+i*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,a=this.gridY+t*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,l=Math.atan2(a-n,r-o),c=this.trails[this.curType].length,d=c%2===0?-1:1,u=l+Math.PI/2,f=d*this.cellSz*.12;this.trails[this.curType].push({x:r+Math.cos(u)*f,y:a+Math.sin(u)*f,angle:l,stepNum:c,isNew:!0})}renderPaths(){var i;for(let o=0;o<6;o++)for(let n=0;n<6;n++){const r=this.cells[o][n].getData("fill"),a=this.grid[o][n].pathType;r.clear(),a>0&&z[a]&&(r.fillStyle(z[a].color,.5),r.fillRoundedRect(2,2,this.cellSz-4,this.cellSz-4,H.CORNER_RADIUS-2))}const e=((i=p.customize)==null?void 0:i.pawColor)||"brown",t=(ee[e]||ee.brown).imageKey||"paw_brown";this._pawColorLogged||(console.log("ğŸ¾ è‚‰çƒã‚«ãƒ©ãƒ¼è¨­å®š:",e,"â†’ ç”»åƒ:",t),this._pawColorLogged=!0),this.trailCon.removeAll(!0),this.existingTypes.forEach(o=>{const n=this.trails[o];!n||n.length===0||n.forEach((r,a)=>{const l=a>=n.length-2,c=a===n.length-1,d=c?this.cellSz*.7:l?this.cellSz*.6:this.cellSz*.5,u=oe.drawSprite(this,r.x,r.y,t,d);u.setOrigin(.5,.5);const f=r.stepNum%2===0?-.15:.15;u.setRotation(r.angle+Math.PI/2+f);const g=c?1:l?.85:.4+a/n.length*.35;if(u.setAlpha(g),r.isNew&&l){const m=u.scale;u.setScale(0),this.tweens.add({targets:u,scale:{from:0,to:m*1.15},duration:80,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:u,scale:m,duration:60,ease:"Sine.easeOut"})}}),r.isNew=!1}this.trailCon.add(u)})})}showConnectEffect(e,s){const t=this.gridX+s*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,i=this.gridY+e*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,o=this.grid[e][s],n=o.type===29;this.cameras.main.shake(120,n?.012:.008),_.playSfx(this,"sfx_connect"),E.notification("Success");const r=`${e},${s}`,a=this.dogIcons[r];if(a){a.container.destroy();const d=L.draw(this,t,i,a.type,this.cellSz*.4,"happy");this.dogCon.add(d),this.dogIcons[r].container=d,he[a.type]&&this.addLegendarySparkle(d,this.cellSz*.4),d.setScale(.8),this.tweens.add({targets:d,scale:1.4,duration:100,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:d,scale:1,duration:150,ease:"Sine.easeInOut"})}})}const l=this.findPairStartKey(e,s,o.type);if(l&&this.dogIcons[l]){const d=this.dogIcons[l],[u,f]=l.split(",").map(Number),g=this.gridX+f*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,m=this.gridY+u*(this.cellSz+H.CELL_PADDING)+this.cellSz/2;d.container.destroy();const y=L.draw(this,g,m,d.type,this.cellSz*.4,"happy");this.dogCon.add(y),this.dogIcons[l].container=y,he[d.type]&&this.addLegendarySparkle(y,this.cellSz*.4),this.tweens.add({targets:y,y:m-8,duration:80,yoyo:!0,repeat:1,ease:"Quad.easeOut"})}const c=this.add.text(t,i-30,"ã‚ã‚“ï¼",{...D.body,fontSize:n?"18px":"16px",color:n?"#FFD700":"#FF6B8A",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setScale(0);if(this.tweens.add({targets:c,scale:1.2,y:i-60,duration:150,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:c,alpha:0,y:i-80,scale:.8,duration:400,ease:"Cubic.easeIn",onComplete:()=>c.destroy()})}}),this.spawnConnectHearts(t,i,n),n){this.cameras.main.flash(300,255,215,0,!0);for(let u=0;u<12;u++){const f=u/12*Math.PI*2,g=this.add.text(t,i,"â­",{fontSize:"24px"}).setOrigin(.5).setScale(0);this.tweens.add({targets:g,x:t+Math.cos(f)*80,y:i+Math.sin(f)*80,scale:{from:0,to:1.5},alpha:{from:1,to:0},rotation:Math.PI*2,duration:700,delay:u*30,ease:"Cubic.easeOut",onComplete:()=>g.destroy()})}const d=this.add.text(t,i-70,"Lucky!",{...D.special,fontSize:"30px"}).setOrigin(.5).setScale(0);this.tweens.add({targets:d,scale:1.3,duration:200,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:d,alpha:0,y:i-100,scale:.8,duration:600,onComplete:()=>d.destroy()})}})}}spawnConnectHearts(e,s,t){const i=t?10:6,o=t?"ğŸ’›":"â¤ï¸";for(let n=0;n<i;n++){const r=n/i*Math.PI*2-Math.PI/2,a=t?60:45,l=this.add.text(e,s,o,{fontSize:t?"20px":"16px"}).setOrigin(.5).setScale(0).setAlpha(0);this.tweens.add({targets:l,x:e+Math.cos(r)*a,y:s+Math.sin(r)*a-15,scale:{from:0,to:1.3},alpha:{from:0,to:1},duration:200,delay:n*25,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:l,y:l.y-20,alpha:0,scale:.5,duration:350,ease:"Cubic.easeIn",onComplete:()=>l.destroy()})}})}}findPairStartKey(e,s,t){for(let i=0;i<6;i++)for(let o=0;o<6;o++)if((i!==e||o!==s)&&this.grid[i][o].isEnd&&this.grid[i][o].type===t)return`${i},${o}`;return null}clearPath(e){this.paths[e].forEach(s=>{this.grid[s.row][s.col].isEnd||(this.grid[s.row][s.col].pathType=0)}),this.paths[e]=[],this.trails[e]=[],this.renderPaths()}resetLevel(){this.existingTypes.forEach(e=>this.clearPath(e));for(let e=0;e<6;e++)for(let s=0;s<6;s++)this.grid[e][s].isEnd||(this.grid[e][s].pathType=0);Object.keys(this.dogIcons).forEach(e=>{const[s,t]=e.split(",").map(Number),i=this.gridX+t*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,o=this.gridY+s*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,n=this.dogIcons[e];if(n){n.container.destroy();const r=L.draw(this,i,o,n.type,this.cellSz*.4,"neutral");this.dogCon.add(r),this.dogIcons[e].container=r,he[n.type]&&this.addLegendarySparkle(r,this.cellSz*.4)}}),this.updateProgress(),this.renderPaths(),this.cameras.main.shake(100,.005)}showPawTrail(e,s){var a;const t=((a=p.customize)==null?void 0:a.pawColor)||"brown",o=(ee[t]||ee.brown).imageKey||"paw_brown",n=oe.drawSprite(this,e,s,o,28,.8);n.setOrigin(.5,.5),n.setRotation(w.Math.FloatBetween(-.3,.3));const r=n.scale;this.tweens.add({targets:n,alpha:0,scale:r*.5,duration:800,onComplete:()=>n.destroy()})}showDog(e,s){}hideDog(){}updateProgress(){var n;let e=0;for(let r=0;r<6;r++)for(let a=0;a<6;a++)this.grid[r][a].pathType>0&&e++;this.progContainer.removeAll(!0);const s=Math.floor(e/36*10),t=((n=p.customize)==null?void 0:n.pawColor)||"brown",o=(ee[t]||ee.brown).imageKey||"paw_brown";for(let r=0;r<s;r++){const a=oe.drawSprite(this,(r-4.5)*18,0,o,16);a.setOrigin(.5,.5),this.progContainer.add(a)}}pathComplete(e){const s=this.paths[e];if(!s||s.length<2)return!1;const t=[];for(let a=0;a<6;a++)for(let l=0;l<6;l++)this.grid[a][l].isEnd&&this.grid[a][l].type===e&&t.push({row:a,col:l});if(t.length!==2)return!1;const i=s[0],o=s[s.length-1],n=i.row===t[0].row&&i.col===t[0].col||i.row===t[1].row&&i.col===t[1].col,r=o.row===t[0].row&&o.col===t[0].col||o.row===t[1].row&&o.col===t[1].col;return n&&r&&(i.row!==o.row||i.col!==o.col)}checkClear(){var n;for(const r of this.existingTypes)if(!this.pathComplete(r))return!1;for(let r=0;r<6;r++)for(let a=0;a<6;a++)if(this.grid[r][a].pathType===0)return!1;if(console.log("ğŸ‰ ã‚¯ãƒªã‚¢ï¼"),E.notification("Success"),this.mode!=="challenge"){const r=this.lvIndex+1;Rt(r)}if(v.updateStats(p,"clear"),this.mode==="challenge"&&v.updateStats(p,"challenge_clear"),this.hasGolden&&v.updateStats(p,"golden"),this.legendEncounter&&!p.unlockedDogs.includes(this.legendEncounter.id)){p.unlockedDogs.push(this.legendEncounter.id);const r=new Date().toISOString().split("T")[0];p.dogUnlockDates[this.legendEncounter.id]=r,console.log(`âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ç²å¾—ï¼ ${this.legendEncounter.name}`)}p.selectedDogs.forEach(r=>{v.updateStats(p,"dog_usage",r)}),X.updateProgress(p,"clear"),this.mode==="challenge"&&X.updateProgress(p,"challenge"),this.hasGolden&&X.updateProgress(p,"golden");const e=(n=p.daily)==null?void 0:n.todaysDog;e&&p.selectedDogs.includes(e)&&X.updateProgress(p,"today_dog"),X.updateProgress(p,"perfect");const s=v.checkAchievements(p),t=v.checkNikukyuUnlocks(p),i=v.checkThemeUnlocks(p),o=[...t,...i];return v.save(p),this.cameras.main.flash(200,255,255,200),this.time.delayedCall(600,()=>{if(this.tutorialMode){this.scene.start("ClearScene",{mode:"tutorial",levelIndex:0,hasGolden:!1,newAchievements:s,newItemUnlocks:o,tutorialMode:!0});return}this.mode==="challenge"?this.legendEncounter?this.scene.start("LegendUnlockScene",{legendEncounter:this.legendEncounter,challengeScore:this.chalScore+1,newAchievements:s,newItemUnlocks:o}):this.scene.start("ClearScene",{mode:"challenge",challengeScore:this.chalScore+1,hasGolden:this.hasGolden,newAchievements:s,newItemUnlocks:o}):this.scene.start("ClearScene",{mode:"normal",levelIndex:this.lvIndex,hasGolden:this.hasGolden,newAchievements:s,newItemUnlocks:o})}),!0}showConfirm(){const{width:e,height:s}=this.scale,t=this.add.rectangle(0,0,e,s,0,.5).setOrigin(0).setInteractive(),i=this.add.container(e/2,s/2),o=260,n=150,r=this.add.graphics();r.fillStyle(I.uiBg,1),r.fillRoundedRect(-o/2,-n/2,o,n,16),r.lineStyle(3,I.cellOutline,1),r.strokeRoundedRect(-o/2,-n/2,o,n,16);const a=this.add.text(0,-35,"ã‚„ã‚ã¾ã™ã‹ï¼Ÿ",{...D.heading,fontSize:"20px"}).setOrigin(.5),l=this.add.container(-55,30),c=this.add.graphics();c.fillStyle(16739179,1),c.fillRoundedRect(-45,-22,90,44,10);const d=this.add.text(0,0,"ã¯ã„",{...D.button,fontSize:"18px"}).setOrigin(.5);l.add([c,d]),l.setSize(90,44).setInteractive({useHandCursor:!0});const u=this.add.container(55,30),f=this.add.graphics();f.fillStyle(8947848,1),f.fillRoundedRect(-45,-22,90,44,10);const g=this.add.text(0,0,"ã„ã„ãˆ",{...D.button,fontSize:"18px"}).setOrigin(.5);u.add([f,g]),u.setSize(90,44).setInteractive({useHandCursor:!0}),i.add([r,a,l,u]),l.on("pointerdown",()=>this.tweens.add({targets:l,scale:.9,duration:50})),l.on("pointerup",()=>{this.tweens.add({targets:l,scale:1,duration:50}),this.cameras.main.fadeOut(200),this.time.delayedCall(200,()=>this.scene.start("MainMenuScene"))}),l.on("pointerout",()=>this.tweens.add({targets:l,scale:1,duration:50})),u.on("pointerdown",()=>this.tweens.add({targets:u,scale:.9,duration:50})),u.on("pointerup",()=>{this.tweens.add({targets:u,scale:1,duration:50}),t.destroy(),i.destroy()}),u.on("pointerout",()=>this.tweens.add({targets:u,scale:1,duration:50}))}startTutorial(){this.tutorialStep=0,this.tutorialConnectedCount=0,this.showTutorialStep()}showTutorialStep(){const{width:e,height:s}=this.scale;this.tutorialStep===0&&this.showTutorialOverlay({text:"åŒã˜ãƒ¯ãƒ³ã‚³ã‚’ã¤ãªã”ã†ï¼",subText:"ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ç·šã‚’å¼•ã„ã¦ã­",highlightType:"dogs",waitForAction:!0})}onTutorialPairConnected(){if(!this.tutorialMode)return;this.tutorialConnectedCount++;const e=this.existingTypes.length;this.tutorialConnectedCount===1&&e>1?this.time.delayedCall(300,()=>{this.showTutorialOverlay({text:"ã„ã„ã­ï¼ãã®èª¿å­ï¼",subText:"æ®‹ã‚Šã®ãƒ¯ãƒ³ã‚³ã‚‚ã¤ãªã”ã†",highlightType:"none",waitForAction:!0})}):this.tutorialConnectedCount===2&&e>2?this.time.delayedCall(300,()=>{this.showTutorialOverlay({text:"ã¤ã¾ã£ãŸã‚‰ã“ã“ã‚’ã‚¿ãƒƒãƒ—ï¼",subText:"ã‚„ã‚ŠãªãŠã›ã‚‹ã‚ˆ",highlightType:"resetBtn",waitForAction:!0})}):this.tutorialConnectedCount===Math.floor(e/2)&&e>4&&this.tutorialConnectedCount>2&&this.time.delayedCall(300,()=>{this.showTutorialOverlay({text:"ã™ã”ã„ï¼ã‚ã¨å°‘ã—ï¼",subText:"å…¨éƒ¨ã®ãƒã‚¹ã‚’åŸ‹ã‚ã‚ˆã†",highlightType:"none",waitForAction:!0})})}showTutorialOverlay(e){const{width:s,height:t}=this.scale;this.hideTutorialOverlay(),this.tutorialContainer=this.add.container(0,0).setDepth(1e3);const i=this.add.graphics();i.fillStyle(0,.7),i.fillRect(0,0,s,t),this.tutorialContainer.add(i),e.highlightType==="dogs"?this.highlightDogs(i):e.highlightType==="grid"?this.highlightGrid(i):e.highlightType==="resetBtn"&&this.highlightResetBtn(i);const o=t*.75,n=this.add.graphics();n.fillStyle(16777215,.95),n.fillRoundedRect(30,o-50,s-60,120,16),this.tutorialContainer.add(n);const r=this.add.text(s/2,o-15,e.text,{fontFamily:"KeiFont, sans-serif",fontSize:"26px",color:"#5D4037",fontStyle:"bold"}).setOrigin(.5);this.tutorialContainer.add(r);const a=this.add.text(s/2,o+20,e.subText,{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#8D6E63"}).setOrigin(.5);this.tutorialContainer.add(a);const l=this.add.text(s/2,o+55,"â–¼ ã‚¿ãƒƒãƒ—ã—ã¦ã¯ã˜ã‚ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#A1887F"}).setOrigin(.5);this.tutorialContainer.add(l),this.tweens.add({targets:l,alpha:{from:1,to:.4},duration:600,yoyo:!0,repeat:-1});const c=this.add.rectangle(s/2,t/2,s,t,0,0).setInteractive({useHandCursor:!0});this.tutorialContainer.add(c),c.on("pointerdown",()=>{E.selection(),_.playSfx(this,"sfx_ui_tap"),this.hideTutorialOverlay(),this.tutorialStep++,e.onClose&&e.onClose()})}highlightDogs(e){if(this.levelSnacks.length>=2){const s=this.levelSnacks[0].type;this.levelSnacks.filter(i=>i.type===s).forEach(i=>{const o=this.gridX+i.col*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,n=this.gridY+i.row*(this.cellSz+H.CELL_PADDING)+this.cellSz/2,r=this.cellSz*.6,a=this.add.graphics();a.fillStyle(16777215,.3),a.fillCircle(o,n,r+10),this.tutorialContainer.add(a),this.tweens.add({targets:a,alpha:{from:.3,to:.6},scaleX:{from:1,to:1.1},scaleY:{from:1,to:1.1},duration:500,yoyo:!0,repeat:-1})})}}highlightGrid(e){const s=6*(this.cellSz+H.CELL_PADDING),t=6*(this.cellSz+H.CELL_PADDING),i=this.add.graphics();i.lineStyle(4,16766287,1),i.strokeRoundedRect(this.gridX-5,this.gridY-5,s+5,t+5,10),this.tutorialContainer.add(i),this.tweens.add({targets:i,alpha:{from:1,to:.5},duration:600,yoyo:!0,repeat:-1})}highlightResetBtn(e){const{width:s,height:t}=this.scale,i=t-M.BOTTOM-37,o=s/2,n=60,r=this.add.graphics();r.fillStyle(16766287,.4),r.fillCircle(o,i,n/2+15),this.tutorialContainer.add(r),this.tweens.add({targets:r,alpha:{from:.4,to:.8},scaleX:{from:1,to:1.2},scaleY:{from:1,to:1.2},duration:500,yoyo:!0,repeat:-1});const a=i-n/2-40,l=this.add.text(o,a,"â–¼",{fontFamily:"KeiFont, sans-serif",fontSize:"32px",color:"#FFD54F"}).setOrigin(.5);this.tutorialContainer.add(l),this.tweens.add({targets:l,y:a+10,duration:400,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}hideTutorialOverlay(){this.tutorialContainer&&(this.tutorialContainer.destroy(),this.tutorialContainer=null)}}class Lt extends w.Scene{constructor(){super({key:"AchievementUnlockScene"})}init(e){this.newAchievements=e.newAchievements||[],this.tutorialMode=e.tutorialMode||!1,this.currentIndex=0,this.newItemUnlocks=e.newItemUnlocks||[]}create(){const{width:e,height:s}=this.scale;this.createBackground(),this.newAchievements.length>0?this.showUnlockAnimation():this.goToNext(),this.cameras.main.fadeIn(400)}createBackground(){const{width:e,height:s}=this.scale,t=this.add.graphics();t.fillGradientStyle(16775393,16775393,16769202,16769202,1),t.fillRect(0,0,e,s),this.createSparkles()}createSparkles(){const{width:e,height:s}=this.scale;for(let t=0;t<20;t++){const i=w.Math.Between(20,e-20),o=w.Math.Between(20,s-20),n=w.Math.Between(14,24),r=this.add.text(i,o,"âœ¨",{fontSize:`${n}px`}).setOrigin(.5).setAlpha(.3);this.tweens.add({targets:r,alpha:{from:.3,to:1},scale:{from:.8,to:1.2},duration:w.Math.Between(400,800),yoyo:!0,repeat:-1,delay:w.Math.Between(0,500)})}}showUnlockAnimation(){const{width:e,height:s}=this.scale,t=this.newAchievements[this.currentIndex];if(!t){this.goToNext();return}_.playSfx(this,"sfx_unlock_item"),E.notification("Success");const i=this.add.container(e/2,s/2),o=this.add.text(0,-180,"ã‚„ã£ãŸï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"36px",color:"#FF6F00",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);i.add(o),this.tweens.add({targets:o,y:-190,duration:300,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"});const n=t.dogId,r=this.add.graphics();r.fillStyle(16777215,1),r.fillCircle(0,-30,90),r.lineStyle(6,16757504,1),r.strokeCircle(0,-30,90),i.add(r);const a=L.draw(this,0,-30,n,70,"happy");i.add(a);const l=Se[n],c=l?l.name:`ãƒ¯ãƒ³ã‚³ #${n}`,d=this.add.text(0,70,`${c}ã‚’
ã‚²ãƒƒãƒˆï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);i.add(d),i.setScale(0),this.tweens.add({targets:i,scale:1,duration:500,ease:"Back.out"}),this.time.delayedCall(800,()=>{this.createNextButton()})}createNextButton(){const{width:e,height:s}=this.scale,t=200,i=60,o=s-M.BOTTOM-80,n=this.add.container(e/2,o),r=this.add.graphics();r.fillStyle(16748288,1),r.fillRoundedRect(-t/2,-i/2,t,i,i/2),r.lineStyle(3,16757504,1),r.strokeRoundedRect(-t/2,-i/2,t,i,i/2),n.add(r);const a=this.add.text(0,0,"ã¤ãã¸",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);n.add(a),n.setSize(t,i),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.05,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80})),n.on("pointerdown",()=>{this.tweens.add({targets:n,scale:.95,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),n.on("pointerup",()=>{this.currentIndex++,this.currentIndex<this.newAchievements.length?this.scene.restart({newAchievements:this.newAchievements,tutorialMode:this.tutorialMode,currentIndex:this.currentIndex}):this.goToNext()}),n.setAlpha(0),n.y=o+30,this.tweens.add({targets:n,alpha:1,y:o,duration:300,ease:"Back.out"})}goToNext(){this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{if(this.newItemUnlocks&&this.newItemUnlocks.length>0){this.scene.start("ItemUnlockScene",{unlocks:this.newItemUnlocks,returnScene:"MainMenuScene",returnData:this.tutorialMode&&!p.tutorial.completed?{tutorialMode:!0}:{}});return}this.tutorialMode&&!p.tutorial.completed?this.scene.start("MainMenuScene",{tutorialMode:!0}):this.scene.start("MainMenuScene")})}}class Ut extends w.Scene{constructor(){super({key:"ItemUnlockScene"})}init(e){this.unlocks=e.unlocks||[],this.currentIndex=e.currentIndex||0,this.returnScene=e.returnScene||"MainMenuScene",this.returnData=e.returnData||{}}create(){const{width:e,height:s}=this.scale;this.createBackground(),this.unlocks.length>0&&this.currentIndex<this.unlocks.length?this.showUnlockAnimation():this.goToNext(),this.cameras.main.fadeIn(400)}createBackground(){const{width:e,height:s}=this.scale,t=this.add.graphics();t.fillGradientStyle(16775393,16775393,16769202,16769202,1),t.fillRect(0,0,e,s),this.createSparkles()}createSparkles(){const{width:e,height:s}=this.scale;for(let t=0;t<25;t++){const i=w.Math.Between(20,e-20),o=w.Math.Between(20,s-20),n=w.Math.Between(14,28),r=this.add.text(i,o,"âœ¨",{fontSize:`${n}px`}).setOrigin(.5).setAlpha(.3);this.tweens.add({targets:r,alpha:{from:.3,to:1},scale:{from:.8,to:1.2},duration:w.Math.Between(400,800),yoyo:!0,repeat:-1,delay:w.Math.Between(0,500)})}}showUnlockAnimation(){const{width:e,height:s}=this.scale,t=this.unlocks[this.currentIndex];if(!t){this.goToNext();return}_.playSfx(this,"sfx_unlock_item"),E.notification("Success");const i=this.add.container(e/2,s/2-30);switch(t.type){case"dog":this.showDogUnlock(i,t);break;case"costume":this.showCostumeUnlock(i,t);break;case"nikukyu":this.showNikukyuUnlock(i,t);break;case"theme":this.showThemeUnlock(i,t);break;default:this.goToNext();return}i.setScale(0),this.tweens.add({targets:i,scale:1,duration:600,ease:"Back.out"}),this.time.delayedCall(1e3,()=>{this.createNextButton()})}showDogUnlock(e,s){const t=s.dogId,i=Se[t],o=i?i.name:`ãƒ¯ãƒ³ã‚³ #${t}`,n=this.add.text(0,-170,"ã‚„ã£ãŸï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"36px",color:"#FF6F00",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);e.add(n),this.addBounceAnimation(n);const r=this.add.graphics();r.fillStyle(16777215,1),r.fillCircle(0,-30,90),r.lineStyle(6,16757504,1),r.strokeCircle(0,-30,90),e.add(r);const a=L.draw(this,0,-30,t,70,"happy");e.add(a);const l=this.add.text(0,80,`${o}ã‚’
ã‚²ãƒƒãƒˆï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);e.add(l)}showCostumeUnlock(e,s){const t=s.name||"ãã›ã‹ãˆ",i=s.icon||"ğŸ€",o=this.add.text(0,-170,"ã‚²ãƒƒãƒˆï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"36px",color:"#E91E63",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);e.add(o),this.addBounceAnimation(o);const n=this.add.graphics();if(n.fillStyle(16777215,1),n.fillCircle(0,-30,80),n.lineStyle(5,15277667,1),n.strokeCircle(0,-30,80),e.add(n),s.imageKey&&this.textures.exists(s.imageKey)){const l=this.add.image(0,-30,s.imageKey);l.setScale(.5),e.add(l)}else{const l=this.add.text(0,-30,i,{fontSize:"60px"}).setOrigin(.5);e.add(l)}const r=this.add.text(0,70,`${t}`,{fontFamily:"KeiFont, sans-serif",fontSize:"26px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);e.add(r);const a=this.add.text(0,105,s.description||"ã‚ãŸã‚‰ã—ã„ãã›ã‹ãˆï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#8D6E63",align:"center"}).setOrigin(.5);e.add(a)}showNikukyuUnlock(e,s){var d;const t=s.name||"ã‚«ãƒ©ãƒ¼",i=s.color==="rainbow"?16738740:s.color,o=this.add.text(0,-170,"NEWï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"36px",color:"#FF5722",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);e.add(o),this.addBounceAnimation(o);const n=this.add.graphics();n.fillStyle(16777215,1),n.fillCircle(0,-30,80),n.lineStyle(5,i,1),n.strokeCircle(0,-30,80),e.add(n);const r=((d=ee[s.key])==null?void 0:d.imageKey)||"paw_brown",a=oe.drawSprite(this,0,-30,r,130);a.setOrigin(.5,.5),s.color==="rainbow"&&this.tweens.add({targets:a,angle:{from:-5,to:5},duration:300,yoyo:!0,repeat:-1}),e.add(a);const l=this.add.text(0,70,`ã«ããã‚…ã†ã‚«ãƒ©ãƒ¼
ã€Œ${t}ã€`,{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);e.add(l);const c=this.add.text(0,125,"ãã›ã‹ãˆã§è¨­å®šã§ãã‚‹ã‚ˆï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#8D6E63",align:"center"}).setOrigin(.5);e.add(c)}showThemeUnlock(e,s){const t=s.name||"ãƒ†ãƒ¼ãƒ",i=s.icon||"ğŸŒ",o=this.add.text(0,-180,"ã‹ã„ã»ã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"36px",color:"#2196F3",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);e.add(o),this.addBounceAnimation(o);const{width:n,height:r}=this.scale,a=n/2,l=r/2-30,c=this.make.graphics({add:!1});c.fillStyle(16777215),c.fillRoundedRect(a-90,l-80,180,100,12);const d=c.createGeometryMask(),u=this.add.graphics();if(u.fillStyle(s.sky||8900331,1),u.fillRoundedRect(-90,-80,180,100,12),u.fillStyle(s.ground||9498256,1),u.fillRect(-90,-20,180,40),u.setMask(d),e.add(u),s.image&&this.textures.exists(s.image)){const S=this.add.image(0,-30,s.image);S.setDisplaySize(180,100),S.setMask(d),e.add(S)}const f=this.add.graphics();f.lineStyle(4,16777215,1),f.strokeRoundedRect(-90,-80,180,100,12),e.add(f);const g=this.add.text(0,-30,i,{fontSize:"32px"}).setOrigin(.5);e.add(g);const m=this.add.text(0,55,`ã›ã‹ã„ã®ãƒ†ãƒ¼ãƒ
ã€Œ${t}ã€`,{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);e.add(m);const y=this.add.text(0,115,"ãã›ã‹ãˆã§è¨­å®šã§ãã‚‹ã‚ˆï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#8D6E63",align:"center"}).setOrigin(.5);e.add(y)}addBounceAnimation(e){this.tweens.add({targets:e,y:e.y-10,duration:300,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}createNextButton(){const{width:e,height:s}=this.scale,t=200,i=60,o=s-M.BOTTOM-80,n=this.add.container(e/2,o),r=this.add.graphics();r.fillStyle(16748288,1),r.fillRoundedRect(-t/2,-i/2,t,i,i/2),r.lineStyle(3,16757504,1),r.strokeRoundedRect(-t/2,-i/2,t,i,i/2),n.add(r);const l=this.currentIndex>=this.unlocks.length-1?"OKï¼":"ã¤ãã¸",c=this.add.text(0,0,l,{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);n.add(c),n.setSize(t,i),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>this.tweens.add({targets:n,scale:1.05,duration:80})),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80})),n.on("pointerdown",()=>{this.tweens.add({targets:n,scale:.95,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),n.on("pointerup",()=>{this.currentIndex++,this.currentIndex<this.unlocks.length?this.scene.restart({unlocks:this.unlocks,currentIndex:this.currentIndex,returnScene:this.returnScene,returnData:this.returnData}):this.goToNext()}),n.setAlpha(0),n.y=o+30,this.tweens.add({targets:n,alpha:1,y:o,duration:300,ease:"Back.out"})}goToNext(){this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{this.scene.start(this.returnScene,this.returnData)})}}class Ht extends w.Scene{constructor(){super({key:"LegendUnlockScene"})}init(e){this.legendEncounter=e.legendEncounter,this.challengeScore=e.challengeScore||1,this.newAchievements=e.newAchievements||[],this.newItemUnlocks=e.newItemUnlocks||[]}create(){const{width:e,height:s}=this.scale;this.add.rectangle(0,0,e,s,1706544).setOrigin(0),this.createSparkleBackground();const t=this.add.container(e/2,s/2),i=this.add.text(0,-s*.35,"âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ âœ¨",{fontFamily:"KeiFont",fontSize:"28px",color:"#FFD700",stroke:"#000",strokeThickness:4}).setOrigin(.5);t.add(i);const o=this.legendEncounter.id,n=Se[o];if(n&&n.hasImage){const l=`dog_${o}_excited`;if(this.textures.exists(l)){const c=this.add.image(0,-s*.1,l).setOrigin(.5).setScale(0);t.add(c),this.tweens.add({targets:c,scale:.4,duration:800,ease:"Back.easeOut",delay:300}),this.tweens.add({targets:c,y:c.y-10,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:1100})}else{const c=this.add.text(0,-s*.1,"ğŸ•",{fontSize:"120px"}).setOrigin(.5);t.add(c)}}const r=this.add.text(0,s*.12,this.legendEncounter.unlockMessage,{fontFamily:"KeiFont",fontSize:"32px",color:"#FFFFFF",stroke:"#8B0000",strokeThickness:4,align:"center"}).setOrigin(.5).setAlpha(0);t.add(r),this.tweens.add({targets:r,alpha:1,duration:500,delay:800});const a=this.add.text(0,s*.22,`ã€${this.legendEncounter.name}ã€‘`,{fontFamily:"KeiFont",fontSize:"24px",color:"#FFD700",stroke:"#000",strokeThickness:3}).setOrigin(.5).setAlpha(0);t.add(a),this.tweens.add({targets:a,alpha:1,duration:500,delay:1e3}),this.time.delayedCall(1500,()=>{const l=this.add.container(0,s*.35),c=this.add.graphics();c.fillStyle(16766720,1),c.fillRoundedRect(-80,-25,160,50,25),c.lineStyle(3,16753920,1),c.strokeRoundedRect(-80,-25,160,50,25),l.add(c);const d=this.add.text(0,0,"OK",{fontFamily:"KeiFont",fontSize:"24px",color:"#000000"}).setOrigin(.5);l.add(d),l.setSize(160,50),l.setInteractive({useHandCursor:!0}),l.on("pointerdown",()=>{_.playSfx(this,"sfx_decide"),this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{this.scene.start("GameScene",{mode:"challenge",levelIndex:0,challengeScore:this.challengeScore})})}),t.add(l),l.setScale(0),this.tweens.add({targets:l,scale:1,duration:300,ease:"Back.easeOut"})}),_.playSfx(this,"sfx_achievement")}createSparkleBackground(){const{width:e,height:s}=this.scale;for(let t=0;t<50;t++){const i=this.add.text(w.Math.Between(0,e),w.Math.Between(0,s),"âœ¨",{fontSize:w.Math.Between(10,25)+"px"}).setOrigin(.5).setAlpha(w.Math.FloatBetween(.3,.8));this.tweens.add({targets:i,alpha:w.Math.FloatBetween(.1,.5),duration:w.Math.Between(1e3,2e3),yoyo:!0,repeat:-1,delay:w.Math.Between(0,1e3)})}}}class Kt extends w.Scene{constructor(){super({key:"ClearScene"})}init(e){this.mode=e.mode||"normal",this.lvIndex=e.levelIndex||0,this.chalScore=e.challengeScore||0,this.tutorialMode=e.tutorialMode||!1,this.newAchievements=e.newAchievements||[],this.newItemUnlocks=e.newItemUnlocks||[]}create(){const{width:e,height:s}=this.scale;_.playSfx(this,"sfx_clear"),this.cameras.main.flash(300,255,255,255),E.notification("Success"),this.add.rectangle(0,0,e,s,I.sky).setOrigin(0);const t=this.add.graphics();t.fillStyle(I.grass,1),t.fillRect(0,s*.6,e,s*.4),this.createConfetti(),this.createSparkles(),this.mode==="challenge"?this.createChallengeClear():this.createNormalClear()}createConfetti(){var n;const{width:e,height:s}=this.scale,t=p.selectedDogs,i=40,o=["rect","circle","star"];for(let r=0;r<i;r++){const a=w.Math.Between(10,e-10),l=t[w.Math.Between(0,t.length-1)],c=((n=z[l])==null?void 0:n.color)||16766720,d=o[w.Math.Between(0,o.length-1)],u=this.add.graphics();if(u.fillStyle(c,1),d==="rect"){const f=w.Math.Between(6,12),g=w.Math.Between(4,8);u.fillRect(-f/2,-g/2,f,g)}else if(d==="circle")u.fillCircle(0,0,w.Math.Between(3,6));else{const f=w.Math.Between(4,8);u.fillRect(-f/2,-1,f,2),u.fillRect(-1,-f/2,2,f)}u.x=a,u.y=-w.Math.Between(20,80),this.tweens.add({targets:u,y:s+30,x:a+w.Math.Between(-80,80),rotation:w.Math.Between(-8,8),duration:w.Math.Between(2e3,4e3),delay:w.Math.Between(0,800),ease:"Sine.easeInOut",onComplete:()=>u.destroy()})}}createSparkles(){const{width:e,height:s}=this.scale;for(let t=0;t<3;t++)this.time.delayedCall(t*1e3,()=>{for(let i=0;i<8;i++){const o=this.add.text(w.Math.Between(30,e-30),w.Math.Between(s*.1,s*.5),"âœ¨",{fontSize:w.Math.Between(12,20)+"px"}).setOrigin(.5).setAlpha(0);this.tweens.add({targets:o,alpha:{from:0,to:1},scale:{from:.5,to:1.2},duration:400,delay:i*80,yoyo:!0,onComplete:()=>o.destroy()})}})}createNormalClear(){const{width:e,height:s}=this.scale,t=p.selectedDogs;this.dogContainers=[];const i=s*.32;t.forEach((r,a)=>{const l=e*(.15+a*.235),c=L.draw(this,l,i,r,22,"excited");c.setScale(0),this.dogContainers.push(c),this.tweens.add({targets:c,scale:{from:0,to:1.2},duration:300,delay:a*120,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:c,scale:1,duration:150,ease:"Sine.easeOut"})}}),this.tweens.add({targets:c,y:i-12,duration:400+a*30,delay:600,yoyo:!0,repeat:-1,ease:"Quad.easeOut"}),this.time.delayedCall(400+a*120,()=>{const d=this.add.text(l,i-25,"â™¥",{fontSize:"14px",color:"#FF6B8A"}).setOrigin(.5).setScale(0);this.tweens.add({targets:d,y:i-45,scale:{from:0,to:1},alpha:{from:1,to:0},duration:600,ease:"Cubic.easeOut",onComplete:()=>d.destroy()})})});for(let r=0;r<3;r++)this.time.delayedCall(500+r*150,()=>{const a=this.add.text(e/2+(r-1)*55,s*.15,"â¤ï¸",{fontSize:"40px"}).setOrigin(.5).setScale(0);this.tweens.add({targets:a,scale:{from:0,to:1.3},duration:250,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:a,scale:1,duration:150}),this.tweens.add({targets:a,y:a.y-8,duration:800+r*100,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}})});const o=this.add.text(e/2,s*.5,"ã‚„ã£ãŸãƒ¼ï¼",{...D.title,fontSize:"40px"}).setOrigin(.5).setScale(0);this.tweens.add({targets:o,scale:{from:0,to:1.15},duration:350,delay:300,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:o,scale:1,duration:150})}});const n=this.add.text(e/2,s*.59,"ãŠã•ã‚“ã½ ãŸã®ã—ã‹ã£ãŸã­ï¼",{...D.section,fontSize:"16px"}).setOrigin(.5).setAlpha(0);this.tweens.add({targets:n,alpha:1,y:n.y-5,duration:400,delay:600,ease:"Cubic.easeOut"}),this.time.delayedCall(700,()=>{const r=Ce.createShareButton(this,e/2,s*.7,"normal",this.lvIndex);r.setScale(0),this.tweens.add({targets:r,scale:1,duration:300,ease:"Back.easeOut"});const a=this.createButton(e/2,s*.82,"ã¤ãã¸ï¼",z[2].color,async()=>{E.impact("Light");try{await ie.onStageEnd()}catch(l){console.log("åºƒå‘Šè¡¨ç¤ºã‚¹ã‚­ãƒƒãƒ—:",l.message)}this.cameras.main.fadeOut(200),this.time.delayedCall(200,()=>{const l={mode:"normal",levelIndex:(this.lvIndex+1)%G.length};this.tutorialMode&&!p.tutorial.completed?this.scene.start("AchievementUnlockScene",{newAchievements:this.newAchievements,newItemUnlocks:this.newItemUnlocks,tutorialMode:!0}):this.newAchievements&&this.newAchievements.length>0?this.scene.start("AchievementUnlockScene",{newAchievements:this.newAchievements,newItemUnlocks:this.newItemUnlocks,tutorialMode:!1}):this.newItemUnlocks&&this.newItemUnlocks.length>0?this.scene.start("ItemUnlockScene",{unlocks:this.newItemUnlocks,returnScene:"GameScene",returnData:l}):this.scene.start("GameScene",l)})});a.setScale(0),this.tweens.add({targets:a,scale:1,duration:300,delay:80,ease:"Back.easeOut"})})}createChallengeClear(){const{width:e,height:s}=this.scale,t=p.selectedDogs,i=this.add.text(e/2,s*.25,this.chalScore.toString(),{...D.score,fontSize:"72px"}).setOrigin(.5).setScale(0);this.tweens.add({targets:i,scale:1,duration:400,ease:"Back.easeOut"});const o=s*.48;t.forEach((r,a)=>{const l=e*(.15+a*.235),c=L.draw(this,l,o,r,18,"excited");this.tweens.add({targets:c,y:o-5,duration:400+a*40,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:a*80})}),this.add.text(e/2,s*.62,"ã¤ãã®ã‚¹ãƒ†ãƒ¼ã‚¸ã¸ï¼",{...D.heading,fontSize:"18px"}).setOrigin(.5);const n=Ce.createShareButton(this,e/2,s*.75,"challenge",this.chalScore);n.setScale(.8),n.setAlpha(.85),this.time.delayedCall(1800,async()=>{try{await ie.onStageClear()}catch(a){console.log("åºƒå‘Šè¡¨ç¤ºã‚¹ã‚­ãƒƒãƒ—:",a.message)}const r={mode:"challenge",challengeScore:this.chalScore};this.newItemUnlocks&&this.newItemUnlocks.length>0?this.scene.start("ItemUnlockScene",{unlocks:this.newItemUnlocks,returnScene:"GameScene",returnData:r}):this.newAchievements&&this.newAchievements.length>0?this.scene.start("AchievementUnlockScene",{newAchievements:this.newAchievements,newItemUnlocks:[],tutorialMode:!1}):this.scene.start("GameScene",r)})}createButton(e,s,t,i,o){const n=this.add.container(e,s),r=this.add.graphics();r.fillStyle(i,1),r.fillRoundedRect(-70,-20,140,40,8),r.lineStyle(2,I.cellOutline,1),r.strokeRoundedRect(-70,-20,140,40,8);const a=this.add.text(0,0,t,{...D.buttonSmall,fontSize:"18px"}).setOrigin(.5);return n.add([r,a]),n.setSize(140,40),n.setInteractive({useHandCursor:!0}),n.on("pointerup",o),n}}class $t extends w.Scene{constructor(){super({key:"GameOverScene"})}init(e){this.score=e.score||0,v.updateStats(p,"challenge_reset")}create(){const{width:e,height:s}=this.scale,t=p.selectedDogs;_.stopBgm(0),this.add.rectangle(0,0,e,s,4871528,.95).setOrigin(0);const i=s*.22;t.forEach((c,d)=>{const u=e*(.15+d*.235),f=L.draw(this,u,i,c,18,"sad");this.tweens.add({targets:f,y:i-5,duration:600+d*50,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:d*100})});const o=this.add.text(e/2,s*.38,"ã¾ãŸã‚ãã¼ï¼",{...D.heading,fontSize:"28px",color:"#FFFFFF",stroke:"#00000066",strokeThickness:4}).setOrigin(.5).setScale(0);this.tweens.add({targets:o,scale:1,duration:400,ease:"Back.easeOut"}),this.add.text(e/2,s*.48,"ãŠã•ã‚“ã½ã§ããŸã‹ãš",{...D.small,fontSize:"13px",color:"#CCCCCC"}).setOrigin(.5);const n=this.add.text(e/2,s*.56,this.score.toString(),{...D.score,fontSize:"56px"}).setOrigin(.5).setScale(0);this.tweens.add({targets:n,scale:1,duration:400,delay:200,ease:"Back.easeOut"});const r=p.stats.challengeHighScore||0,a=this.score>r;if(a){const c=this.add.text(e/2,s*.68,"ğŸ‰ ã‚ãŸã‚‰ã—ã„ãã‚ãï¼",{fontSize:"20px",fontFamily:"KeiFont, sans-serif",color:"#FFD700",stroke:"#000000",strokeThickness:3}).setOrigin(.5).setScale(0);this.tweens.add({targets:c,scale:1.1,duration:400,delay:400,ease:"Back.easeOut",yoyo:!0,repeat:2}),E.notification("Success")}else this.add.text(e/2,s*.68,"ã‚ã‚“ã“ãŒã¾ã£ã¦ã‚‹ã‚ˆï¼",{fontSize:"14px",fontFamily:"KeiFont, sans-serif",color:"#AAAAAA",stroke:"#00000044",strokeThickness:2}).setOrigin(.5);this.add.text(e/2,s*.76,`ğŸ† ãƒ™ã‚¹ãƒˆ: ${Math.max(r,this.score)}`,{fontSize:"15px",fontFamily:"KeiFont, sans-serif",color:"#FFD700",stroke:"#00000066",strokeThickness:2}).setOrigin(.5),this.time.delayedCall(300,()=>{const c=Ce.createShareButton(this,e/2,s*.84,"gameover",this.score,a);c.setScale(0),this.tweens.add({targets:c,scale:1,duration:300,ease:"Back.easeOut"})}),this.time.delayedCall(400,()=>{const c=this.createButton(e/2,s*.92,"ã‚‚ã†ã„ã£ã‹ã„ï¼",z[1].color,async()=>{E.impact("Light");try{await ie.onStageEnd()}catch(d){console.log("åºƒå‘Šè¡¨ç¤ºã‚¹ã‚­ãƒƒãƒ—:",d.message)}this.cameras.main.fadeOut(200),this.time.delayedCall(200,()=>{this.scene.start("GameScene",{mode:"challenge"})})});c.setScale(0),this.tweens.add({targets:c,scale:1,duration:300,ease:"Back.easeOut",onComplete:()=>{this.tweens.add({targets:c,scale:1.05,duration:500,yoyo:!0,repeat:2,ease:"Sine.easeInOut"})}})}),this.add.text(e/2,s-M.BOTTOM-20,"ãŠã†ã¡ã«ã‹ãˆã‚‹ï¼",{fontSize:"12px",fontFamily:"KeiFont, sans-serif",color:"#888888",stroke:"#00000033",strokeThickness:1}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerup",()=>{this.cameras.main.fadeOut(200),this.time.delayedCall(200,()=>this.scene.start("MainMenuScene"))})}createButton(e,s,t,i,o){const n=this.add.container(e,s),r=150,a=48,l=this.add.graphics();l.fillStyle(i,1),l.fillRoundedRect(-r/2,-a/2,r,a,12),l.lineStyle(2,16777215,.5),l.strokeRoundedRect(-r/2,-a/2,r,a,12);const c=this.add.text(0,0,t,{...D.button,fontSize:"18px"}).setOrigin(.5);return n.add([l,c]),n.setSize(r,a),n.setInteractive({useHandCursor:!0}),n.on("pointerdown",()=>{this.tweens.add({targets:n,scale:.92,duration:40}),E.impact("Light")}),n.on("pointerup",()=>{this.tweens.add({targets:n,scale:1.05,duration:80,yoyo:!0}),o()}),n.on("pointerout",()=>{this.tweens.add({targets:n,scale:1,duration:80})}),n}}class Nt extends w.Scene{constructor(){super({key:"ShopScene"})}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select");const t=this.add.image(e/2,s/2,"shop_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n).setDepth(0),this.createHeader(),this.createProducts(),this.cameras.main.fadeIn(300)}createHeader(){const{width:e}=this.scale,s=M.TOP;this.createBackButton(50,s+32),this.add.text(e/2,s+32,"ğŸ›’ ã‚·ãƒ§ãƒƒãƒ—",{...D.heading,fontSize:"22px"}).setOrigin(.5).setDepth(101),this.createRestoreButton(e-60,s+32)}createRestoreButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-40,-14,80,28,8),i.lineStyle(2,5025616,1),i.strokeRoundedRect(-40,-14,80,28,8);const o=this.add.text(0,0,"ğŸ”„ å¾©å…ƒ",{fontFamily:"KeiFont, sans-serif",fontSize:"12px",fontStyle:"bold",color:"#4CAF50"}).setOrigin(.5);return t.add([i,o]),t.setSize(80,28),t.setInteractive({useHandCursor:!0}),t.setDepth(101),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>this.restorePurchases()),t}async restorePurchases(){const{width:e,height:s}=this.scale,t=this.add.text(e/2,s/2,"å¾©å…ƒã¡ã‚…ã†...",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setDepth(400);try{const i=await K.restorePurchases();if(t.destroy(),i.success&&i.restored.length>0){E.notification("Success"),_.playSfx(this,"sfx_achievement"),K.isAdsRemoved&&K.isAdsRemoved()&&(p.purchases.adFree=!0,ie.removeAds()),K.hasPremiumDogs&&K.hasPremiumDogs()&&(p.purchases.premiumDogs=!0),v.save(p);const o=i.restored.join("ã€");this.showRestoreSuccess(`${o}
ã‚’å¾©å…ƒã—ã¾ã—ãŸï¼`)}else this.showPurchaseError(i.error||"å¾©å…ƒã™ã‚‹è³¼å…¥ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ")}catch(i){t.destroy(),console.error("å¾©å…ƒã‚¨ãƒ©ãƒ¼:",i),this.showPurchaseError("å¾©å…ƒå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}}showRestoreSuccess(e){const{width:s,height:t}=this.scale,i=this.add.text(s/2,t/2,`âœ… ${e}`,{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#4CAF50",fontStyle:"bold",align:"center",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setDepth(401);this.tweens.add({targets:i,scale:{from:.8,to:1},duration:300,ease:"Back.easeOut",onComplete:()=>{this.time.delayedCall(2e3,()=>{i.destroy(),this.scene.restart()})}})}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.setDepth(101),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("MainMenuScene"))}),t}createProducts(){const{width:e,height:s}=this.scale,t=M.TOP+85,i=Object.values(Et);let o=t;i.forEach((n,r)=>{n.isHero?(this.createHeroCard(e/2,o,n),o+=175):(this.createProductCard(e/2,o,n),o+=95)})}createHeroCard(e,s,t){var m;const{width:i}=this.scale,o=i-20,n=155,r=(m=p.purchases)==null?void 0:m[t.id],a=this.add.container(e,s),l=this.add.graphics();l.fillStyle(16766720,.25),l.fillRoundedRect(-o/2-6,-6,o+12,n+12,20),a.add(l),this.tweens.add({targets:l,alpha:{from:.15,to:.35},duration:1200,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"});const c=this.add.graphics();if(c.fillStyle(16776688,1),c.fillRoundedRect(-o/2,0,o,n,16),c.lineStyle(3,16766720,1),c.strokeRoundedRect(-o/2,0,o,n,16),a.add(c),t.badge&&!r){const y=this.add.container(-o/2+65,0),S=this.add.graphics();S.fillStyle(16720418,1),S.fillRoundedRect(-60,-18,120,36,18),S.lineStyle(3,16776960,1),S.strokeRoundedRect(-60,-18,120,36,18),y.add(S);const F=this.add.text(0,0,t.badge,{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#FFFFFF",fontStyle:"bold",stroke:"#FF0000",strokeThickness:2}).setOrigin(.5);if(y.add(F),a.add(y),this.tweens.add({targets:y,scale:{from:1,to:1.08},duration:600,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),t.discountBadge){const x=this.add.container(o/2-45,0),C=this.add.graphics();C.fillStyle(43520,1),C.fillRoundedRect(-40,-16,80,32,16),x.add(C);const T=this.add.text(0,0,t.discountBadge,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);x.add(T),a.add(x),this.tweens.add({targets:x,scale:{from:1,to:1.08},duration:600,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}}const d=85,u=this.add.image(-o/2+55,n/2+8,t.iconKey);u.setDisplaySize(d,d).setOrigin(.5),r&&(u.setTint(11184810),u.setAlpha(.7)),a.add(u);const f=this.add.text(-o/2+100,28,t.name,{fontFamily:"KeiFont, sans-serif",fontSize:"26px",color:r?"#999999":"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(0,0);a.add(f);const g=this.add.text(-o/2+100,62,t.description,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#666666",wordWrap:{width:o-200},lineSpacing:4}).setOrigin(0,0);if(a.add(g),r){const y=this.add.text(o/2-20,n/2,"âœ“ è³¼å…¥ãšã¿",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#4CAF50",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(1,.5);a.add(y)}else{if(t.originalPrice){const F=n/2-18,x=this.add.text(o/2-58,F,`Â¥${t.originalPrice}`,{fontFamily:"KeiFont, sans-serif",fontSize:"15px",color:"#888888"}).setOrigin(.5);a.add(x);const C=this.add.graphics();C.lineStyle(3,16729156,.9),C.lineBetween(o/2-88,F,o/2-28,F),a.add(C)}const y=this.add.graphics();y.fillStyle(t.color,1),y.fillRoundedRect(o/2-110,n/2-5,100,50,14),y.lineStyle(3,16777215,.5),y.strokeRoundedRect(o/2-110,n/2-5,100,50,14),a.add(y);const S=this.add.text(o/2-60,n/2+20,`Â¥${t.price}`,{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF",fontStyle:"bold",stroke:"#000000",strokeThickness:1}).setOrigin(.5);a.add(S)}if(!r){const y=this.add.rectangle(0,n/2,o,n,0,0);y.setInteractive({useHandCursor:!0}),a.add(y),a.sendToBack(y),y.on("pointerdown",()=>{this.tweens.add({targets:a,scale:.97,duration:40}),E.impact("Light")}),y.on("pointerup",()=>{this.tweens.add({targets:a,scale:1.02,duration:80,yoyo:!0}),this.processPurchase(t)}),y.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80}))}}createProductCard(e,s,t){var g,m;const{width:i}=this.scale,o=i-36,n=82,r=t.isSingleDog?!1:((g=p.purchases)==null?void 0:g[t.id])||((m=p.purchases)==null?void 0:m.deluxe),a=this.add.container(e,s),l=this.add.graphics();r?(l.fillStyle(16119285,1),l.fillRoundedRect(-o/2,0,o,n,14)):(l.fillStyle(16777215,1),l.fillRoundedRect(-o/2,0,o,n,14),l.lineStyle(2,15263976,1),l.strokeRoundedRect(-o/2,0,o,n,14)),a.add(l);const c=52,d=this.add.image(-o/2+38,n/2,t.iconKey);d.setDisplaySize(c,c).setOrigin(.5),r&&(d.setTint(11184810),d.setAlpha(.7)),a.add(d);const u=this.add.text(-o/2+70,16,t.name,{fontFamily:"KeiFont, sans-serif",fontSize:"17px",color:r?"#999999":"#5D4037",fontStyle:"bold"}).setOrigin(0,0);a.add(u);const f=this.add.text(-o/2+70,40,t.description,{fontFamily:"KeiFont, sans-serif",fontSize:"11px",color:"#777777",wordWrap:{width:o-170},lineSpacing:2}).setOrigin(0,0);if(a.add(f),r){const y=this.add.text(o/2-15,n/2,"âœ“ è³¼å…¥ãšã¿",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",color:"#4CAF50",fontStyle:"bold"}).setOrigin(1,.5);a.add(y)}else{const y=this.add.graphics();y.fillStyle(t.color,1),y.fillRoundedRect(o/2-78,n/2-15,68,30,10),a.add(y);const S=this.add.text(o/2-44,n/2,`Â¥${t.price}`,{fontFamily:"KeiFont, sans-serif",fontSize:"15px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);a.add(S)}if(!r){const y=this.add.rectangle(0,n/2,o,n,0,0);y.setInteractive({useHandCursor:!0}),a.add(y),a.sendToBack(y),y.on("pointerdown",()=>{this.tweens.add({targets:a,scale:.96,duration:40}),E.impact("Light")}),y.on("pointerup",()=>{this.tweens.add({targets:a,scale:1.02,duration:80,yoyo:!0}),t.isSingleDog?this.showDogSelectModal():this.processPurchase(t)}),y.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80}))}}showDogSelectModal(){const{width:e,height:s}=this.scale,t=this.add.rectangle(0,0,e,s,0,.6).setOrigin(0).setDepth(200).setInteractive(),i=p.unlockedDogs||[],o=Object.entries(z).filter(([Y,ae])=>{const N=parseInt(Y);return N===29?!1:!i.includes(N)&&!ae.isSecret}),n=e-30,r=3,a=100,l=8,c=a+l+14,u=4*c,f=u+120,g=s/2-f/2,y=Math.ceil(o.length/r)*c,S=this.add.graphics().setDepth(201);S.fillStyle(0,.1),S.fillRoundedRect(e/2-n/2+4,g+4,n,f,20),S.fillStyle(16777215,1),S.fillRoundedRect(e/2-n/2,g,n,f,20),S.fillStyle(9268835,.7),S.fillRoundedRect(e/2-n/2,g,n,6,{tl:20,tr:20,bl:0,br:0});const F=this.add.text(e/2,g+35,"ğŸ• è¿ãˆã‚‹ãƒ¯ãƒ³ã‚³ã‚’é¸ã¼ã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#5D4037",fontStyle:"bold"}).setOrigin(.5).setDepth(202),x=g+70,C=x+u-10,T=r*a+(r-1)*l,O=(e-T)/2+a/2,k=[],b=this.add.container(0,0).setDepth(202);let B=0,A=!1;if(o.length===0){const Y=this.add.text(e/2,g+f/2,`ã™ã¹ã¦ã®ãƒ¯ãƒ³ã‚³ã‚’
ãŠè¿ãˆã—ã¾ã—ãŸï¼ğŸ¶`,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#5D4037",align:"center"}).setOrigin(.5).setDepth(202);k.push(Y)}else o.forEach(([Y,ae],N)=>{const V=N%r,J=Math.floor(N/r),te=O+V*(a+l),se=x+J*c+a/2,U=this.add.container(te,se),Q=this.add.graphics();Q.fillStyle(0,.06),Q.fillRoundedRect(-a/2+3,-a/2+3,a,a,14),Q.fillStyle(16776181,1),Q.fillRoundedRect(-a/2,-a/2,a,a,14),Q.lineStyle(2.5,10586239,1),Q.strokeRoundedRect(-a/2,-a/2,a,a,14),U.add(Q);const ue=L.draw(this,0,-8,parseInt(Y),22,"happy");U.add(ue);const st=this.add.text(0,a/2-22,ae.name,{fontFamily:"KeiFont, sans-serif",fontSize:"11px",color:"#5D4037",fontStyle:"bold",align:"center",wordWrap:{width:a-10,useAdvancedWrap:!0}}).setOrigin(.5);U.add(st),U.setSize(a,a),U.setInteractive({useHandCursor:!0}),U.on("pointerdown",ye=>{ye.y<x||ye.y>C||A||this.tweens.add({targets:U,scale:.92,duration:40})}),U.on("pointerup",ye=>{ye.y<x||ye.y>C||A||(E.notification("Success"),this.purchaseSingleDog(parseInt(Y),ae,t,S,F,ne,k,b))}),U.on("pointerout",()=>this.tweens.add({targets:U,scale:1,duration:80})),b.add(U),k.push(U)});const R=this.make.graphics();R.fillStyle(16777215),R.fillRect(e/2-n/2,x,n,u-10);const P=R.createGeometryMask();b.setMask(P);const $=Math.max(0,y-u+10);let q=!1,j=0,ce=0;t.on("pointerdown",Y=>{Y.y>=x&&Y.y<=C&&(q=!0,j=Y.y,ce=B,A=!1)}),t.on("pointermove",Y=>{if(!q)return;Math.abs(Y.y-j)>8&&(A=!0),B=w.Math.Clamp(ce-(Y.y-j),0,$),b.y=-B}),t.on("pointerup",()=>{q=!1,this.time.delayedCall(50,()=>{A=!1})});const ne=this.add.text(e/2,g+f-30,"Ã— ã¨ã˜ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#999999",fontStyle:"bold"}).setOrigin(.5).setDepth(202).setInteractive({useHandCursor:!0});ne.on("pointerup",()=>{t.destroy(),S.destroy(),F.destroy(),ne.destroy(),b.destroy(),k.forEach(Y=>Y.destroy())})}async purchaseSingleDog(e,s,t,i,o,n,r,a){const{width:l,height:c}=this.scale,d=this.add.text(l/2,c/2,"ã—ã‚‡ã‚Šã¡ã‚…ã†...",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setDepth(400);try{console.log("[Shop] ãƒ¯ãƒ³ã‚³ã‚’è¿ãˆã‚‹è³¼å…¥é–‹å§‹: dogId=",e);const u=await K.purchaseSingleDog();if(console.log("[Shop] ãƒ¯ãƒ³ã‚³ã‚’è¿ãˆã‚‹è³¼å…¥çµæœ:",u),d.destroy(),u.success){if(t.destroy(),i.destroy(),o.destroy(),n.destroy(),a&&a.destroy(),r.forEach(f=>f.destroy()),!p.unlockedDogs.includes(e)){p.unlockedDogs.push(e);const f=new Date().toISOString().split("T")[0];p.dogUnlockDates[e]=f,v.save(p)}E.notification("Success"),_.playSfx(this,"sfx_achievement"),this.showPurchaseSuccess({name:s.name,icon:"ğŸ•"})}else E.notification("Error"),this.showPurchaseError(u.error||"è³¼å…¥ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ")}catch(u){d.destroy(),console.error("[Shop] ãƒ¯ãƒ³ã‚³ã‚’è¿ãˆã‚‹è³¼å…¥ã‚¨ãƒ©ãƒ¼:",u),E.notification("Error"),this.showPurchaseError("è³¼å…¥å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}}async processPurchase(e){const{width:s,height:t}=this.scale,i=this.add.text(s/2,t/2,"ã—ã‚‡ã‚Šã¡ã‚…ã†...",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setDepth(400);try{let o;e.id==="deluxe"?o=await K.purchaseDeluxe():e.id==="allCustomize"?o=await K.purchaseCustomize():e.id==="adFree"?o=await K.purchaseRemoveAds():e.id==="singleDog"?o=await K.purchaseSingleDog():o={success:!1,error:"ä¸æ˜ãªå•†å“ã§ã™"},i.destroy(),o.success?(E.notification("Success"),_.playSfx(this,"sfx_achievement"),p.purchases[e.id]=!0,e.id==="deluxe"&&(p.purchases.adFree=!0,p.purchases.allCustomize=!0,ie.removeAds()),e.id==="adFree"&&ie.removeAds(),v.save(p),this.showPurchaseSuccess(e)):this.showPurchaseError(o.error||"è³¼å…¥ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ")}catch(o){i.destroy(),console.error("è³¼å…¥ã‚¨ãƒ©ãƒ¼:",o),this.showPurchaseError("è³¼å…¥å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}}showPurchaseError(e){const{width:s,height:t}=this.scale;E.notification("Error");const i=this.add.text(s/2,t/2,`âš ï¸ ${e}`,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#D32F2F",fontStyle:"bold",align:"center",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setDepth(401);this.tweens.add({targets:i,alpha:{from:1,to:0},duration:2e3,delay:1500,onComplete:()=>i.destroy()})}showPurchaseSuccess(e){const{width:s,height:t}=this.scale;for(let o=0;o<25;o++){const n=w.Math.Between(50,s-50),r=t/2,a=["âœ¨","ğŸ‰","â­"][o%3],l=this.add.text(n,r,a,{fontSize:"28px"}).setAlpha(0).setDepth(300);this.tweens.add({targets:l,y:r-w.Math.Between(80,200),alpha:{from:1,to:0},scale:{from:1.2,to:.3},duration:1200,delay:o*40,onComplete:()=>l.destroy()})}const i=this.add.text(s/2,t/2,`${e.icon} ${e.name}
è³¼å…¥å®Œäº†ï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#5D4037",fontStyle:"bold",align:"center",stroke:"#FFFFFF",strokeThickness:5}).setOrigin(.5).setScale(0).setDepth(301);this.tweens.add({targets:i,scale:1,duration:400,ease:"Back.easeOut",onComplete:()=>{this.time.delayedCall(1500,()=>{i.destroy(),this.scene.restart()})}})}}class Wt extends w.Scene{constructor(){super({key:"SettingsScene"})}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select");const t=this.add.image(e/2,s/2,"settei_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n).setDepth(0),this.createHeader(),this.createSettings(),this.cameras.main.fadeIn(300)}createHeader(){const{width:e}=this.scale,s=M.TOP;this.createBackButton(50,s+32),this.add.text(e/2,s+32,"âš™ï¸ ã›ã£ã¦ã„",{...D.heading,fontSize:"22px"}).setOrigin(.5).setDepth(101)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.setDepth(101),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("TitleScene"))}),t}createSettings(){const{width:e,height:s}=this.scale,t=M.TOP+100,i=this.add.graphics();i.fillStyle(9479342,.25),i.fillRoundedRect(18,t-15,e-32,175,16),i.fillStyle(16448250,.98),i.fillRoundedRect(15,t-20,e-30,175,16),i.fillStyle(6323595,.5),i.fillRoundedRect(15,t-20,e-30,5,{tl:16,tr:16,bl:0,br:0}),this.createVolumeSlider(e/2,t+25,"ğŸµ BGM",typeof p.settings.bgmVolume=="number"?p.settings.bgmVolume:1,r=>{p.settings.bgmVolume=r,_.setBgmVolume(r),v.save(p)}),this.createVolumeSlider(e/2,t+100,"ğŸ”Š SE",typeof p.settings.seVolume=="number"?p.settings.seVolume:1,r=>{p.settings.seVolume=r,_.setSeVolume(r),v.save(p)},()=>{_.playSfx(this,"sfx_ui_tap")});const o=t+200,n=this.add.graphics();n.fillStyle(9479342,.25),n.fillRoundedRect(18,o-15,e-32,145,16),n.fillStyle(16448250,.98),n.fillRoundedRect(15,o-20,e-30,145,16),n.fillStyle(5227511,.5),n.fillRoundedRect(15,o-20,e-30,5,{tl:16,tr:16,bl:0,br:0}),this.createLinkButton(e/2,o+20,"ğŸ”„ è³¼å…¥ã‚’å¾©å…ƒ",()=>{this.onRestorePurchases()}),this.createLinkButton(e/2,o+80,"ğŸ“„ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼",()=>{this.onPrivacyPolicy()}),this.createButton(e/2,s-M.BOTTOM-80,"ğŸ—‘ï¸ ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ",16739179,()=>{this.showResetConfirm()})}createLinkButton(e,s,t,i){const{width:o}=this.scale,n=o-70,r=this.add.container(e,s),a=this.add.graphics();a.fillStyle(16777215,1),a.fillRoundedRect(-n/2,-24,n,48,12),a.lineStyle(2,14737632,1),a.strokeRoundedRect(-n/2,-24,n,48,12);const l=this.add.text(0,0,t,{fontFamily:"KeiFont, sans-serif",fontSize:"17px",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5),c=this.add.text(n/2-20,0,"â€º",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#9E9E9E"}).setOrigin(.5);return r.add([a,l,c]),r.setSize(n,48),r.setInteractive({useHandCursor:!0}),r.on("pointerdown",()=>{this.tweens.add({targets:r,scale:.97,duration:50}),a.clear(),a.fillStyle(16119285,1),a.fillRoundedRect(-n/2,-24,n,48,12),a.lineStyle(2,14737632,1),a.strokeRoundedRect(-n/2,-24,n,48,12)}),r.on("pointerup",()=>{this.tweens.add({targets:r,scale:1,duration:100,ease:"Back.easeOut"}),a.clear(),a.fillStyle(16777215,1),a.fillRoundedRect(-n/2,-24,n,48,12),a.lineStyle(2,14737632,1),a.strokeRoundedRect(-n/2,-24,n,48,12),i()}),r.on("pointerout",()=>{this.tweens.add({targets:r,scale:1,duration:80}),a.clear(),a.fillStyle(16777215,1),a.fillRoundedRect(-n/2,-24,n,48,12),a.lineStyle(2,14737632,1),a.strokeRoundedRect(-n/2,-24,n,48,12)}),r}async onRestorePurchases(){const{width:e,height:s}=this.scale,t=this.add.text(e/2,s/2,"å¾©å…ƒã¡ã‚…ã†...",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#5D4037",fontStyle:"bold",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5).setDepth(400);try{const i=await K.restorePurchases();if(t.destroy(),i.success&&i.restored.length>0){E.notification("Success"),K.isAdsRemoved&&K.isAdsRemoved()&&(p.purchases.adFree=!0,ie.removeAds()),K.hasPremiumDogs&&K.hasPremiumDogs()&&(p.purchases.premiumDogs=!0),v.save(p);const o=i.restored.join("ã€");this.showToast(`${o} ã‚’å¾©å…ƒã—ã¾ã—ãŸï¼`)}else this.showToast(i.error||"å¾©å…ƒã™ã‚‹è³¼å…¥ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ")}catch(i){t.destroy(),console.error("å¾©å…ƒã‚¨ãƒ©ãƒ¼:",i),this.showToast("å¾©å…ƒå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}}onPrivacyPolicy(){window.open("https://kerofen.github.io/inusanpo/privacy-policy.html","_blank")}showToast(e){const{width:s,height:t}=this.scale,i=this.add.container(s/2,t-M.BOTTOM-150);i.setAlpha(0);const o=this.add.graphics();o.fillStyle(3355443,.9),o.fillRoundedRect(-120,-20,240,40,20);const n=this.add.text(0,0,e,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#FFFFFF"}).setOrigin(.5);i.add([o,n]),this.tweens.add({targets:i,alpha:1,y:i.y-10,duration:200,ease:"Back.easeOut",onComplete:()=>{this.time.delayedCall(1500,()=>{this.tweens.add({targets:i,alpha:0,y:i.y+10,duration:200,onComplete:()=>i.destroy()})})}})}createVolumeSlider(e,s,t,i,o,n=null){const{width:r}=this.scale,a=r-70,l=a-150,c=8,d=14,u=-a/2+110,f=this.add.container(e,s),g=this.add.graphics();g.fillStyle(16777215,1),g.fillRoundedRect(-a/2,-28,a,56,14),g.lineStyle(2,14737632,1),g.strokeRoundedRect(-a/2,-28,a,56,14);const m=this.add.text(-a/2+22,0,t,{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#5D4037",fontStyle:"bold"}).setOrigin(0,.5);let y=i;const S=this.add.graphics();S.fillStyle(14737632,1),S.fillRoundedRect(u,-c/2,l,c,c/2);const F=this.add.graphics(),x=this.add.graphics(),C=()=>{const k=l*y;F.clear(),k>0&&(F.fillStyle(5227511,1),F.fillRoundedRect(u,-c/2,k,c,c/2));const b=u+k;x.clear(),x.fillStyle(0,.15),x.fillCircle(b+2,2,d),x.fillStyle(16777215,1),x.fillCircle(b,0,d),x.lineStyle(2,5227511,1),x.strokeCircle(b,0,d),x.fillStyle(5227511,.3),x.fillCircle(b,0,d-5)};C(),f.add([g,m,S,F,x]),f.setSize(a,56),f.setInteractive({useHandCursor:!0,draggable:!1});let T=!1;const O=k=>{const b=f.x,A=k-b-u,R=Math.max(0,Math.min(1,A/l));R!==y&&(y=R,C(),o(y))};f.on("pointerdown",k=>{T=!0,O(k.x)}),this.input.on("pointermove",k=>{T&&O(k.x)}),this.input.on("pointerup",()=>{T&&(T=!1,n&&n())})}createToggle(e,s,t,i,o){const{width:n}=this.scale,r=n-70,a=this.add.container(e,s),l=this.add.graphics();l.fillStyle(16777215,1),l.fillRoundedRect(-r/2,-28,r,56,14),l.lineStyle(2,14737632,1),l.strokeRoundedRect(-r/2,-28,r,56,14);const c=this.add.text(-r/2+22,0,t,{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:"#5D4037",fontStyle:"bold"}).setOrigin(0,.5);let d=i;const u=this.add.graphics(),f=this.add.graphics(),g=()=>{u.clear(),u.fillStyle(d?5025616:12434877,1),u.fillRoundedRect(r/2-75,-16,55,32,16),f.clear(),f.fillStyle(16777215,1),f.fillCircle(d?r/2-34:r/2-61,0,13),f.lineStyle(1,34,1),f.strokeCircle(d?r/2-34:r/2-61,0,13)};g(),a.add([l,c,u,f]),a.setSize(r,56),a.setInteractive({useHandCursor:!0}),a.on("pointerdown",()=>this.tweens.add({targets:a,scale:.96,duration:50})),a.on("pointerup",()=>{this.tweens.add({targets:a,scale:1,duration:100,ease:"Back.easeOut"}),d=!d,g(),o(d)}),a.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80}))}createButton(e,s,t,i,o){const n=this.add.container(e,s),r=this.add.graphics();r.fillStyle(i,1),r.fillRoundedRect(-110,-25,220,50,14);const a=this.add.text(0,0,t,{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);n.add([r,a]),n.setSize(220,50),n.setInteractive({useHandCursor:!0}),n.on("pointerdown",()=>this.tweens.add({targets:n,scale:.94,duration:50})),n.on("pointerup",()=>{this.tweens.add({targets:n,scale:1,duration:100,ease:"Back.easeOut"}),o()}),n.on("pointerout",()=>this.tweens.add({targets:n,scale:1,duration:80}))}showResetConfirm(){const{width:e,height:s}=this.scale,t=this.add.rectangle(0,0,e,s,0,.5).setOrigin(0),i=this.add.container(e/2,s/2),o=this.add.graphics();o.fillStyle(16777215,1),o.fillRoundedRect(-130,-80,260,160,16);const n=this.add.text(0,-50,"âš ï¸ ç¢ºèª",{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#5D4037",fontStyle:"bold"}).setOrigin(.5),r=this.add.text(0,-5,`ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’
ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ`,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#5D4037",align:"center",lineSpacing:4}).setOrigin(.5),a=this.add.text(-50,55,"ã¯ã„",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#FF6B6B",fontStyle:"bold"}).setOrigin(.5).setInteractive({useHandCursor:!0}),l=this.add.text(50,55,"ã„ã„ãˆ",{fontFamily:"KeiFont, sans-serif",fontSize:"18px",color:"#4CAF50",fontStyle:"bold"}).setOrigin(.5).setInteractive({useHandCursor:!0});a.on("pointerdown",()=>this.tweens.add({targets:a,scale:.9,duration:50})),a.on("pointerup",()=>{localStorage.removeItem(v.STORAGE_KEY),p=v.getDefaultData(),this.scene.start("TitleScene")}),a.on("pointerout",()=>this.tweens.add({targets:a,scale:1,duration:80})),l.on("pointerdown",()=>this.tweens.add({targets:l,scale:.9,duration:50})),l.on("pointerup",()=>{this.tweens.add({targets:l,scale:1,duration:80}),t.destroy(),i.destroy()}),l.on("pointerout",()=>this.tweens.add({targets:l,scale:1,duration:80})),i.add([o,n,r,a,l])}}class Gt extends w.Scene{constructor(){super({key:"CustomizeScene"})}create(){const{width:e,height:s}=this.scale,t=this.add.image(e/2,s/2,"kisekae_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n).setDepth(0),this.currentTab=this.registry.get("customizeTab")||"color",this.contentContainer=null,this.createHeader(),this.createTabs(),this.showTabContent(this.currentTab),this.cameras.main.fadeIn(300)}createHeader(){const{width:e}=this.scale,s=M.TOP;this.createBackButton(50,s+28),this.add.text(e/2,s+28,"ğŸ¨ ãã›ã‹ãˆ",{...D.heading,fontSize:"22px"}).setOrigin(.5).setDepth(101)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.setDepth(101),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("MainMenuScene"))}),t}createTabs(){const{width:e}=this.scale,s=M.TOP+75,t=this.add.graphics();t.setDepth(99),t.fillStyle(16774647,.95),t.fillRoundedRect(15,s-8,e-30,50,12);const i=[{id:"color",iconKey:"menu_color",label:"ã‚«ãƒ©ãƒ¼"},{id:"costume",iconKey:"menu_costume",label:"è¡£è£…"},{id:"theme",iconKey:"menu_theme",label:"ãƒ†ãƒ¼ãƒ"}],o=(e-50)/3,n=25+o/2;this.tabButtons=[],i.forEach((r,a)=>{const l=n+a*o,c=this.currentTab===r.id,d=this.add.container(l,s+17);d.setDepth(100);const u=this.add.graphics();c&&(u.fillStyle(16766720,1),u.fillRoundedRect(-o/2+5,-16,o-10,32,16)),d.add(u);const f=c?"#5D4037":"#888888",g=c?"bold":"normal",m=this.add.image(-25,0,r.iconKey),y=22/Math.max(m.width,m.height);m.setScale(y),m.setAlpha(c?1:.6),d.add(m);const S=this.add.text(10,0,r.label,{fontFamily:"KeiFont, sans-serif",fontSize:"15px",color:f,fontStyle:g,stroke:"#FFFFFF",strokeThickness:c?2:1}).setOrigin(.5);d.add(S),d.setSize(o-10,36),d.setInteractive({useHandCursor:!0}),d.on("pointerdown",()=>{c||this.tweens.add({targets:d,scale:.95,duration:50})}),d.on("pointerup",()=>{this.tweens.add({targets:d,scale:1,duration:80}),c||this.switchTab(r.id)}),d.on("pointerout",()=>{this.tweens.add({targets:d,scale:1,duration:60})}),this.tabButtons.push({container:d,tab:r})})}switchTab(e){this.currentTab=e,this.registry.set("customizeTab",e),this.scene.restart()}showTabContent(e){const{width:s,height:t}=this.scale,i=M.TOP+140;this.contentContainer=this.add.container(0,0);const o=this.add.graphics();switch(o.fillStyle(16777215,.98),o.fillRoundedRect(15,i-10,s-30,t-i-20,18),o.fillStyle(0,.05),o.fillRoundedRect(18,i-7,s-36,t-i-26,18),this.contentContainer.add(o),this.contentContainer.sendToBack(o),e){case"color":this.createPawColorsContent(i);break;case"costume":this.createCostumesContent(i);break;case"theme":this.createThemesContent(i);break}}createPawColorsContent(e){const{width:s}=this.scale,t=this.add.text(s/2,e+20,"ğŸ¾ ã«ããã‚…ã†ã‚«ãƒ©ãƒ¼",{...D.section,fontSize:"18px"}).setOrigin(.5);this.contentContainer.add(t);const i=this.add.text(s/2,e+45,"ãŠã•ã‚“ã½ä¸­ã®è‚‰çƒã®è‰²ã‚’å¤‰ãˆã‚ˆã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:"#888888",stroke:"#FFFFFF",strokeThickness:1}).setOrigin(.5);this.contentContainer.add(i);const o=Object.entries(ee),n=5,r=56,a=10,l=70,c=n*r+(n-1)*a,d=(s-c)/2+r/2;o.forEach(([u,f],g)=>{const m=g%n,y=Math.floor(g/n),S=d+m*(r+a),F=e+100+y*l;this.createColorOption(S,F,u,f)})}createColorOption(e,s,t,i){const o=this.checkUnlock(i.unlockCondition),n=p.customize.pawColor===t||!p.customize.pawColor&&t==="brown",r=this.add.container(e,s),a=26,l=this.add.graphics();if(n)l.fillStyle(16766720,.25),l.fillCircle(0,0,a+6),l.fillStyle(16775910,1),l.fillCircle(0,0,a),l.lineStyle(3,16766720,1),l.strokeCircle(0,0,a),this.tweens.add({targets:r,scale:{from:1,to:1.03},duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"});else if(o){l.fillStyle(16776181,1),l.fillCircle(0,0,a);const d=i.color==="rainbow"?16738740:i.color;l.lineStyle(2.5,d,.85),l.strokeCircle(0,0,a)}else l.fillStyle(11053224,1),l.fillCircle(0,0,a),l.lineStyle(2,9474192,1),l.strokeCircle(0,0,a);r.add(l),this.contentContainer.add(r);const c=i.imageKey||"paw_brown";if(o){const d=oe.drawSprite(this,0,0,c,38);d.setOrigin(.5,.5),d.setAlpha(1),r.add(d)}else{const d=oe.drawSprite(this,0,0,c,38);d.setOrigin(.5,.5),d.setAlpha(.5),d.setTint(2236962),r.add(d)}if(n){const d=this.add.graphics();d.fillStyle(5025616,1),d.fillCircle(a-4,-a+4,9),r.add(d);const u=this.add.text(a-4,-a+4,"âœ“",{fontSize:"11px",fontStyle:"bold",color:"#FFFFFF"}).setOrigin(.5);r.add(u)}r.setSize(a*2+16,a*2+16),r.setInteractive({useHandCursor:!0}),r.on("pointerdown",()=>{n||this.tweens.add({targets:r,scale:.9,duration:50})}),r.on("pointerup",()=>{this.tweens.add({targets:r,scale:n?1.05:1,duration:100,ease:"Back.easeOut"}),o?(p.customize.pawColor=t,v.save(p),this.scene.restart()):this.showUnlockCondition(i)}),r.on("pointerout",()=>{n||this.tweens.add({targets:r,scale:1,duration:80})})}createCostumesContent(e){var b;const{width:s,height:t}=this.scale,i=((b=p.rewards)==null?void 0:b.medals)||0,o=this.add.text(s/2,e+20,"ğŸ€ è¡£è£…",{...D.section,fontSize:"18px"}).setOrigin(.5);this.contentContainer.add(o);const n=this.add.text(s/2,e+45,`ğŸ… ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«: ${i}æš`,{fontFamily:"KeiFont, sans-serif",fontSize:"13px",color:"#888888",stroke:"#FFFFFF",strokeThickness:1}).setOrigin(.5);this.contentContainer.add(n);const r=Object.entries(Ee),a=3,l=95,c=8,d=12,u=a*l+(a-1)*c,f=(s-u)/2+l/2,m=Math.ceil(r.length/a)*(l+d+20)+80,y=e+65,S=t-40,F=S-y;this.costumeListContainer=this.add.container(0,0),this.contentContainer.add(this.costumeListContainer),r.forEach(([B,A],R)=>{const P=f+R%a*(l+c),$=e+125+Math.floor(R/a)*(l+d+20);this.createCostumeOption(P,$,B,A,this.costumeListContainer)});const x=this.make.graphics();x.fillStyle(16777215),x.fillRect(15,y,s-30,F);const C=x.createGeometryMask();this.costumeListContainer.setMask(C),this.scrollY=0,this.maxScroll=Math.max(0,m-F+30),this.isScrolling=!1,this.scrollBounds={top:y,bottom:S,left:15,right:s-15};let T=!1,O=0,k=0;this.input.on("pointerdown",B=>{B.y>=y&&B.y<=y+F&&B.x>=15&&B.x<=s-15&&(T=!0,O=B.y,k=this.scrollY,this.isScrolling=!1)}),this.input.on("pointermove",B=>{if(!T)return;Math.abs(B.y-O)>10&&(this.isScrolling=!0,this.scrollY=w.Math.Clamp(k-(B.y-O),0,this.maxScroll),this.costumeListContainer.y=-this.scrollY)}),this.input.on("pointerup",()=>{T=!1,this.time.delayedCall(50,()=>{this.isScrolling=!1})})}createCostumeOption(e,s,t,i,o){const n=this.checkUnlock(i.unlockCondition),a=(p.customize.equippedCostumes||[]).includes(t),l=this.add.container(e,s),c=95,d=this.add.graphics();if(a?(d.fillStyle(16766720,.25),d.fillRoundedRect(-c/2-8,-c/2-8,c+16,c+16,18),d.fillStyle(16775910,1),d.fillRoundedRect(-c/2,-c/2,c,c,14),d.lineStyle(4,16766720,1),d.strokeRoundedRect(-c/2,-c/2,c,c,14),this.tweens.add({targets:l,scale:{from:1,to:1.03},duration:900,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})):n?(d.fillStyle(0,.05),d.fillRoundedRect(-c/2+2,-c/2+2,c,c,14),d.fillStyle(16776181,1),d.fillRoundedRect(-c/2,-c/2,c,c,14),d.lineStyle(2.5,14534840,1),d.strokeRoundedRect(-c/2,-c/2,c,c,14)):(d.fillStyle(0,.04),d.fillRoundedRect(-c/2+2,-c/2+2,c,c,14),d.fillStyle(11053224,1),d.fillRoundedRect(-c/2,-c/2,c,c,14),d.lineStyle(2,9474192,1),d.strokeRoundedRect(-c/2,-c/2,c,c,14)),l.add(d),(o||this.contentContainer).add(l),n)if(i.imageKey&&this.textures.exists(i.imageKey)){const m=this.add.image(0,-8,i.imageKey),y=40/Math.max(m.width,m.height);m.setScale(y),l.add(m)}else{const m=this.add.text(0,-8,i.icon,{fontSize:"32px"}).setOrigin(.5);l.add(m)}else if(i.imageKey&&this.textures.exists(i.imageKey)){const m=this.add.image(0,-8,i.imageKey),y=40/Math.max(m.width,m.height);m.setScale(y),m.setTint(2236962),m.setAlpha(.5),l.add(m)}const u=n?"#5D4037":"#888888",f=n?i.name:"ï¼Ÿï¼Ÿï¼Ÿ",g=this.add.text(0,c/2-22,f,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:u}).setOrigin(.5);if(l.add(g),a){const m=this.add.text(c/2-4,-c/2+4,"âœ“",{fontSize:"14px",fontStyle:"bold",backgroundColor:"#4CAF50",padding:{x:4,y:2},color:"#FFFFFF"}).setOrigin(.5);l.add(m)}l.setSize(c+12,c+12),l.setInteractive({useHandCursor:!0}),l.on("pointerdown",m=>{this.scrollBounds&&(m.y<this.scrollBounds.top||m.y>this.scrollBounds.bottom)||a||this.tweens.add({targets:l,scale:.92,duration:40})}),l.on("pointerup",m=>{this.tweens.add({targets:l,scale:a?1.03:1,duration:80,ease:"Back.easeOut"}),!this.isScrolling&&(this.scrollBounds&&(m.y<this.scrollBounds.top||m.y>this.scrollBounds.bottom)||(n?(p.customize.equippedCostumes||(p.customize.equippedCostumes=[]),a?p.customize.equippedCostumes=[]:p.customize.equippedCostumes=[t],v.save(p),this.scene.restart()):this.showCostumeUnlockCondition(i)))}),l.on("pointerout",()=>{a||this.tweens.add({targets:l,scale:1,duration:80})})}showCostumeUnlockCondition(e){var d,u;const{width:s,height:t}=this.scale,i=this.add.rectangle(0,0,s,t*2,0,.5).setOrigin(0).setInteractive(),o=this.add.container(s/2,t/2+this.cameras.main.scrollY),n=this.add.graphics();if(n.fillStyle(3355443,1),n.fillRoundedRect(-140,-120,280,240,12),o.add(n),e.imageKey&&this.textures.exists(e.imageKey)){const f=this.add.image(0,-55,e.imageKey),g=60/Math.max(f.width,f.height);f.setScale(g),f.setTint(1118481),f.setAlpha(.6),o.add(f)}else{const f=this.add.text(0,-55,e.icon,{fontSize:"48px"}).setOrigin(.5);f.setAlpha(.4),o.add(f)}const r=this.add.text(0,5,"ï¼Ÿï¼Ÿï¼Ÿ",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF"}).setOrigin(.5);o.add(r);let a="ğŸ”“ æ¡ä»¶ã‚’é”æˆã™ã‚‹ã¨è§£æ”¾",l="";if(e.unlockCondition.startsWith("medals_")){const f=e.unlockCondition.split("_")[1],g=((d=p.rewards)==null?void 0:d.medals)||0;a=`ğŸ”“ ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ« ${f}æšã§è§£æ”¾`,l=`ï¼ˆç¾åœ¨: ${g}æšï¼‰`}else if(e.unlockCondition.startsWith("stamp_complete_")){const f=e.unlockCondition.split("_")[2],g=((u=p.rewards)==null?void 0:u.totalWeeklyComplete)||0;a=`ğŸ”“ é€±é–“ã‚¹ã‚¿ãƒ³ãƒ— ${f}å›ã‚³ãƒ³ãƒ—ã§è§£æ”¾`,l=`ï¼ˆç¾åœ¨: ${g}å›ï¼‰`}const c=this.add.text(0,50,a,{...D.body,fontSize:"13px",color:"#FFFFFF",align:"center",wordWrap:{width:240}}).setOrigin(.5);if(o.add(c),l){const f=this.add.text(0,85,l,{fontSize:"11px",color:"#AAAAAA",align:"center"}).setOrigin(.5);o.add(f)}i.on("pointerup",()=>{o.destroy(),i.destroy()}),o.setScale(.8),o.setAlpha(0),this.tweens.add({targets:o,scale:1,alpha:1,duration:150,ease:"Back.easeOut"})}createThemesContent(e){const{width:s,height:t}=this.scale,i=this.add.text(s/2,e+20,"ğŸŒ ã›ã‹ã„ã®ãƒ†ãƒ¼ãƒ",{...D.section,fontSize:"18px"}).setOrigin(.5);this.contentContainer.add(i);const o=this.add.text(s/2,e+45,"ãŠã•ã‚“ã½ã®èƒŒæ™¯ã‚’å¤‰ãˆã‚ˆã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:"#888888",stroke:"#FFFFFF",strokeThickness:1}).setOrigin(.5);this.contentContainer.add(o);const n=Object.entries(ke),r=3,a=95,l=8,c=12,d=r*a+(r-1)*l,u=(s-d)/2+a/2,g=Math.ceil(n.length/r)*(a+c+20)+50,m=0,y=t-40,S=y-m;this.themeListContainer=this.add.container(0,0),this.contentContainer.add(this.themeListContainer),n.forEach(([k,b],B)=>{const A=u+B%r*(a+l),R=e+125+Math.floor(B/r)*(a+c+20);this.createThemeOption(A,R,k,b,this.themeListContainer)});const F=this.make.graphics();F.fillStyle(16777215),F.fillRect(15,m,s-30,S);const x=F.createGeometryMask();this.themeListContainer.setMask(x),this.scrollY=0,this.maxScroll=Math.max(0,g-S+30),this.isScrolling=!1,this.scrollBounds={top:m,bottom:y,left:15,right:s-15};let C=!1,T=0,O=0;this.input.on("pointerdown",k=>{k.y>=m&&k.y<=m+S&&k.x>=15&&k.x<=s-15&&(C=!0,T=k.y,O=this.scrollY,this.isScrolling=!1)}),this.input.on("pointermove",k=>{if(!C)return;Math.abs(k.y-T)>10&&(this.isScrolling=!0,this.scrollY=w.Math.Clamp(O-(k.y-T),0,this.maxScroll),this.themeListContainer.y=-this.scrollY)}),this.input.on("pointerup",()=>{C=!1,this.time.delayedCall(50,()=>{this.isScrolling=!1})})}createThemeOption(e,s,t,i,o){const n=this.checkUnlock(i.unlockCondition),r=p.customize.theme===t,a=this.add.container(e,s),l=95,c=this.add.graphics();if(r&&(c.fillStyle(16766720,.3),c.fillRoundedRect(-l/2-8,-l/2-8,l+16,l+16,18),this.tweens.add({targets:a,scale:{from:1,to:1.03},duration:850,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})),n?(c.fillStyle(16776181,1),c.fillRoundedRect(-l/2,-l/2,l,l,14)):(c.fillStyle(0,.04),c.fillRoundedRect(-l/2+2,-l/2+2,l,l,14),c.fillStyle(11053224,1),c.fillRoundedRect(-l/2,-l/2,l,l,14)),r?(c.lineStyle(5,16766720,1),c.strokeRoundedRect(-l/2,-l/2,l,l,14)):n?(c.lineStyle(2.5,14534840,1),c.strokeRoundedRect(-l/2,-l/2,l,l,14)):(c.lineStyle(2,9474192,1),c.strokeRoundedRect(-l/2,-l/2,l,l,14)),a.add(c),n&&i.image&&this.textures.exists(i.image)){const f=this.add.image(0,-12,i.image),g=l-12,m=l-32,y=g/f.width,S=m/f.height,F=Math.max(y,S);f.setScale(F);const x=g/F,C=m/F,T=(f.width-x)/2,O=(f.height-C)/2;f.setCrop(T,O,x,C),a.add(f)}else if(n){const f=this.add.graphics();f.fillGradientStyle(i.sky,i.sky,i.ground,i.ground,1),f.fillRoundedRect(-l/2+4,-l/2+4,l-8,l-28,10),a.add(f)}else{const f=this.add.graphics();f.fillGradientStyle(i.sky,i.sky,i.ground,i.ground,1),f.fillRoundedRect(-l/2+4,-l/2+4,l-8,l-28,10),f.setAlpha(.3),a.add(f)}(o||this.contentContainer).add(a);const d=n?i.name:"ï¼Ÿï¼Ÿï¼Ÿ",u=this.add.text(0,l/2-22,d,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:n?"#5D4037":"#888888"}).setOrigin(.5);if(a.add(u),r){const f=this.add.text(l/2-4,-l/2+4,"âœ“",{fontSize:"14px",fontStyle:"bold",backgroundColor:"#4CAF50",padding:{x:4,y:2},color:"#FFFFFF"}).setOrigin(.5);a.add(f)}a.setSize(l+14,l+14),a.setInteractive({useHandCursor:!0}),a.on("pointerdown",f=>{this.scrollBounds&&(f.y<this.scrollBounds.top||f.y>this.scrollBounds.bottom)||r||this.tweens.add({targets:a,scale:.92,duration:40})}),a.on("pointerup",f=>{this.tweens.add({targets:a,scale:r?1.03:1,duration:80,ease:"Back.easeOut"}),!this.isScrolling&&(this.scrollBounds&&(f.y<this.scrollBounds.top||f.y>this.scrollBounds.bottom)||(n?(p.customize.theme=t,v.save(p),this.scene.restart()):this.showThemeUnlockCondition(i)))}),a.on("pointerout",()=>{r||this.tweens.add({targets:a,scale:1,duration:80})})}showThemeUnlockCondition(e){var f,g,m,y,S,F;const{width:s,height:t}=this.scale,i=this.add.rectangle(0,0,s,t,0,.5).setOrigin(0).setInteractive(),o=this.add.container(s/2,t/2),n=this.add.graphics();n.fillStyle(3355443,1),n.fillRoundedRect(-140,-120,280,240,12),o.add(n);const r=70,a=this.add.graphics();a.fillGradientStyle(e.sky,e.sky,e.ground,e.ground,1),a.fillRoundedRect(-r/2,-90,r,r-10,10),a.setAlpha(.4),o.add(a);const l=this.add.text(0,5,"ï¼Ÿï¼Ÿï¼Ÿ",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF"}).setOrigin(.5);o.add(l);let c="ğŸ”“ æ¡ä»¶ã‚’é”æˆã™ã‚‹ã¨è§£æ”¾",d="";if(e.unlockCondition)if(e.unlockCondition.startsWith("medals_")){const x=e.unlockCondition.split("_")[1],C=((f=p.rewards)==null?void 0:f.medals)||0;c=`ğŸ”“ ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ« ${x}æšã§è§£æ”¾`,d=`ï¼ˆç¾åœ¨: ${C}æšï¼‰`}else if(e.unlockCondition.startsWith("stamp_complete_")){const x=e.unlockCondition.split("_")[2],C=((g=p.rewards)==null?void 0:g.totalWeeklyComplete)||0;c=`ğŸ”“ é€±é–“ã‚¹ã‚¿ãƒ³ãƒ— ${x}å›ã‚³ãƒ³ãƒ—ã§è§£æ”¾`,d=`ï¼ˆç¾åœ¨: ${C}å›ï¼‰`}else{const C={clear_20_stages:{desc:"ğŸ”“ 20ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((m=p.stats)==null?void 0:m.totalClears)||0}å›ï¼‰`},clear_30_stages:{desc:"ğŸ”“ 30ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((y=p.stats)==null?void 0:y.totalClears)||0}å›ï¼‰`},challenge_5_streak:{desc:"ğŸ”“ ãƒãƒ£ãƒ¬ãƒ³ã‚¸5é€£ç¶šã§è§£æ”¾",progress:`ï¼ˆæœ€é«˜: ${((S=p.stats)==null?void 0:S.challengeHighScore)||0}é€£ç¶šï¼‰`},golden_3_times:{desc:"ğŸ”“ ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³3å›ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((F=p.stats)==null?void 0:F.goldenClears)||0}å›ï¼‰`},use_all_4_dogs:{desc:"ğŸ”“ åˆæœŸ4çŠ¬ç¨®ã‚’1å›ãšã¤ä½¿ç”¨ã§è§£æ”¾",progress:""}}[e.unlockCondition];C&&(c=C.desc,d=C.progress)}const u=this.add.text(0,50,c,{...D.body,fontSize:"13px",color:"#FFFFFF",align:"center",wordWrap:{width:240}}).setOrigin(.5);if(o.add(u),d){const x=this.add.text(0,85,d,{fontSize:"11px",color:"#AAAAAA",align:"center"}).setOrigin(.5);o.add(x)}i.on("pointerup",()=>{o.destroy(),i.destroy()}),o.setScale(.8),o.setAlpha(0),this.tweens.add({targets:o,scale:1,alpha:1,duration:150,ease:"Back.easeOut"})}checkUnlock(e){var i,o,n,r;if(!e||(i=p.purchases)!=null&&i.deluxe||(o=p.purchases)!=null&&o.allCustomize)return!0;const s=((n=p.rewards)==null?void 0:n.medals)||0,t=((r=p.rewards)==null?void 0:r.totalWeeklyComplete)||0;if(e.startsWith("medals_")){const a=parseInt(e.split("_")[1]);return s>=a}if(e.startsWith("stamp_complete_")){const a=parseInt(e.split("_")[2]);return t>=a}switch(e){case"clear_10_stages":return p.stats.totalClears>=10;case"clear_15_stages":return p.stats.totalClears>=15;case"clear_20_stages":return p.stats.totalClears>=20;case"clear_25_stages":return p.stats.totalClears>=25;case"clear_30_stages":return p.stats.totalClears>=30;case"clear_40_stages":return p.stats.totalClears>=40;case"clear_50_stages":return p.stats.totalClears>=50;case"challenge_3_streak":return p.stats.challengeHighScore>=3;case"challenge_5_streak":return p.stats.challengeHighScore>=5;case"golden_3_times":return p.stats.goldenClears>=3;case"use_all_4_dogs":const a=p.stats.dogUsage;return[1,2,3,4].every(l=>a[l]>=1);default:return!1}}showUnlockCondition(e){var f,g,m,y,S,F,x,C,T,O,k,b,B,A;const{width:s,height:t}=this.scale,i=this.add.rectangle(0,0,s,t,0,.5).setOrigin(0).setInteractive(),o=this.add.container(s/2,t/2),n=this.add.graphics();n.fillStyle(3355443,1),n.fillRoundedRect(-140,-120,280,240,12),o.add(n);const r=e.imageKey||"paw_brown",a=oe.drawSprite(this,0,-55,r,55);a.setOrigin(.5,.5),a.setAlpha(.6),a.setTint(1118481),o.add(a);const l=this.add.text(0,5,"ï¼Ÿï¼Ÿï¼Ÿ",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF"}).setOrigin(.5);o.add(l);let c="æ¡ä»¶ã‚’é”æˆã™ã‚‹ã¨è§£æ”¾",d="";if(e.unlockCondition)if(e.unlockCondition.startsWith("medals_")){const R=e.unlockCondition.split("_")[1],P=((f=p.rewards)==null?void 0:f.medals)||0;c=`ğŸ”“ ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ« ${R}æšã§è§£æ”¾`,d=`ï¼ˆç¾åœ¨: ${P}æšï¼‰`}else if(e.unlockCondition.startsWith("stamp_complete_")){const R=e.unlockCondition.split("_")[2],P=((g=p.rewards)==null?void 0:g.totalWeeklyComplete)||0;c=`ğŸ”“ é€±é–“ã‚¹ã‚¿ãƒ³ãƒ— ${R}å›ã‚³ãƒ³ãƒ—ã§è§£æ”¾`,d=`ï¼ˆç¾åœ¨: ${P}å›ï¼‰`}else{const P={clear_10_stages:{desc:"ğŸ”“ 10ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((m=p.stats)==null?void 0:m.totalClears)||0}å›ï¼‰`},clear_15_stages:{desc:"ğŸ”“ 15ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((y=p.stats)==null?void 0:y.totalClears)||0}å›ï¼‰`},clear_20_stages:{desc:"ğŸ”“ 20ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((S=p.stats)==null?void 0:S.totalClears)||0}å›ï¼‰`},clear_25_stages:{desc:"ğŸ”“ 25ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((F=p.stats)==null?void 0:F.totalClears)||0}å›ï¼‰`},clear_30_stages:{desc:"ğŸ”“ 30ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((x=p.stats)==null?void 0:x.totalClears)||0}å›ï¼‰`},clear_40_stages:{desc:"ğŸ”“ 40ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((C=p.stats)==null?void 0:C.totalClears)||0}å›ï¼‰`},clear_50_stages:{desc:"ğŸ”“ 50ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((T=p.stats)==null?void 0:T.totalClears)||0}å›ï¼‰`},challenge_3_streak:{desc:"ğŸ”“ ãƒãƒ£ãƒ¬ãƒ³ã‚¸3é€£ç¶šã§è§£æ”¾",progress:`ï¼ˆæœ€é«˜: ${((O=p.stats)==null?void 0:O.challengeHighScore)||0}é€£ç¶šï¼‰`},challenge_5_streak:{desc:"ğŸ”“ ãƒãƒ£ãƒ¬ãƒ³ã‚¸5é€£ç¶šã§è§£æ”¾",progress:`ï¼ˆæœ€é«˜: ${((k=p.stats)==null?void 0:k.challengeHighScore)||0}é€£ç¶šï¼‰`},challenge_10_streak:{desc:"ğŸ”“ ãƒãƒ£ãƒ¬ãƒ³ã‚¸10é€£ç¶šã§è§£æ”¾",progress:`ï¼ˆæœ€é«˜: ${((b=p.stats)==null?void 0:b.challengeHighScore)||0}é€£ç¶šï¼‰`},golden_3_times:{desc:"ğŸ”“ ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¯ãƒ³ã‚³3å›ã§è§£æ”¾",progress:`ï¼ˆç¾åœ¨: ${((B=p.stats)==null?void 0:B.goldenClears)||0}å›ï¼‰`},use_all_4_dogs:{desc:"ğŸ”“ åˆæœŸ4çŠ¬ç¨®ã‚’1å›ãšã¤ä½¿ç”¨ã§è§£æ”¾",progress:""},all_paws_unlocked:{desc:"ğŸŒˆ å…¨ã¦ã®è‚‰çƒã‚«ãƒ©ãƒ¼ã‚’é›†ã‚ã‚‹ã¨è§£æ”¾ï¼",progress:`ï¼ˆç¾åœ¨: ${((A=p.unlockedNikukyuColors)==null?void 0:A.length)||1}/15ï¼‰`}}[e.unlockCondition];P&&(c=P.desc,d=P.progress)}const u=this.add.text(0,50,c,{...D.body,fontSize:"13px",color:"#FFFFFF",align:"center",wordWrap:{width:240}}).setOrigin(.5);if(o.add(u),d){const R=this.add.text(0,85,d,{fontSize:"11px",color:"#AAAAAA",align:"center"}).setOrigin(.5);o.add(R)}i.on("pointerup",()=>{o.destroy(),i.destroy()}),o.setScale(.8),o.setAlpha(0),this.tweens.add({targets:o,scale:1,alpha:1,duration:150,ease:"Back.easeOut"})}}const Yt={1:{origin:"ã«ã»ã‚“",personality:"ã¡ã‚…ã†ã˜ã¤",trivia:`ã—ã£ã½ãŒãã‚‹ã‚“ã¨
ã¾ã‚‹ã¾ã£ã¦ã„ã‚‹ã‚ˆï¼`,funFact:`ã€ŒæŸ´ã€ã¯å°ã•ã„ã¨ã„ã†
æ„å‘³ãªã‚“ã ã‚ˆï¼`},2:{origin:"ã¡ã‚…ã†ã”ã",personality:"ã‚ã‹ã‚‹ã„",trivia:`ã—ã‚ã—ã‚ã®é¡”ãŒ
ãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆï¼`,funFact:`æ˜”ã¯ç‹æ§˜ã®ãƒšãƒƒãƒˆ
ã ã£ãŸã‚“ã ã‚ˆï¼`},3:{origin:"ãƒ•ãƒ©ãƒ³ã‚¹",personality:"ã‹ã—ã“ã„",trivia:`ã‘ãŒæŠœã‘ã«ãã„ã‹ã‚‰
ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã«ã‚„ã•ã—ã„ï¼`,funFact:`æ°´ã«é£›ã³è¾¼ã‚€ç‹©ã‚ŠãŒ
å¾—æ„ã ã£ãŸã‚ˆï¼`},4:{origin:"ã‚·ãƒ™ãƒªã‚¢",personality:"ã’ã‚“ã",trivia:`ãã‚Šã‚’å¼•ãã®ãŒ
å¤§å¾—æ„ï¼`,funFact:`ã‚ªãƒƒãƒ‰ã‚¢ã‚¤ã®å­ã‚‚
ã„ã‚‹ã‚“ã ã‚ˆï¼`},5:{origin:"ã‚¤ã‚®ãƒªã‚¹",personality:"ã‚„ã•ã—ã„",trivia:`ãã‚“ã„ã‚ã®æ¯›ãŒ
ã¨ã£ã¦ã‚‚ãã‚Œã„ï¼`,funFact:`äººã‚’åŠ©ã‘ã‚‹ä»•äº‹ãŒ
å¤§å¥½ããªã‚“ã ã‚ˆï¼`},6:{origin:"ã‚¦ã‚§ãƒ¼ãƒ«ã‚º",personality:"ã‹ã£ã±ã¤",trivia:`ãŠã—ã‚ŠãŒ
ã·ã‚Šã·ã‚Šã§ã‹ã‚ã„ã„ï¼`,funFact:`ã‚¤ã‚®ãƒªã‚¹å¥³ç‹ã®
æ„›çŠ¬ã ã£ãŸã‚ˆï¼`},7:{origin:"ã‚¯ãƒ­ã‚¢ãƒã‚¢",personality:"ã†ã‚“ã©ã†ãšã",trivia:`ã†ã¾ã‚ŒãŸæ™‚ã¯
ã¾ã£ã—ã‚ãªã‚“ã ã‚ˆï¼`,funFact:`æ¶ˆé˜²ç½²ã®
ãƒã‚¹ã‚³ãƒƒãƒˆã ã‚ˆï¼`},8:{origin:"ãƒ¡ã‚­ã‚·ã‚³",personality:"ã‚†ã†ã‹ã‚“",trivia:`ä¸–ç•Œä¸€ã¡ã„ã•ã„
çŠ¬ç¨®ã ã‚ˆï¼`,funFact:`ã¡ã„ã•ã„ã‘ã©
å‹‡æ•¢ãªã‚“ã ï¼`},9:{origin:"ãƒ‰ã‚¤ãƒ„",personality:"ã—ã£ã‹ã‚Šã‚‚ã®",trivia:`ç«‹æ´¾ãªã²ã’ãŒ
ãŠã˜ã„ã•ã‚“ã¿ãŸã„ï¼`,funFact:`ãƒã‚ºãƒŸæ•ã‚ŠãŒ
å¾—æ„ã ã£ãŸã‚“ã ï¼`},10:{origin:"ãƒ‰ã‚¤ãƒ„",personality:"ã¡ã‚…ã†ã˜ã¤",trivia:`ã‚¹ãƒãƒ¼ãƒˆã§ã‹ã£ã“ã„ã„ï¼
è­¦å¯ŸçŠ¬ã¨ã—ã¦ã‚‚æ´»èºï¼`,funFact:`ç¨é‡‘ã‚’é›†ã‚ã‚‹äººãŒ
ä½œã£ãŸçŠ¬ç¨®ãªã‚“ã ã‚ˆï¼`},11:{origin:"ã‚¹ã‚¤ã‚¹",personality:"ãŠã ã‚„ã‹",trivia:`ã¨ã£ã¦ã‚‚å¤§ãã„ã‘ã©
å„ªã—ã„å·¨äººã ã‚ˆï¼`,funFact:`é›ªå±±ã§é­é›£ã—ãŸäººã‚’
åŠ©ã‘ã¦ã„ãŸã‚“ã ã‚ˆï¼`},12:{origin:"ãƒ­ã‚·ã‚¢",personality:"ãã²ã‚“",trivia:`é•·ã„è¶³ã§
ã¨ã¦ã‚‚é€Ÿãèµ°ã‚Œã‚‹ã‚ˆï¼`,funFact:`ãƒ­ã‚·ã‚¢ã®è²´æ—ã«
æ„›ã•ã‚Œã¦ã„ãŸã‚ˆï¼`},13:{origin:"ã‚¹ã‚¤ã‚¹",personality:"ã‚„ã•ã—ã„",trivia:`é»’ãƒ»ç™½ãƒ»èŒ¶ã®
ä¸‰è‰²ãŒãã‚Œã„ï¼`,funFact:`ã‚¢ãƒ«ãƒ—ã‚¹ã®è¾²å ´ã§
åƒã„ã¦ã„ãŸã‚ˆï¼`},14:{origin:"ã‚·ãƒ™ãƒªã‚¢",personality:"ã«ã“ã«ã“",trivia:`ã„ã¤ã‚‚ç¬‘ã£ã¦ã‚‹ã¿ãŸã„ãª
ãŠé¡”ãŒã‹ã‚ã„ã„ï¼`,funFact:`ã‚µãƒ¢ã‚¨ãƒ‰ã‚¹ãƒã‚¤ãƒ«ã§
æœ‰åãªã‚“ã ã‚ˆï¼`},15:{origin:"ãƒ‰ã‚¤ãƒ„",personality:"ãŠãŠã‚‰ã‹",trivia:`ä¸–ç•Œä¸€èƒŒãŒé«˜ã„
çŠ¬ç¨®ã ã‚ˆï¼`,funFact:`ã‚¹ã‚¯ãƒ¼ãƒ“ãƒ¼ãƒ‰ã‚¥ãƒ¼ã®
ãƒ¢ãƒ‡ãƒ«ãªã‚“ã ã‚ˆï¼`},16:{origin:"ã‚¤ã‚®ãƒªã‚¹",personality:"ã‚ã¾ãˆã‚“ã¼ã†",trivia:`ãµã‚ãµã‚ã®è€³ãŒ
ãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆï¼`,funFact:`ã‚¤ã‚®ãƒªã‚¹ç‹å®¤ã§
æ„›ã•ã‚Œã¦ã„ãŸã‚ˆï¼`},17:{origin:"ã‚¤ã‚®ãƒªã‚¹",personality:"ã’ã‚“ãã„ã£ã±ã„",trivia:`ã¡ã„ã•ã„ã‘ã©
ã™ã”ã„ãƒ‘ãƒ¯ãƒ¼ï¼`,funFact:`ã‚­ãƒ„ãƒç‹©ã‚Šã®ãŸã‚ã«
ç”Ÿã¾ã‚ŒãŸçŠ¬ç¨®ã ã‚ˆï¼`},18:{origin:"ãƒ•ãƒ©ãƒ³ã‚¹",personality:"ãŠã—ã‚ƒã‚Œ",trivia:`è¶ã€…ã¿ãŸã„ãªè€³ãŒ
ã¨ã£ã¦ã‚‚ãã‚Œã„ï¼`,funFact:`ã€Œãƒ‘ãƒ”ãƒ¨ãƒ³ã€ã¯
ãƒ•ãƒ©ãƒ³ã‚¹èªã§è¶ã€…ï¼`},19:{origin:"ã‚¤ã‚®ãƒªã‚¹",personality:"ã‚„ã•ã—ã„",trivia:`ã“ã‚ãã†ãªé¡”ã ã‘ã©
å®Ÿã¯ã¨ã£ã¦ã‚‚ç”˜ãˆã‚“åŠï¼`,funFact:`ã‚¤ã‚®ãƒªã‚¹ã®
ãƒã‚¹ã‚³ãƒƒãƒˆã ã‚ˆï¼`},20:{origin:"ã«ã»ã‚“",personality:"ã‚¯ãƒ¼ãƒ«",trivia:`é»’ã„æ¯›ä¸¦ã¿ãŒ
ã‹ã£ã“ã„ã„ï¼`,funFact:`æŸ´çŠ¬ã®ä¸­ã§ã‚‚
çã—ã„é»’æ¯›ã ã‚ˆï¼`},21:{origin:"ã‚¢ãƒ¡ãƒªã‚«",personality:"ã‚ã¾ãˆã‚“ã¼ã†",trivia:`ãƒãƒ¯ãƒ¯ã¨ãƒ—ãƒ¼ãƒ‰ãƒ«ã®
ãƒŸãƒƒã‚¯ã‚¹ã ã‚ˆï¼`,funFact:`ãµã‚ãµã‚ã§
ã¨ã£ã¦ã‚‚äººæ°—ï¼`},22:{origin:"ãƒ‰ã‚¤ãƒ„",personality:"ã“ã†ãã—ã‚“",trivia:`çŸ­ã„è¶³ã¨é•·ã„ä½“ãŒ
ãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆï¼`,funFact:`ã‚ãªãã‚‰ã«å…¥ã£ã¦
ç‹©ã‚Šã‚’ã—ã¦ã„ãŸã‚ˆï¼`},23:{origin:"ãƒ•ãƒ©ãƒ³ã‚¹",personality:"ã‚ã‹ã‚‹ã„",trivia:`ã¾ã‚‹ã§ç¶¿ã‚ã‚ã¿ãŸã„ãª
ãµã‚ãµã‚ã®æ¯›ï¼`,funFact:`ã‚µãƒ¼ã‚«ã‚¹ã§
æ´»èºã—ã¦ã„ãŸã‚ˆï¼`},24:{origin:"ãƒ‰ã‚¤ãƒ„",personality:"ã’ã‚“ã",trivia:`ãµã‚ãµã‚ã®æ¯›ãŒ
è‡ªæ…¢ã ã‚ˆï¼`,funFact:`æ˜”ã¯ã‚‚ã£ã¨
å¤§ãã‹ã£ãŸã‚“ã ã‚ˆï¼`},25:{origin:"ã¡ã‚…ã†ã”ã",personality:"ã©ã£ã—ã‚Š",trivia:`ãƒ©ã‚¤ã‚ªãƒ³ã¿ãŸã„ãª
ãŸã¦ãŒã¿ãŒã™ã”ã„ï¼`,funFact:`èˆŒãŒé’ã„ã®ãŒ
ç‰¹å¾´ã ã‚ˆï¼`},26:{origin:"ã‚«ãƒŠãƒ€",personality:"ã‚„ã•ã—ã„",trivia:`ã¨ã£ã¦ã‚‚å¤§ããã¦
æ³³ããŒå¾—æ„ï¼`,funFact:`æµ·é›£æ•‘åŠ©çŠ¬ã¨ã—ã¦
æ´»èºã—ã¦ã„ãŸã‚ˆï¼`},27:{origin:"ã¡ã‚…ã†ã”ã",personality:"ã¡ã‚…ã†ã˜ã¤",trivia:`ã—ã‚ã—ã‚ã®çš®è†šãŒ
ãƒãƒ£ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆï¼`,funFact:`ä¸–ç•Œã§ä¸€ç•ªçã—ã„
çŠ¬ç¨®ã®ã²ã¨ã¤ã ã‚ˆï¼`},28:{origin:"ã¡ã‚…ã†ã”ã",personality:"ãŠã¡ã‚ƒã‚",trivia:`æ¯›ãŒãªã„ã®ãŒ
ç‰¹å¾´ã ã‚ˆï¼`,funFact:`å®Ÿã¯ã¨ã£ã¦ã‚‚
ã‚ã£ãŸã‹ã„ã‚“ã ï¼`},29:{origin:"???",personality:"ãã‚‰ãã‚‰",trivia:`é‡‘è‰²ã«è¼ã
ä¼èª¬ã®ãƒ¯ãƒ³ã‚³ï¼`,funFact:`è¦‹ã¤ã‘ãŸã‚ãªãŸã¯
ã¨ã£ã¦ã‚‚ãƒ©ãƒƒã‚­ãƒ¼ï¼`},30:{origin:"ã‚¤ã‚®ãƒªã‚¹",personality:"ã¨ã£ã¦ã‚‚ã‹ã—ã“ã„",trivia:`ä¸–ç•Œä¸€ã‚ãŸã¾ãŒã„ã„
çŠ¬ç¨®ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ã‚ˆï¼`,funFact:`ã²ã¤ã˜ã‚’è¿½ã„ã‹ã‘ã‚‹
ã®ãŒå¾—æ„ï¼`},31:{origin:"ã‚¤ã‚®ãƒªã‚¹",personality:"ã“ã†ãã—ã‚“ãŠã†ã›ã„",trivia:`ã™ã”ã„é¼»ã‚’æŒã£ã¦ã„ã¦
ã«ãŠã„ã‚’è¿½ã„ã‹ã‘ã‚‹ã®ãŒå¤§å¥½ãï¼`,funFact:`ã‚¹ãƒŒãƒ¼ãƒ”ãƒ¼ã®
ãƒ¢ãƒ‡ãƒ«ãªã‚“ã ã‚ˆï¼`},32:{origin:"ãƒãƒ«ã‚¿",personality:"ã‚ã¾ãˆã‚“ã¼ã†",trivia:`çœŸã£ç™½ã§ã‚·ãƒ«ã‚¯ã¿ãŸã„ãª
æ¯›ä¸¦ã¿ãŒã™ã¦ãï¼`,funFact:`å¤ä»£ãƒ­ãƒ¼ãƒæ™‚ä»£ã‹ã‚‰
æ„›ã•ã‚Œã¦ããŸã‚ˆï¼`},33:{origin:"???",personality:"ã¡ãã‚ã£ã½ã„",trivia:`ãƒãƒ¯ãƒ¯ã˜ã‚ƒãªã„ã€‚
ãƒã‚¯ãƒ¯ã€‚`,funFact:`ãªãœã‹ã¡ãã‚ã®
ã«ãŠã„ãŒã™ã‚‹ï¼`},34:{origin:"???",personality:"ãµã‚ãµã‚",trivia:`ã»ã¼ã‚ãŸã‚ã‚
ã§ã‚ã‚‹ã€‚`,funFact:`ã‚‚ãµã‚‚ãµã—ã™ãã¦
ç‹æ§˜ã«ãªã£ãŸï¼`},35:{origin:"???",personality:"ãƒ¡ã‚«ãƒ‹ã‚«ãƒ«",trivia:`å¼·åŒ–æ”¹é€ ã•ã‚ŒãŸ
ã‚µã‚¤ãƒœãƒ¼ã‚°ãƒ¯ãƒ³ã‚³ã€‚`,funFact:`ã§ã‚‚ä¸­èº«ã¯
ã¨ã£ã¦ã‚‚ã‚„ã•ã—ã„ï¼`},36:{origin:"???",personality:"ãƒãƒŠãƒŠãšã",trivia:"ãƒãƒŠãƒŠã ã„ã™ãã€‚",funFact:`ã„ã¤ã‚‚ãƒãƒŠãƒŠã‚’
æŒã¡æ­©ã„ã¦ã„ã‚‹ï¼`},37:{origin:"???",personality:"ã¶ã—ã©ã†",trivia:"æ­¦å£«ã«ã‚ã“ãŒã‚Œã¦ã„ã‚‹ã€‚",funFact:`ã‹ã£ã“ã„ã„
ã‚ˆã‚ã„ãŒãŠæ°—ã«å…¥ã‚Šï¼`},38:{origin:"???",personality:"ã‚ã¤ã„",trivia:`ã¨ã‚ã‚‹ã‚¢ãƒ‹ãƒ¡ã‚’
è¦‹ãŸã‚µãƒ¢ã‚¨ãƒ‰ã€‚`,funFact:`å¿ƒã‚’ç‡ƒã‚„ã›ï¼ãŒ
å£ãã›ï¼`},39:{origin:"???",personality:"ã‹ã‚ã„ã„",trivia:`ãŠæ°—ã«å…¥ã‚Šã®
ããã‚‹ã¿ã‚’ç€ãŸãƒã‚¹ã‚­ãƒ¼ã€‚`,funFact:`ãŒãŠãƒ¼ï¼ã£ã¦
è¨€ã†ã®ãŒå¥½ãï¼`},40:{origin:"???",personality:"ãƒ‘ãƒ¯ãƒ•ãƒ«",trivia:"åŠ›ã“ãå…¨ã¦â€¦ï¼",funFact:`ã§ã‚‚å®Ÿã¯
ãƒãƒŠãƒŠãŒå¤§å¥½ãï¼`}};class Vt extends w.Scene{constructor(){super({key:"ZukanScene"})}init(e){this.tutorialMode=(e==null?void 0:e.tutorialMode)||!1,this.tutorialContainer=null,this.goldenCard=null}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select");const t=this.add.image(e/2,s/2,"zukan_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n).setDepth(0),this.createHeader(),this.createDogList(),this.cameras.main.fadeIn(300),this.tutorialMode&&this.time.delayedCall(500,()=>{this.showZukanTutorial()})}createHeader(){const{width:e}=this.scale,s=M.TOP;this.createBackButton(50,s+32),this.add.text(e/2,s+32,"ğŸ“– ãšã‹ã‚“",{...D.heading,fontSize:"22px"}).setOrigin(.5).setDepth(101)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.setDepth(101),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("MainMenuScene"))}),t}createDogList(){const{width:e,height:s}=this.scale,t=M.TOP+75,i=s-t-M.BOTTOM-10,o=Object.entries(z).filter(([R,P])=>{const $=parseInt(R);return!(P.isLegendary||P.isSecret&&!v.isDogUnlocked(p,$))}),n=Object.entries(z).filter(([R,P])=>P.isLegendary),r=3,a=105,l=8,c=8,d=Math.ceil(o.length/r),u=Math.ceil(n.length/r),f=n.length>0?100+u*(95+c+12)+40:0,g=d*(a+c+12)+45+f,m=r*a+(r-1)*l,y=(e-m)/2+a/2,S=this.add.graphics();S.fillStyle(0,.08),S.fillRoundedRect(18,t-8,e-32,i+10,20),S.fillStyle(16777215,1),S.fillRoundedRect(15,t-13,e-30,i+10,18),S.fillStyle(9268835,.7),S.fillRoundedRect(15,t-13,e-30,6,{tl:18,tr:18,bl:0,br:0});const F=Object.entries(z).filter(([R,P])=>!P.isLegendary&&R!=="5"),x=F.filter(([R])=>v.isDogUnlocked(p,parseInt(R))).length,C=x===F.length,T=C?`ğŸ• ã¿ã‚“ãªã¨ã‚‚ã ã¡ï¼ ${x}ã²ã`:`ğŸ• ${x}ã²ãã®ã¨ã‚‚ã ã¡`;if(this.add.text(e/2,t+14,T,{...D.section,fontSize:"16px",color:C?"#4CAF50":"#5D4037"}).setOrigin(.5),this.dogListContainer=this.add.container(0,0),o.forEach(([R,P],$)=>{const q=parseInt(R),j=y+$%r*(a+l),ce=t+90+Math.floor($/r)*(a+c+12),ne=this.createDogCard(j,ce,q,P);this.dogListContainer.add(ne),q===5&&(this.goldenCard=ne,this.goldenCardPos={x:j,y:ce})}),n.length>0){const R=t+90+d*(a+c+12)+20;this.createLegendarySection(R,n,this.dogListContainer)}const O=this.make.graphics();O.fillStyle(16777215),O.fillRect(0,t+35,e,i-50);const k=O.createGeometryMask();this.dogListContainer.setMask(k),this.scrollY=0,this.maxScroll=Math.max(0,g-i+100),this.isScrolling=!1,this.scrollBounds={top:t+35,bottom:t+i-15,left:15,right:e-15};let b=!1,B=0,A=0;this.input.on("pointerdown",R=>{R.y>=t+30&&R.y<=t+i&&R.x>=15&&R.x<=e-15&&(b=!0,B=R.y,A=this.scrollY,this.isScrolling=!1)}),this.input.on("pointermove",R=>{if(!b)return;Math.abs(R.y-B)>10&&(this.isScrolling=!0,this.scrollY=w.Math.Clamp(A-(R.y-B),0,this.maxScroll),this.dogListContainer.y=-this.scrollY)}),this.input.on("pointerup",()=>{b=!1,this.time.delayedCall(50,()=>{this.isScrolling=!1})})}createLegendarySection(e,s,t){const{width:i}=this.scale,o=95,n=3,r=8,a=8,c=90+Math.ceil(s.length/n)*(o+a+12)+30,d=this.add.graphics();d.fillStyle(16766720,.15),d.fillRoundedRect(20,e,i-40,c,16),d.fillStyle(16775910,1),d.fillRoundedRect(25,e+5,i-50,c-10,14),d.lineStyle(3,16766720,1),d.strokeRoundedRect(25,e+5,i-50,c-10,14),d.fillStyle(16766720,.9),d.fillRoundedRect(25,e+5,i-50,6,{tl:14,tr:14,bl:0,br:0}),t.add(d);const u=n*o+(n-1)*r,f=(i-u)/2+o/2;s.forEach(([m,y],S)=>{const F=parseInt(m),x=S%n,C=Math.floor(S/n),T=f+x*(o+r),O=e+120+C*(o+a+12),k=this.createLegendaryCard(T,O,F,y);t.add(k)});const g=this.add.text(i/2,e+50,"âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ âœ¨",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",fontStyle:"bold",color:"#B8860B",stroke:"#FFFFFF",strokeThickness:3}).setOrigin(.5);t.add(g)}createLegendaryCard(e,s,t,i){const o=v.isDogUnlocked(p,t),n=95,r=this.add.container(e,s),a=this.add.graphics();if(o?(a.fillStyle(16766720,.4),a.fillRoundedRect(-n/2-6,-n/2-6,n+12,n+12,16),a.fillStyle(16775388,1),a.fillRoundedRect(-n/2,-n/2,n,n,14),a.lineStyle(4,16766720,1),a.strokeRoundedRect(-n/2,-n/2,n,n,14)):(a.fillStyle(16766720,.2),a.fillRoundedRect(-n/2-4,-n/2-4,n+8,n+8,16),a.fillStyle(4013373,1),a.fillRoundedRect(-n/2,-n/2,n,n,14),a.lineStyle(3,16766720,.7),a.strokeRoundedRect(-n/2,-n/2,n,n,14)),r.add(a),o){const u=L.draw(this,0,-8,t,24,"happy");r.add(u)}else{const u=L.draw(this,0,-8,t,24,"neutral");u.setAlpha(.35),u.list.forEach(f=>{f.setTint&&f.setTint(1118481)}),r.add(u),this.addSparkleEffect(r,n)}const l=o?i.name:"ï¼Ÿï¼Ÿï¼Ÿ",c=l.length>=6?l.slice(0,Math.ceil(l.length/2))+`
`+l.slice(Math.ceil(l.length/2)):l,d=this.add.text(0,n/2-22,c,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",fontStyle:"bold",color:o?"#B8860B":"#FFD700",align:"center",lineSpacing:-2,stroke:o?"#FFFFFF":"#000000",strokeThickness:2}).setOrigin(.5);return r.add(d),r.setSize(n,n),r.setInteractive({useHandCursor:!0}),r.on("pointerdown",u=>{this.scrollBounds&&(u.y<this.scrollBounds.top||u.y>this.scrollBounds.bottom)||this.tweens.add({targets:r,scale:.93,duration:50})}),r.on("pointerup",u=>{this.tweens.add({targets:r,scale:1,duration:80}),!this.isScrolling&&(this.scrollBounds&&(u.y<this.scrollBounds.top||u.y>this.scrollBounds.bottom)||(o?this.showDogDetail(t,i):this.showLegendaryHint(t)))}),r.on("pointerout",()=>this.tweens.add({targets:r,scale:1,duration:80})),r}addSparkleEffect(e,s){[{x:-s/3,y:-s/3},{x:s/3,y:-s/4},{x:-s/4,y:s/5},{x:s/4,y:s/4}].forEach((i,o)=>{const n=this.add.text(i.x,i.y,"âœ¦",{fontSize:"10px",color:"#FFD700"}).setOrigin(.5).setAlpha(0);e.add(n),this.tweens.add({targets:n,alpha:{from:0,to:.9},scale:{from:.5,to:1.2},duration:600,delay:o*300,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})})}showLegendaryHint(e){const{width:s,height:t}=this.scale,i=this.add.rectangle(0,0,s,t,0,.7).setOrigin(0).setInteractive(),o=this.add.container(s/2,t/2),n=this.add.graphics();n.fillStyle(16766720,.25),n.fillRoundedRect(-145,-118,290,236,24),n.fillStyle(16775910,1),n.fillRoundedRect(-130,-105,260,210,18),n.lineStyle(5,16766720,1),n.strokeRoundedRect(-130,-105,260,210,18),n.fillStyle(16766720,.9),n.fillRoundedRect(-130,-105,260,8,{tl:18,tr:18,bl:0,br:0}),o.add(n);const r=this.add.text(0,-70,"âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ âœ¨",{fontFamily:"KeiFont, sans-serif",fontSize:"20px",fontStyle:"bold",color:"#B8860B",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);o.add(r);const a=he[e];let l=`ã¨ã£ã¦ã‚‚ ã‚ãšã‚‰ã—ã„
ãƒ¯ãƒ³ã‚³ã ã‚ˆï¼

ã©ã†ã‚„ã£ãŸã‚‰
ã‚ãˆã‚‹ã‹ãªâ€¦ï¼Ÿ`;a&&(l=`ã€ï¼Ÿï¼Ÿï¼Ÿã€‘

${a.description}`);const c=this.add.text(0,5,l,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#5D4037",align:"center",lineSpacing:4}).setOrigin(.5);o.add(c);const d=this.add.container(0,83),u=this.add.graphics();u.fillStyle(12092939,.3),u.fillRoundedRect(-52,-14,104,32,12),u.fillStyle(16766720,1),u.fillRoundedRect(-50,-16,100,32,10),u.fillStyle(16775388,1),u.fillRoundedRect(-48,-14,96,16,{tl:8,tr:8,bl:0,br:0}),d.add(u);const f=this.add.text(0,0,"ã¨ã˜ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",fontStyle:"bold",color:"#5D4037"}).setOrigin(.5);d.add(f),d.setSize(100,32),d.setInteractive({useHandCursor:!0}),o.add(d),d.on("pointerover",()=>{this.tweens.add({targets:d,scale:1.08,duration:80})}),d.on("pointerout",()=>{this.tweens.add({targets:d,scale:1,duration:80})});const g=()=>{i.destroy(),o.destroy()};i.on("pointerup",g),d.on("pointerup",g)}createDogCard(e,s,t,i){const o=v.isDogUnlocked(p,t),n=95,r=this.add.container(e,s),a=this.add.graphics();if(o?(a.fillStyle(0,.06),a.fillRoundedRect(-n/2+3,-n/2+3,n,n,14),a.fillStyle(16776181,1),a.fillRoundedRect(-n/2,-n/2,n,n,14),a.lineStyle(3,i.color,.8),a.strokeRoundedRect(-n/2,-n/2,n,n,14)):(a.fillStyle(0,.04),a.fillRoundedRect(-n/2+2,-n/2+2,n,n,14),a.fillStyle(11053224,1),a.fillRoundedRect(-n/2,-n/2,n,n,14),a.lineStyle(2,9474192,1),a.strokeRoundedRect(-n/2,-n/2,n,n,14)),r.add(a),o){const u=L.draw(this,0,-8,t,24,"happy");r.add(u)}else{const u=L.draw(this,0,-8,t,24,"neutral");u.setAlpha(.5),u.list.forEach(f=>{f.setTint&&f.setTint(2236962)}),r.add(u)}const l=o?i.name:"ï¼Ÿï¼Ÿï¼Ÿ",c=l.length>=6?l.slice(0,Math.ceil(l.length/2))+`
`+l.slice(Math.ceil(l.length/2)):l,d=this.add.text(0,n/2-22,c,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:o?I.textDark:"#888888",align:"center",lineSpacing:-2}).setOrigin(.5);return r.add(d),r.setSize(n,n),r.setInteractive({useHandCursor:!0}),r.on("pointerdown",u=>{this.scrollBounds&&(u.y<this.scrollBounds.top||u.y>this.scrollBounds.bottom)||this.tweens.add({targets:r,scale:.93,duration:50})}),r.on("pointerup",u=>{this.tweens.add({targets:r,scale:1,duration:80}),!this.isScrolling&&(this.scrollBounds&&(u.y<this.scrollBounds.top||u.y>this.scrollBounds.bottom)||(o?this.showDogDetail(t,i):this.showUnlockCondition(t)))}),r.on("pointerout",()=>this.tweens.add({targets:r,scale:1,duration:80})),r}showDogDetail(e,s){var x;const{width:t,height:i}=this.scale,o=Yt[e]||{},n=this.add.rectangle(0,0,t,i,0,.6).setOrigin(0).setInteractive(),r=this.add.container(t/2,i/2),a=this.add.graphics();a.fillStyle(16777215,1),a.fillRoundedRect(-150,-180,300,360,16),a.lineStyle(3,s.color,1),a.strokeRoundedRect(-150,-180,300,360,16),r.add(a);const l=L.draw(this,0,-110,e,35,"happy");r.add(l);const c=this.add.text(0,-55,s.name,{...D.heading,fontSize:"24px"}).setOrigin(.5);r.add(c);const d=(x=p.dogUnlockDates)==null?void 0:x[e];let u="";if(d){const C=new Date(d),T=C.getMonth()+1,O=C.getDate();u=`${T}ãŒã¤ ${O}ã«ã¡`}const f=-25,g=[`ğŸŒ ã’ã‚“ã•ã‚“ã¡: ${o.origin||"???"}`,`ğŸ’– ã›ã„ã‹ã: ${o.personality||"???"}`];u&&g.push(`ğŸ“… ã§ã‚ã£ãŸã²: ${u}`),g.forEach((C,T)=>{const O=this.add.text(0,f+T*22,C,{...D.body,fontSize:"12px"}).setOrigin(.5);r.add(O)});const m=g.length>2?55:50,y=this.add.text(0,m,`ğŸ“ ${o.trivia||"???"}`,{...D.body,fontSize:"11px",align:"center",lineSpacing:3,wordWrap:{width:270}}).setOrigin(.5);r.add(y);const S=this.add.text(0,110,`ğŸ’¡ ${o.funFact||"???"}`,{...D.small,fontSize:"10px",color:"#666666",align:"center",lineSpacing:3,wordWrap:{width:270}}).setOrigin(.5);r.add(S);const F=this.add.text(0,155,"â¤ï¸ ã¨ã˜ã‚‹",{...D.button,fontSize:"16px",backgroundColor:"#FF6B8A",padding:{x:30,y:8}}).setOrigin(.5).setInteractive({useHandCursor:!0});r.add(F),F.on("pointerup",()=>{r.destroy(),n.destroy()}),n.on("pointerup",()=>{r.destroy(),n.destroy()}),r.setScale(.5),r.setAlpha(0),this.tweens.add({targets:r,scale:1,alpha:1,duration:200,ease:"Back.easeOut"})}showUnlockCondition(e){const{width:s,height:t}=this.scale,i=Object.values(ve).find(f=>f.dogId===e),o=this.add.rectangle(0,0,s,t,0,.5).setOrigin(0).setInteractive(),n=this.add.container(s/2,t/2),r=this.add.graphics();r.fillStyle(3355443,1),r.fillRoundedRect(-140,-120,280,240,12),n.add(r);const a=L.draw(this,0,-55,e,32,"neutral");a.setAlpha(.6),a.list.forEach(f=>{f.setTint&&f.setTint(1118481)}),n.add(a);const l=this.add.text(0,5,"ï¼Ÿï¼Ÿï¼Ÿ",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF"}).setOrigin(.5);n.add(l);let c,d="";e===29?c="ğŸ”“ ï¼Ÿï¼Ÿï¼Ÿ":i?i.isSecret?c="ğŸ”“ ï¼Ÿï¼Ÿï¼Ÿ":(c=`ğŸ”“ ${i.description}`,d=this.getProgressText(i.condition)):c="ğŸ”“ ???";const u=this.add.text(0,50,c,{...D.body,fontSize:"13px",color:"#FFFFFF",align:"center",wordWrap:{width:240}}).setOrigin(.5);if(n.add(u),d){const f=this.add.text(0,85,d,{fontSize:"11px",color:"#AAAAAA",align:"center"}).setOrigin(.5);n.add(f)}o.on("pointerup",()=>{n.destroy(),o.destroy()}),n.setScale(.8),n.setAlpha(0),this.tweens.add({targets:n,scale:1,alpha:1,duration:150,ease:"Back.easeOut"})}getProgressText(e){var n,r,a,l;if(!e)return"";const s=p.stats||{};let t=0,i=e.value||0,o="";switch(e.type){case"total_clears":t=s.totalClears||0,o="å›ã‚¯ãƒªã‚¢";break;case"total_pieces":t=s.totalPieces||0,o="ãƒ”ãƒ¼ã‚¹";break;case"max_combo":t=s.maxComboCount||0,o="ã‚³ãƒ³ãƒœ";break;case"consecutive_clears":t=s.consecutiveClears||0,o="é€£ç¶š";break;case"consecutive_logins":t=s.consecutiveLogins||0,o="æ—¥";break;case"challenge_streak":t=s.challengeHighScore||0,o="é€£å‹";break;case"golden_clears":t=s.goldenClears||0,o="å›";break;case"no_miss_clears":t=s.noMissClears||0,o="å›";break;case"weekly_complete":t=((n=p.rewards)==null?void 0:n.totalWeeklyComplete)||0,o="å›";break;case"theme_clears":t=((r=s.themeClears)==null?void 0:r[e.theme])||0,o="å›";break;case"day_of_week_clears":t=((a=s.dayOfWeekClears)==null?void 0:a[e.day])||0,o="å›";break;case"dog_specific_clears":t=((l=s.dogSpecificClears)==null?void 0:l[e.dogId])||0,o="å›";break;default:return""}return`ï¼ˆç¾åœ¨: ${t}${o} / ${i}${o}ï¼‰`}showZukanTutorial(){const{width:e,height:s}=this.scale;this.tutorialContainer=this.add.container(0,0).setDepth(1e3);const t=this.add.graphics();if(t.fillStyle(0,.7),t.fillRect(0,0,e,s),this.tutorialContainer.add(t),this.goldenCardPos){const a=this.add.graphics();a.fillStyle(16766720,.4),a.fillRoundedRect(this.goldenCardPos.x-55,this.goldenCardPos.y-55,110,110,16),this.tutorialContainer.add(a),this.tweens.add({targets:a,alpha:{from:.4,to:.7},scaleX:{from:1,to:1.05},scaleY:{from:1,to:1.05},duration:500,yoyo:!0,repeat:-1});const l=this.add.text(this.goldenCardPos.x,this.goldenCardPos.y-70,"ğŸ‘‡",{fontSize:"32px"}).setOrigin(.5);this.tutorialContainer.add(l),this.tweens.add({targets:l,y:this.goldenCardPos.y-60,duration:400,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}const i=s*.78,o=this.add.graphics();o.fillStyle(16777215,.95),o.fillRoundedRect(30,i-50,e-60,130,16),this.tutorialContainer.add(o);const n=this.add.text(e/2,i-15,`ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ã‚’
ã‚¿ãƒƒãƒ—ã—ã¦è¨­å®šã—ã‚ˆã†ï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);this.tutorialContainer.add(n);const r=this.add.text(e/2,i+35,"ãŠæ°—ã«å…¥ã‚Šã®ãƒ¯ãƒ³ã‚³ã‚’é¸ã‚“ã§éŠã¼ã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#8D6E63"}).setOrigin(.5);this.tutorialContainer.add(r),this.waitForGoldenSelection()}waitForGoldenSelection(){const e=this.time.addEvent({delay:100,callback:()=>{p.selectedDogs.includes(5)&&(e.destroy(),this.completeTutorial())},loop:!0}),s=this.add.rectangle(this.scale.width/2,this.scale.height/2,this.scale.width,this.scale.height,0,0).setInteractive({useHandCursor:!0});this.tutorialContainer.add(s),s.on("pointerdown",()=>{this.hideTutorialOverlay()})}completeTutorial(){const{width:e,height:s}=this.scale;p.tutorial.completed=!0,p.tutorial.inProgress=!1,v.save(p),this.hideTutorialOverlay(),this.tutorialContainer=this.add.container(0,0).setDepth(1e3);const t=this.add.graphics();t.fillStyle(0,.6),t.fillRect(0,0,e,s),this.tutorialContainer.add(t);const i=e-60,o=260,n=s/2,r=this.add.graphics();r.fillStyle(16777215,.98),r.fillRoundedRect(-i/2+e/2,n-o/2,i,o,20),this.tutorialContainer.add(r);const a=this.add.text(e/2,n-70,"ğŸ‰ æº–å‚™ã‹ã‚“ã‚Šã‚‡ã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#FF6F00",fontStyle:"bold"}).setOrigin(.5);this.tutorialContainer.add(a);const l=this.add.text(e/2,n-15,`ã“ã‚Œã§æº–å‚™ã¯OKï¼
ã„ã£ã±ã„éŠã‚“ã§ã­ï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:"#5D4037",align:"center"}).setOrigin(.5);this.tutorialContainer.add(l);const c=this.add.text(e/2,n+45,`ãã‚‡ã†ã®ãŠã•ã‚“ã½ã‚’é”æˆã™ã‚‹ã¨
ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«ãŒã‚‚ã‚‰ãˆã‚‹ã‚ˆï¼
ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«ã¯ ãã›ã‹ãˆã®
ã“ã†ã‹ã‚“ã§ä½¿ãˆã‚‹ã‚ˆï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#6D4C41",align:"center",lineSpacing:4}).setOrigin(.5);this.tutorialContainer.add(c);const d=160,u=50,f=n+110,g=this.add.container(e/2,f),m=this.add.graphics();m.fillStyle(16748288,1),m.fillRoundedRect(-d/2,-u/2,d,u,u/2),g.add(m);const y=this.add.text(0,0,"ã¯ã˜ã‚ã‚‹ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);g.add(y),g.setSize(d,u),g.setInteractive({useHandCursor:!0}),this.tutorialContainer.add(g),g.on("pointerover",()=>this.tweens.add({targets:g,scale:1.05,duration:80})),g.on("pointerout",()=>this.tweens.add({targets:g,scale:1,duration:80})),g.on("pointerdown",()=>{this.tweens.add({targets:g,scale:.95,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),g.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{this.scene.start("MainMenuScene")})})}hideTutorialOverlay(){this.tutorialContainer&&(this.tutorialContainer.destroy(),this.tutorialContainer=null)}}class jt extends w.Scene{constructor(){super({key:"DogSelectScene"})}init(e){e&&e.selectedDogs&&e.selectedDogs.length>0?this.selectedDogs=[...e.selectedDogs]:this.selectedDogs=[...p.selectedDogs],this.tutorialMode=(e==null?void 0:e.tutorialMode)||!1,this.tutorialContainer=null,this.dogOptionMap=new Map,this.dogGridStartY=0,this.dogGridVisibleHeight=0,this.dogGridMaxScroll=0}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select");const t=this.add.image(e/2,s/2,"erabu_bg"),i=e/t.width,o=s/t.height,n=Math.max(i,o);t.setScale(n).setDepth(0),this.createHeader(),this.createSelectedDisplay(),this.createDogGrid(),this.createConfirmButton(),this.cameras.main.fadeIn(300),this.tutorialMode&&!p.tutorial.completed&&!this.selectedDogs.includes(5)&&this.time.delayedCall(500,()=>{this.showErabuTutorial()})}createHeader(){var o;const{width:e}=this.scale,s=M.TOP;this.tutorialMode&&!((o=p.tutorial)!=null&&o.completed)||this.createBackButton(50,s+32),this.add.text(e/2,s+32,"ğŸ• ãˆã‚‰ã¶",{...D.heading,fontSize:"22px"}).setOrigin(.5).setDepth(101)}createBackButton(e,s){const t=this.add.container(e,s),i=this.add.graphics();i.fillStyle(16777215,.95),i.fillRoundedRect(-38,-16,76,32,10),i.lineStyle(2.5,z[3].color,1),i.strokeRoundedRect(-38,-16,76,32,10);const o=this.add.text(0,0,"â† ã‚‚ã©ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"13px",fontStyle:"bold",color:"#5D4037",stroke:"#FFFFFF",strokeThickness:2}).setOrigin(.5);return t.add([i,o]),t.setSize(76,32),t.setInteractive({useHandCursor:!0}),t.setDepth(101),t.on("pointerover",()=>this.tweens.add({targets:t,scale:1.08,duration:80})),t.on("pointerout",()=>this.tweens.add({targets:t,scale:1,duration:80})),t.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("MainMenuScene"))}),t}createSelectedDisplay(){const{width:e}=this.scale,s=M.TOP+75,t=this.add.graphics();t.fillStyle(0,.08),t.fillRoundedRect(18,s-3,e-32,115,20),t.fillStyle(16777215,1),t.fillRoundedRect(15,s-8,e-30,115,18);const i=this.selectedDogs.length,o=i===4?16766720:16747520;t.fillStyle(o,.9),t.fillRoundedRect(15,s-8,e-30,6,{tl:18,tr:18,bl:0,br:0});const n=i===4?"ğŸ¾ ã¤ã‹ã†ãƒ¯ãƒ³ã‚³ï¼ˆ4ã²ãï¼‰":`ğŸ¾ ã¤ã‹ã†ãƒ¯ãƒ³ã‚³ï¼ˆ${i}/4ã²ãï¼‰`,r=i===4?"#5D4037":"#E65100";this.add.text(e/2,s+16,n,{...D.section,fontSize:"16px",color:r}).setOrigin(.5),this.selectedContainer=this.add.container(e/2,s+65),this.updateSelectedDisplay()}updateSelectedDisplay(){this.selectedContainer.removeAll(!0);const e=65,s=-1.5*e;this.selectedDogs.forEach((t,i)=>{const o=s+i*e,n=L.draw(this,o,0,t,22,"happy");this.selectedContainer.add(n)})}createDogGrid(){const{width:e,height:s}=this.scale,t=M.TOP+210,i=s-t-M.BOTTOM-70;this.dogGridStartY=t,this.dogGridVisibleHeight=i;const o=Object.entries(z).filter(([k,b])=>!(b.isLegendary||b.isSecret&&!v.isDogUnlocked(p,parseInt(k)))),n=Object.entries(z).filter(([k,b])=>b.isLegendary),r=3,a=105,l=8,c=8,d=Math.ceil(o.length/r),u=Math.ceil(n.length/r),f=n.length>0?100+u*(95+c+12)+40:0,g=d*(a+c+12)+70+f,m=r*a+(r-1)*l,y=(e-m)/2+a/2,S=this.add.graphics();if(S.fillStyle(0,.08),S.fillRoundedRect(18,t-8,e-32,i,20),S.fillStyle(16777215,1),S.fillRoundedRect(15,t-13,e-30,i,18),S.fillStyle(16738740,.75),S.fillRoundedRect(15,t-13,e-30,6,{tl:18,tr:18,bl:0,br:0}),this.add.text(e/2,t+14,"ğŸ€ ãˆã‚‰ã¹ã‚‹ãƒ¯ãƒ³ã‚³",{...D.section,fontSize:"16px"}).setOrigin(.5),this.dogGridContainer=this.add.container(0,0),o.forEach(([k,b],B)=>{const A=parseInt(k),R=y+B%r*(a+l),P=t+90+Math.floor(B/r)*(a+c+12);this.createDogOption(R,P,A,b,this.dogGridContainer)}),n.length>0){const k=t+90+d*(a+c+12)+20;this.createLegendarySelectSection(k,n,this.dogGridContainer)}const F=this.make.graphics();F.fillStyle(16777215),F.fillRect(0,t+30,e,i-50);const x=F.createGeometryMask();this.dogGridContainer.setMask(x),this.scrollY=0,this.maxScroll=Math.max(0,g-i+85),this.dogGridMaxScroll=this.maxScroll,this.isScrolling=!1,this.scrollStartPointer={x:0,y:0},this.scrollBounds={top:t+30,bottom:t+i-20,left:15,right:e-15};let C=!1,T=0,O=0;this.input.on("pointerdown",k=>{k.y>=t+25&&k.y<=t+i-15&&k.x>=15&&k.x<=e-15&&(C=!0,T=k.y,O=this.scrollY,this.scrollStartPointer={x:k.x,y:k.y},this.isScrolling=!1)}),this.input.on("pointermove",k=>{if(!C)return;Math.abs(k.y-T)>10&&(this.isScrolling=!0,this.scrollY=w.Math.Clamp(O-(k.y-T),0,this.maxScroll),this.dogGridContainer.y=-this.scrollY)}),this.input.on("pointerup",()=>{C=!1,this.time.delayedCall(50,()=>{this.isScrolling=!1})})}createLegendarySelectSection(e,s,t){const{width:i}=this.scale,o=95,n=3,r=8,a=8,c=90+Math.ceil(s.length/n)*(o+a+12)+30,d=this.add.graphics();d.fillStyle(16766720,.15),d.fillRoundedRect(20,e,i-40,c,16),d.fillStyle(16775910,1),d.fillRoundedRect(25,e+5,i-50,c-10,14),d.lineStyle(3,16766720,1),d.strokeRoundedRect(25,e+5,i-50,c-10,14),d.fillStyle(16766720,.9),d.fillRoundedRect(25,e+5,i-50,6,{tl:14,tr:14,bl:0,br:0}),t.add(d);const u=n*o+(n-1)*r,f=(i-u)/2+o/2;s.forEach(([m,y],S)=>{const F=parseInt(m),x=S%n,C=Math.floor(S/n),T=f+x*(o+r),O=e+120+C*(o+a+12);this.createLegendaryOption(T,O,F,y,t)});const g=this.add.text(i/2,e+50,"âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ âœ¨",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",fontStyle:"bold",color:"#B8860B",stroke:"#FFFFFF",strokeThickness:3}).setOrigin(.5);t.add(g)}createLegendaryOption(e,s,t,i,o){const n=v.isDogUnlocked(p,t),r=this.selectedDogs.includes(t),a=95,l=this.add.container(e,s),c=this.add.graphics();if(n&&r?(c.fillStyle(16766720,.5),c.fillRoundedRect(-a/2-10,-a/2-10,a+20,a+20,18),c.fillStyle(16775388,1),c.fillRoundedRect(-a/2,-a/2,a,a,14),c.lineStyle(5,16766720,1),c.strokeRoundedRect(-a/2,-a/2,a,a,14),this.tweens.add({targets:l,scale:{from:1,to:1.05},duration:600,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})):n?(c.fillStyle(16766720,.3),c.fillRoundedRect(-a/2-6,-a/2-6,a+12,a+12,16),c.fillStyle(16775388,1),c.fillRoundedRect(-a/2,-a/2,a,a,14),c.lineStyle(3,16766720,1),c.strokeRoundedRect(-a/2,-a/2,a,a,14)):(c.fillStyle(16766720,.2),c.fillRoundedRect(-a/2-4,-a/2-4,a+8,a+8,16),c.fillStyle(4013373,1),c.fillRoundedRect(-a/2,-a/2,a,a,14),c.lineStyle(3,16766720,.7),c.strokeRoundedRect(-a/2,-a/2,a,a,14)),l.add(c),n){const g=L.draw(this,0,-8,t,20,r?"happy":"neutral");l.add(g)}else{const g=L.draw(this,0,-8,t,20,"neutral");g.setAlpha(.35),g.list.forEach(m=>{m.setTint&&m.setTint(1118481)}),l.add(g),this.addSelectSparkleEffect(l,a)}const d=n?i.name:"ï¼Ÿï¼Ÿï¼Ÿ",u=d.length>=6?d.slice(0,Math.ceil(d.length/2))+`
`+d.slice(Math.ceil(d.length/2)):d,f=this.add.text(0,a/2-22,u,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",fontStyle:"bold",color:n?"#B8860B":"#FFD700",align:"center",lineSpacing:-2,stroke:n?"#FFFFFF":"#000000",strokeThickness:2}).setOrigin(.5);l.add(f),l.setSize(a,a),l.setInteractive({useHandCursor:!0}),n&&this.dogOptionMap.set(t,l),l.on("pointerdown",g=>{this.scrollBounds&&(g.y<this.scrollBounds.top||g.y>this.scrollBounds.bottom)||this.tweens.add({targets:l,scale:r?1.05:.93,duration:50})}),l.on("pointerup",g=>{this.tweens.add({targets:l,scale:r?1.05:1,duration:80}),!this.isScrolling&&(this.scrollBounds&&(g.y<this.scrollBounds.top||g.y>this.scrollBounds.bottom)||(n?this.toggleDogSelection(t):this.showLegendarySelectHint(t)))}),l.on("pointerout",()=>{this.tweens.add({targets:l,scale:r?1.05:1,duration:80})}),o.add(l)}addSelectSparkleEffect(e,s){[{x:-s/3,y:-s/3},{x:s/3,y:-s/4},{x:-s/4,y:s/5},{x:s/4,y:s/4}].forEach((i,o)=>{const n=this.add.text(i.x,i.y,"âœ¦",{fontSize:"10px",color:"#FFD700"}).setOrigin(.5).setAlpha(0);e.add(n),this.tweens.add({targets:n,alpha:{from:0,to:.9},scale:{from:.5,to:1.2},duration:600,delay:o*300,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})})}toggleDogSelection(e){this.selectedDogs.includes(e)?this.selectedDogs.length>1&&(this.selectedDogs=this.selectedDogs.filter(i=>i!==e)):this.selectedDogs.length<4?this.selectedDogs.push(e):(this.selectedDogs.shift(),this.selectedDogs.push(e));const t=this.tutorialMode&&!p.tutorial.completed;this.scene.restart({selectedDogs:this.selectedDogs,tutorialMode:t})}showLegendarySelectHint(e){const{width:s,height:t}=this.scale,i=this.add.rectangle(0,0,s,t,0,.7).setOrigin(0).setInteractive(),o=this.add.container(s/2,t/2),n=this.add.graphics();n.fillStyle(16766720,.25),n.fillRoundedRect(-145,-118,290,236,24),n.fillStyle(16775910,1),n.fillRoundedRect(-130,-105,260,210,18),n.lineStyle(5,16766720,1),n.strokeRoundedRect(-130,-105,260,210,18),n.fillStyle(16766720,.9),n.fillRoundedRect(-130,-105,260,8,{tl:18,tr:18,bl:0,br:0}),o.add(n);const r=this.add.text(0,-70,"âœ¨ ã§ã‚“ã›ã¤ãƒ¯ãƒ³ã‚³ âœ¨",{fontFamily:"KeiFont, sans-serif",fontSize:"20px",fontStyle:"bold",color:"#B8860B",stroke:"#FFFFFF",strokeThickness:4}).setOrigin(.5);o.add(r);const a=he[e];let l=`ã¨ã£ã¦ã‚‚ ã‚ãšã‚‰ã—ã„
ãƒ¯ãƒ³ã‚³ã ã‚ˆï¼

ã©ã†ã‚„ã£ãŸã‚‰
ã‚ãˆã‚‹ã‹ãªâ€¦ï¼Ÿ`;a&&(l=`ã€ï¼Ÿï¼Ÿï¼Ÿã€‘

${a.description}`);const c=this.add.text(0,5,l,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#5D4037",align:"center",lineSpacing:4}).setOrigin(.5);o.add(c);const d=this.add.container(0,83),u=this.add.graphics();u.fillStyle(12092939,.3),u.fillRoundedRect(-52,-14,104,32,12),u.fillStyle(16766720,1),u.fillRoundedRect(-50,-16,100,32,10),u.fillStyle(16775388,1),u.fillRoundedRect(-48,-14,96,16,{tl:8,tr:8,bl:0,br:0}),d.add(u);const f=this.add.text(0,0,"ã¨ã˜ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",fontStyle:"bold",color:"#5D4037"}).setOrigin(.5);d.add(f),d.setSize(100,32),d.setInteractive({useHandCursor:!0}),o.add(d),d.on("pointerover",()=>{this.tweens.add({targets:d,scale:1.08,duration:80})}),d.on("pointerout",()=>{this.tweens.add({targets:d,scale:1,duration:80})});const g=()=>{i.destroy(),o.destroy()};i.on("pointerup",g),d.on("pointerup",g)}createDogOption(e,s,t,i,o){const n=v.isDogUnlocked(p,t),r=this.selectedDogs.includes(t),a=95,l=this.add.container(e,s),c=this.add.graphics();if(r?(c.fillStyle(16766720,.3),c.fillRoundedRect(-a/2-8,-a/2-8,a+16,a+16,16),c.fillStyle(16775910,1),c.fillRoundedRect(-a/2,-a/2,a,a,14),c.lineStyle(4,16766720,1),c.strokeRoundedRect(-a/2,-a/2,a,a,14),this.tweens.add({targets:l,scale:{from:1,to:1.03},duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})):n?(c.fillStyle(0,.06),c.fillRoundedRect(-a/2+3,-a/2+3,a,a,14),c.fillStyle(16776181,1),c.fillRoundedRect(-a/2,-a/2,a,a,14),c.lineStyle(2.5,14534840,1),c.strokeRoundedRect(-a/2,-a/2,a,a,14)):(c.fillStyle(0,.04),c.fillRoundedRect(-a/2+2,-a/2+2,a,a,14),c.fillStyle(11053224,1),c.fillRoundedRect(-a/2,-a/2,a,a,14),c.lineStyle(2,9474192,1),c.strokeRoundedRect(-a/2,-a/2,a,a,14)),l.add(c),n){const g=L.draw(this,0,-8,t,20,r?"happy":"neutral");l.add(g)}else{const g=L.draw(this,0,-8,t,20,"neutral");g.setAlpha(.5),g.list.forEach(m=>{m.setTint&&m.setTint(2236962)}),l.add(g)}const d=n?i.name:"ï¼Ÿï¼Ÿï¼Ÿ",u=d.length>=6?d.slice(0,Math.ceil(d.length/2))+`
`+d.slice(Math.ceil(d.length/2)):d,f=this.add.text(0,a/2-22,u,{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:n?I.textDark:"#888888",align:"center",lineSpacing:-2}).setOrigin(.5);l.add(f),l.setSize(a,a),l.setInteractive({useHandCursor:!0}),l.on("pointerdown",g=>{this.scrollBounds&&(g.y<this.scrollBounds.top||g.y>this.scrollBounds.bottom)||(this.tweens.add({targets:l,scale:.92,duration:40}),E.impact("Light"))}),l.on("pointerup",g=>{if(this.tweens.add({targets:l,scale:1,duration:80}),this.isScrolling||this.scrollBounds&&(g.y<this.scrollBounds.top||g.y>this.scrollBounds.bottom))return;if(this.hideTutorialOverlay(),!n){this.showUnlockCondition(t);return}r?this.selectedDogs.length>1&&(this.selectedDogs=this.selectedDogs.filter(y=>y!==t)):this.selectedDogs.length<4?this.selectedDogs.push(t):(this.selectedDogs.shift(),this.selectedDogs.push(t));const m=this.tutorialMode&&!p.tutorial.completed;this.scene.restart({selectedDogs:this.selectedDogs,tutorialMode:m})}),l.on("pointerout",()=>this.tweens.add({targets:l,scale:1,duration:80})),o&&o.add(l),this.dogOptionMap.set(t,l)}showUnlockCondition(e){const{width:s,height:t}=this.scale,i=Object.values(ve).find(f=>f.dogId===e),o=this.add.rectangle(0,0,s,t,0,.5).setOrigin(0),n=this.add.container(s/2,t/2),r=this.add.graphics();r.fillStyle(3355443,1),r.fillRoundedRect(-140,-120,280,240,12),n.add(r);const a=L.draw(this,0,-55,e,32,"neutral");a.setAlpha(.6),a.list.forEach(f=>{f.setTint&&f.setTint(1118481)}),n.add(a);const l=this.add.text(0,5,"ï¼Ÿï¼Ÿï¼Ÿ",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFFFFF"}).setOrigin(.5);n.add(l);let c,d="";i?i.isSecret?c="ğŸ”“ ï¼Ÿï¼Ÿï¼Ÿ":(c=`ğŸ”“ ${i.description}`,d=this.getProgressText(i.condition)):c="ğŸ”“ ???";const u=this.add.text(0,50,c,{...D.body,fontSize:"13px",color:"#FFFFFF",align:"center",wordWrap:{width:240}}).setOrigin(.5);if(n.add(u),d){const f=this.add.text(0,85,d,{fontSize:"11px",color:"#AAAAAA",align:"center"}).setOrigin(.5);n.add(f)}o.setInteractive(),o.on("pointerup",()=>{o.destroy(),n.destroy()}),n.setScale(.8),n.setAlpha(0),this.tweens.add({targets:n,scale:1,alpha:1,duration:150,ease:"Back.easeOut"})}getProgressText(e){var n,r,a,l;if(!e)return"";const s=p.stats||{};let t=0,i=e.value||0,o="";switch(e.type){case"total_clears":t=s.totalClears||0,o="å›ã‚¯ãƒªã‚¢";break;case"total_pieces":t=s.totalPieces||0,o="ãƒ”ãƒ¼ã‚¹";break;case"max_combo":t=s.maxComboCount||0,o="ã‚³ãƒ³ãƒœ";break;case"consecutive_clears":t=s.maxConsecutiveClears||0,o="é€£ç¶š";break;case"consecutive_logins":t=s.consecutiveLogins||0,o="æ—¥";break;case"challenge_streak":t=s.challengeHighScore||0,o="é€£å‹";break;case"golden_clears":t=s.goldenClears||0,o="å›";break;case"no_miss_clears":t=s.noMissClears||0,o="å›";break;case"weekly_complete":t=((n=p.rewards)==null?void 0:n.totalWeeklyComplete)||0,o="å›";break;case"theme_clears":t=((r=s.themeClears)==null?void 0:r[e.theme])||0,o="å›";break;case"day_of_week_clears":t=((a=s.dayOfWeekClears)==null?void 0:a[e.day])||0,o="å›";break;case"dog_specific_clears":t=((l=s.dogSpecificClears)==null?void 0:l[e.dogId])||0,o="å›";break;default:return""}return`ï¼ˆç¾åœ¨: ${t}${o} / ${i}${o}ï¼‰`}createConfirmButton(){const{width:e,height:s}=this.scale,t=M.TOP+205,i=s-t-M.BOTTOM-70,o=t+i+15,n=this.selectedDogs.length===4,r=this.add.container(e/2,o),a=this.add.graphics();a.fillStyle(n?5025616:10066329,1),a.fillRoundedRect(-80,-22,160,44,8);const l=this.add.text(0,0,"ã‘ã£ã¦ã„",{...D.button,fontSize:"18px",color:n?"#FFFFFF":"#CCCCCC"}).setOrigin(.5);if(r.add([a,l]),!n){const c=this.add.text(0,32,`ğŸ¾ ã‚ã¨${4-this.selectedDogs.length}ã²ããˆã‚‰ã‚“ã§ã­ï¼`,{fontSize:"12px",color:"#FF6B6B"}).setOrigin(.5);r.add(c)}r.setSize(160,44),r.setInteractive({useHandCursor:!0}),r.on("pointerup",()=>{if(this.selectedDogs.length!==4){this.tweens.add({targets:r,x:r.x-5,duration:50,yoyo:!0,repeat:3});return}if(this.tutorialMode&&!p.tutorial.completed&&!this.selectedDogs.includes(5)){this.tweens.add({targets:r,x:r.x-5,duration:50,yoyo:!0,repeat:3}),this.showErabuTutorial();return}if(p.selectedDogs=this.selectedDogs,v.save(p),this.tutorialMode&&!p.tutorial.completed){this.completeTutorial();return}this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("MainMenuScene"))})}showErabuTutorial(){const{width:e,height:s}=this.scale;this.hideTutorialOverlay(),this.tutorialContainer=this.add.container(0,0).setDepth(1e3);const t=this.add.graphics();t.fillStyle(0,.7),t.fillRect(0,0,e,s),this.tutorialContainer.add(t);const i=this.dogOptionMap.get(5);i&&(this.scrollToDogOption(i),this.highlightDogOption(i));const o=s*.78,n=this.add.graphics();n.fillStyle(16777215,.95),n.fillRoundedRect(30,o-50,e-60,130,16),this.tutorialContainer.add(n);const r=this.add.text(e/2,o-15,`ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ã‚’
é¸ã‚“ã§ã¿ã‚ˆã†ï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"22px",color:"#5D4037",fontStyle:"bold",align:"center"}).setOrigin(.5);this.tutorialContainer.add(r);const a=this.add.text(e/2,o+35,"4åŒ¹é¸ã‚“ã§ã€Œã‘ã£ã¦ã„ã€ã‚’æŠ¼ãã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#8D6E63"}).setOrigin(.5);this.tutorialContainer.add(a);const l=this.add.rectangle(e/2,s/2,e,s,0,0).setInteractive({useHandCursor:!0});this.tutorialContainer.add(l),l.on("pointerdown",()=>{E.selection(),_.playSfx(this,"sfx_ui_tap"),this.hideTutorialOverlay()})}scrollToDogOption(e){if(!this.dogGridContainer||!this.dogGridVisibleHeight)return;const s=e.y-(this.dogGridStartY+this.dogGridVisibleHeight/2);this.scrollY=w.Math.Clamp(s,0,this.dogGridMaxScroll),this.dogGridContainer.y=-this.scrollY}highlightDogOption(e){const s=e.getBounds(),t=this.add.graphics();t.fillStyle(16777215,.25),t.fillRoundedRect(s.x-10,s.y-10,s.width+20,s.height+20,16),t.lineStyle(3,16766287,1),t.strokeRoundedRect(s.x-10,s.y-10,s.width+20,s.height+20,16),this.tutorialContainer.add(t),this.tweens.add({targets:t,alpha:{from:.3,to:.8},duration:600,yoyo:!0,repeat:-1})}completeTutorial(){const{width:e,height:s}=this.scale;p.tutorial.completed=!0,p.tutorial.inProgress=!1,v.save(p),this.tutorialContainer=this.add.container(0,0).setDepth(1e3);const t=this.add.graphics();t.fillStyle(0,.6),t.fillRect(0,0,e,s),this.tutorialContainer.add(t);const i=e-60,o=200,n=s/2,r=this.add.graphics();r.fillStyle(16777215,.98),r.fillRoundedRect(-i/2+e/2,n-o/2,i,o,20),this.tutorialContainer.add(r);const a=this.add.text(e/2,n-50,"ğŸ‰ æº–å‚™ã‹ã‚“ã‚Šã‚‡ã†ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#FF6F00",fontStyle:"bold"}).setOrigin(.5);this.tutorialContainer.add(a);const l=this.add.text(e/2,n+5,`ã“ã‚Œã§æº–å‚™ã¯OKï¼
ã„ã£ã±ã„éŠã‚“ã§ã­ï¼`,{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:"#5D4037",align:"center"}).setOrigin(.5);this.tutorialContainer.add(l);const c=160,d=50,u=n+70,f=this.add.container(e/2,u),g=this.add.graphics();g.fillStyle(16748288,1),g.fillRoundedRect(-c/2,-d/2,c,d,d/2),f.add(g);const m=this.add.text(0,0,"ã¯ã˜ã‚ã‚‹ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);f.add(m),f.setSize(c,d),f.setInteractive({useHandCursor:!0}),this.tutorialContainer.add(f),f.on("pointerover",()=>this.tweens.add({targets:f,scale:1.05,duration:80})),f.on("pointerout",()=>this.tweens.add({targets:f,scale:1,duration:80})),f.on("pointerdown",()=>{this.tweens.add({targets:f,scale:.95,duration:40}),E.selection(),_.playSfx(this,"sfx_ui_tap")}),f.on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{this.scene.start("MainMenuScene")})})}hideTutorialOverlay(){this.tutorialContainer&&(this.tutorialContainer.destroy(),this.tutorialContainer=null)}}class Xt extends w.Scene{constructor(){super({key:"MedalCelebrationScene"})}init(e){this.medalData=e||{totalMedals:1,newCostumes:[],stampCount:0}}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select"),_.playSfx(this,"sfx_medal"),this.add.rectangle(0,0,e,s,1710638,.95).setOrigin(0),this.cameras.main.shake(300,.01),this.createSparkles();const t=this.add.container(e/2,s/2),i=-80;this.createMedal(t,0,i);const o=this.add.text(0,i+90,"ğŸ‰ ãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«GETï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"24px",color:"#FFD700",stroke:"#8B4513",strokeThickness:4,shadow:{offsetX:2,offsetY:2,color:"#FFD70066",blur:8,fill:!0}}).setOrigin(.5);t.add(o),o.setScale(0),this.tweens.add({targets:o,scale:1,duration:400,delay:500,ease:"Back.easeOut"});const n=this.add.text(0,i+130,`ç´¯è¨ˆ ${this.medalData.totalMedals} æš`,{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#FFFFFF",stroke:"#000000",strokeThickness:2}).setOrigin(.5).setAlpha(0);t.add(n),this.tweens.add({targets:n,alpha:1,duration:300,delay:800}),this.medalData.newCostumes&&this.medalData.newCostumes.length>0&&this.time.delayedCall(1200,()=>{this.showNewCostumes(t,this.medalData.newCostumes)}),this.time.delayedCall(1500,()=>{const r=this.add.text(e/2,s-80,"ã‚¿ãƒƒãƒ—ã—ã¦ã¤ã¥ã‘ã‚‹",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#FFFFFF"}).setOrigin(.5);this.tweens.add({targets:r,alpha:{from:1,to:.4},duration:600,yoyo:!0,repeat:-1}),this.input.once("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>{const a=this.medalData.returnScene||"TitleScene";if(this.medalData.newCostumes&&this.medalData.newCostumes.length>0){const l=this.medalData.newCostumes.map(c=>({type:"costume",...c}));this.scene.start("ItemUnlockScene",{unlocks:l,returnScene:a,returnData:{}})}else this.scene.start(a)})})})}createMedal(e,s,t){const i=this.add.container(s,t),o=this.add.graphics();o.fillStyle(16766720,.3),o.fillCircle(0,0,70),i.add(o),this.tweens.add({targets:o,scale:{from:.8,to:1.2},alpha:{from:.5,to:.2},duration:1e3,yoyo:!0,repeat:-1});const n=this.add.graphics();n.fillStyle(16766720,1),n.fillCircle(0,0,50),n.fillStyle(16753920,1),n.fillCircle(0,0,42),n.fillStyle(16769126,.6),n.fillCircle(-15,-15,15),i.add(n);const r=oe.draw(this,0,0,16777215,18);r.setAlpha(.9),i.add(r),i.setScale(0),this.tweens.add({targets:i,scale:1,duration:500,ease:"Back.easeOut"}),this.tweens.add({targets:i,angle:{from:-5,to:5},duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),e.add(i)}createSparkles(){const{width:e,height:s}=this.scale;for(let t=0;t<20;t++)this.time.delayedCall(t*100,()=>{const i=w.Math.Between(20,e-20),o=w.Math.Between(50,s-50),n=this.add.text(i,o,"âœ¨",{fontSize:`${w.Math.Between(12,24)}px`}).setOrigin(.5).setAlpha(0);this.tweens.add({targets:n,alpha:{from:0,to:1},scale:{from:.5,to:1.2},y:o-30,duration:800,yoyo:!0,repeat:2,onComplete:()=>n.destroy()})})}showNewCostumes(e,s){const{width:t}=this.scale,i=100,o=this.add.graphics();o.fillStyle(5025616,.9),o.fillRoundedRect(-140,i-30,280,60,10),e.add(o);const n=this.add.text(0,i-10,"ğŸ€ NEW ãã›ã‹ãˆè§£æ”¾ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"14px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);e.add(n);const r=s.map(l=>`${l.icon} ${l.name}`).join("ã€€"),a=this.add.text(0,i+12,r,{fontFamily:"KeiFont, sans-serif",fontSize:"12px",color:"#FFEB3B"}).setOrigin(.5);e.add(a),o.setAlpha(0),n.setAlpha(0),a.setAlpha(0),this.tweens.add({targets:[o,n,a],alpha:1,duration:300,ease:"Power2"})}}class qt extends w.Scene{constructor(){super({key:"StampRallyScene"})}create(){const{width:e,height:s}=this.scale;_.playBgm(this,"bgm_select"),this.add.rectangle(0,0,e,s,I.sky).setOrigin(0),this.createHeader(),this.createStampBoard(),this.createBonusArea(),this.createMedalInfo(),this.cameras.main.fadeIn(300)}createHeader(){const{width:e}=this.scale,s=M.TOP,t=this.add.graphics();t.fillStyle(I.uiBg,1),t.fillRect(0,s,e,55),this.add.text(15,s+28,"â† ã‚‚ã©ã‚‹",{...D.body}).setOrigin(0,.5).setInteractive({useHandCursor:!0}).on("pointerup",()=>{this.cameras.main.fadeOut(300),this.time.delayedCall(300,()=>this.scene.start("TitleScene"))}),this.add.text(e/2,s+28,"ğŸ“… ã‚¹ã‚¿ãƒ³ãƒ—ãƒ©ãƒªãƒ¼",{...D.heading}).setOrigin(.5)}createStampBoard(){const{width:e}=this.scale,s=M.TOP+90,t=this.add.graphics();t.fillStyle(16777215,.95),t.fillRoundedRect(20,s,e-40,180,16),t.lineStyle(3,16766720,1),t.strokeRoundedRect(20,s,e-40,180,16),this.add.text(e/2,s+20,"ğŸ¾ ã“ã‚“ã—ã‚…ã†ã®ã‚¹ã‚¿ãƒ³ãƒ—",{...D.section,fontSize:"14px"}).setOrigin(.5);const i=["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ","æ—¥"],n=X.getStampRallyInfo(p).stamps||[],r=s+80,a=38,l=8,c=7*a+6*l,d=(e-c)/2+a/2;i.forEach((g,m)=>{const y=d+m*(a+l),S=m>=5?"#FF6B6B":"#666666";this.add.text(y,r-25,g,{fontSize:"12px",color:S,fontStyle:"bold"}).setOrigin(.5);const F=n.includes(m),x=this.add.graphics();F?(x.fillStyle(16769154,1),x.fillCircle(y,r,a/2),x.lineStyle(2,16766720,1),x.strokeCircle(y,r,a/2),oe.draw(this,y,r,z[1].color,10)):(x.lineStyle(2,13421772,1),x.strokeCircle(y,r,a/2),this.add.text(y,r,"?",{fontSize:"16px",color:"#CCCCCC",fontStyle:"bold"}).setOrigin(.5))});const u=`${n.length}/7`;this.add.text(e/2,s+145,u,{fontFamily:"KeiFont, sans-serif",fontSize:"20px",color:n.length>=7?"#4CAF50":"#FF6B6B",fontStyle:"bold"}).setOrigin(.5);const f=7-n.length;f>0&&n.length<7&&this.add.text(e/2,s+165,`ã‚ã¨ ${f} æ—¥ï¼`,{fontSize:"12px",color:"#888888"}).setOrigin(.5)}createBonusArea(){const{width:e}=this.scale,s=M.TOP+290,t=this.add.graphics(),i=X.checkWeeklyBonus(p),o=i.canClaim;if(o?t.fillStyle(16766720,.2):t.fillStyle(16777215,.9),t.fillRoundedRect(20,s,e-40,120,16),t.lineStyle(2,o?16766720:13421772,1),t.strokeRoundedRect(20,s,e-40,120,16),this.add.text(e/2,s+20,"ğŸ ã—ã‚…ã†ã¾ã¤ãƒœãƒ¼ãƒŠã‚¹",{...D.section,fontSize:"14px"}).setOrigin(.5),this.add.text(e/2,s+50,`7æ—¥ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã§
ãƒ¡ãƒ€ãƒ«3æš ï¼‹ ç‰¹åˆ¥ãã›ã‹ãˆï¼`,{fontSize:"12px",color:"#666666",align:"center",lineSpacing:4}).setOrigin(.5),o){const n=this.add.container(e/2,s+95),r=this.add.graphics();r.fillStyle(5025616,1),r.fillRoundedRect(-70,-18,140,36,8),n.add(r);const a=this.add.text(0,0,"ğŸ‰ ã†ã‘ã¨ã‚‹ï¼",{fontFamily:"KeiFont, sans-serif",fontSize:"16px",color:"#FFFFFF",fontStyle:"bold"}).setOrigin(.5);n.add(a),n.setSize(140,36),n.setInteractive({useHandCursor:!0}),n.on("pointerup",()=>{const l=X.claimWeeklyBonus(p);l.success&&this.scene.start("MedalCelebrationScene",{totalMedals:l.totalMedals,bonusMedals:l.bonusMedals,newCostumes:l.newCostumes,isWeeklyBonus:!0})}),this.tweens.add({targets:n,scale:{from:1,to:1.05},duration:500,yoyo:!0,repeat:-1})}else i.alreadyClaimed&&this.add.text(e/2,s+95,"âœ… ä»Šé€±ã¯ã†ã‘ã¨ã‚Šãšã¿ï¼",{fontSize:"14px",color:"#4CAF50",fontStyle:"bold"}).setOrigin(.5)}createMedalInfo(){var r,a;const{width:e,height:s}=this.scale,t=M.TOP+430,i=this.add.graphics();i.fillStyle(16775393,.95),i.fillRoundedRect(20,t,e-40,100,16);const o=((r=p.rewards)==null?void 0:r.medals)||0;this.add.text(e/2,t+25,"ğŸ… ç´¯è¨ˆãŠã•ã‚“ã½ãƒ¡ãƒ€ãƒ«",{...D.section,fontSize:"14px"}).setOrigin(.5),this.add.text(e/2,t+55,`${o} æš`,{fontFamily:"KeiFont, sans-serif",fontSize:"28px",color:"#FFD700",stroke:"#8B4513",strokeThickness:3}).setOrigin(.5);const n=((a=p.rewards)==null?void 0:a.totalWeeklyComplete)||0;this.add.text(e/2,t+85,`é€±é–“ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ: ${n} å›`,{fontSize:"11px",color:"#888888"}).setOrigin(.5)}}const Zt=390,Jt=844,Qt={type:w.AUTO,parent:"game-container",backgroundColor:"#87CEEB",scale:{mode:w.Scale.FIT,autoCenter:w.Scale.CENTER_BOTH,width:Zt,height:Jt},autoFocus:!1,audio:{disableWebAudio:!1,noAudio:!1},scene:[Bt,Mt,Pt,At,It,zt,Lt,Ut,Ht,Kt,$t,Nt,Wt,Gt,Vt,jt,Xt,qt]};console.log("ğŸ• ãƒ¯ãƒ³ã“ã­ãã¨ - æ¡œäº•ã‚¤ã‚ºãƒ é©ç”¨ç‰ˆ");const es=new w.Game(Qt);window.game=es;window.gameData=p;window.TEST_MODE=Dt;export{Ge as A,fe as I,Ie as N,Qe as W,et as a};
